{"ast":null,"code":"import _regeneratorRuntime from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport Axios from 'axios';\nimport classNames from 'classnames';\nimport dayjs from 'dayjs';\nimport relativeTime from 'dayjs/plugin/relativeTime';\nimport Link from 'next/link';\nimport { useRouter } from 'next/router';\nimport React, { Fragment } from 'react';\nimport { useAuthState } from '../context/auth';\nimport ActionButton from './ActionButton';\ndayjs.extend(relativeTime);\nexport default function PostCard(_ref) {\n  var post = _ref.post,\n      revalidate = _ref.revalidate;\n\n  var _useAuthState = useAuthState(),\n      authenticated = _useAuthState.authenticated;\n\n  var router = useRouter();\n  var isInSubpage = router.pathname === '/r/[sub]'; // console.log(post);\n\n  var vote = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(value) {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              // If not logged in go to login\n              if (!authenticated) router.push('/login'); // If vote is the same reset vote\n\n              if (value === post.userVote) value = 0;\n              _context.prev = 2;\n              _context.next = 5;\n              return Axios.post('/misc/vote', {\n                identifier: post.identifier,\n                slug: post.slug,\n                value: value\n              });\n\n            case 5:\n              res = _context.sent;\n\n              if (revalidate) {\n                revalidate();\n              } //setVote(value, post);\n              //console.log(res.data)\n\n\n              _context.next = 12;\n              break;\n\n            case 9:\n              _context.prev = 9;\n              _context.t0 = _context[\"catch\"](2);\n              console.log(_context.t0);\n\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[2, 9]]);\n    }));\n\n    return function vote(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    id: post.identifier,\n    className: \"flex mb-4 bg-white rounded\",\n    children: [/*#__PURE__*/_jsxs(\"div\", {\n      className: \"w-10 py-3 text-center bg-gray-200 rounded-l\",\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        onClick: function onClick() {\n          return vote(1);\n        },\n        className: \"w-6 mx-auto text-gray-400 rounded cursor-pointer hover:bg-gray-300 hover:text-red-500\",\n        children: /*#__PURE__*/_jsx(\"i\", {\n          className: classNames(\"icon-arrow-up\", {\n            \"text-red-500\": post.userVote === 1\n          })\n        })\n      }), /*#__PURE__*/_jsx(\"p\", {\n        children: post.voteScore\n      }), /*#__PURE__*/_jsx(\"div\", {\n        onClick: function onClick() {\n          return vote(-1);\n        },\n        className: \"w-6 mx-auto text-gray-400 rounded cursor-pointer hover:bg-gray-300 hover:text-blue-600\",\n        children: /*#__PURE__*/_jsx(\"i\", {\n          className: classNames(\"icon-arrow-down\", {\n            \"text-blue-600\": post.userVote === -1\n          })\n        })\n      })]\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: \"w-full p-2\",\n      children: [/*#__PURE__*/_jsxs(\"div\", {\n        className: \"flex items-center \",\n        children: [!isInSubpage && /*#__PURE__*/_jsxs(Fragment, {\n          children: [/*#__PURE__*/_jsx(Link, {\n            href: \"/r/\".concat(post.subName),\n            children: /*#__PURE__*/_jsx(\"img\", {\n              src: post.sub.imageUrl || 'https://www.gravatar.com/avatar/00000000000000000000000000000000?d=mp&f=y',\n              className: \"w-6 h-6 mr-1 rounded-full cursor-pointer\"\n            })\n          }), /*#__PURE__*/_jsx(Link, {\n            href: \"/r/\".concat(post.subName),\n            children: /*#__PURE__*/_jsxs(\"a\", {\n              className: \"text-xs font-bold cursor-pointer hover:underline\",\n              children: [\"/r/\", post.subName]\n            })\n          })]\n        }), /*#__PURE__*/_jsxs(\"p\", {\n          className: \"text-xs text-gray-600\",\n          children: [\". Posted by\", /*#__PURE__*/_jsx(Link, {\n            href: \"/u/\".concat(post.username),\n            children: /*#__PURE__*/_jsxs(\"a\", {\n              className: \"mx-1 hover:underline\",\n              children: [\"/u/\", post.username]\n            })\n          }), /*#__PURE__*/_jsx(Link, {\n            href: post.url,\n            children: /*#__PURE__*/_jsx(\"a\", {\n              className: \"mx-1 hover:underline\",\n              children: dayjs(post.createdAt).fromNow()\n            })\n          })]\n        })]\n      }), /*#__PURE__*/_jsx(Link, {\n        href: post.url,\n        children: /*#__PURE__*/_jsx(\"a\", {\n          className: \"my-1 text-lg font-medium\",\n          children: post.title\n        })\n      }), post.imageUrl !== null && /*#__PURE__*/_jsx(\"img\", {\n        src: post.imageUrl\n      }), post.body && /*#__PURE__*/_jsx(\"p\", {\n        className: \"my-1 text-sm\",\n        children: post.body\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"flex\",\n        children: [/*#__PURE__*/_jsx(Link, {\n          href: post.url,\n          children: /*#__PURE__*/_jsx(\"a\", {\n            children: /*#__PURE__*/_jsxs(ActionButton, {\n              children: [/*#__PURE__*/_jsx(\"i\", {\n                className: \"mr-1 fas fa-comment-alt fa-xs\"\n              }), /*#__PURE__*/_jsxs(\"span\", {\n                className: \"font-bold\",\n                children: [post.commentCount, \" Comments\"]\n              })]\n            })\n          })\n        }), /*#__PURE__*/_jsxs(ActionButton, {\n          children: [/*#__PURE__*/_jsx(\"i\", {\n            className: \"mr-1 fas fa-share fa-xs\"\n          }), /*#__PURE__*/_jsx(\"span\", {\n            className: \"font-bold\",\n            children: \"Share\"\n          })]\n        }), /*#__PURE__*/_jsxs(ActionButton, {\n          children: [/*#__PURE__*/_jsx(\"i\", {\n            className: \"mr-1 fas fa-bookmark fa-xs\"\n          }), /*#__PURE__*/_jsx(\"span\", {\n            className: \"font-bold\",\n            children: \"Save\"\n          })]\n        })]\n      })]\n    })]\n  }, post.identifier);\n}","map":null,"metadata":{},"sourceType":"module"}