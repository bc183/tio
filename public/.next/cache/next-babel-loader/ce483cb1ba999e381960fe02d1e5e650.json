{"ast":null,"code":"import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport Axios from \"axios\";\nimport dayjs from \"dayjs\";\nimport Head from \"next/head\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/router\";\nimport { createRef, Fragment } from \"react\";\nimport useSWR from \"swr\";\nimport PostCard from \"../../components/PostCard\";\nimport { useAuthState } from \"../../context/auth\";\nimport classNames from \"classnames\";\nexport default function user() {\n  const router = useRouter();\n  const {\n    user\n  } = useAuthState();\n  const username = router.query.username;\n  const {\n    data,\n    error,\n    revalidate\n  } = useSWR(username ? `/users/${username}` : null);\n\n  if (error) {\n    router.push('/');\n  } // if (data) {\n  //     console.log(data);\n  // }\n\n\n  const loggedInUser = (user === null || user === void 0 ? void 0 : user.username) === username;\n  const fileInputRef = /*#__PURE__*/createRef();\n\n  const openFileInput = type => {\n    if (!loggedInUser) {\n      return;\n    }\n\n    fileInputRef.current.name = type;\n    fileInputRef.current.click();\n  };\n\n  const uploadImage = async event => {\n    const file = event.target.files[0];\n    const formData = new FormData();\n    formData.append('file', file);\n\n    try {\n      await Axios.post(`/users/${user === null || user === void 0 ? void 0 : user.username}/profile`, formData, {\n        headers: {\n          'Content-Type': 'multipart/form-data'\n        }\n      });\n      revalidate();\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  return /*#__PURE__*/_jsxs(Fragment, {\n    children: [/*#__PURE__*/_jsx(Head, {\n      children: /*#__PURE__*/_jsx(\"title\", {\n        children: data === null || data === void 0 ? void 0 : data.user.username\n      })\n    }), data && /*#__PURE__*/_jsxs(\"div\", {\n      className: \"container flex pt-5\",\n      children: [/*#__PURE__*/_jsx(\"input\", {\n        type: \"file\",\n        hidden: true,\n        ref: fileInputRef,\n        onChange: uploadImage\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: \"w-160\",\n        children: data.submissions.map(submission => {\n          if (submission.type === 'Post') {\n            const post = submission;\n            return /*#__PURE__*/_jsx(PostCard, {\n              post: post,\n              revalidate: revalidate\n            }, submission.identifier);\n          } else {\n            const comment = submission;\n            return /*#__PURE__*/_jsxs(\"div\", {\n              className: \"flex my-4 bg-white rounded\",\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                className: \"flex-shrink-0 w-10 py-4 text-center bg-gray-200 rounded-l\",\n                children: /*#__PURE__*/_jsx(\"i\", {\n                  className: \"text-gray-500 fas fa-comment-alt fa-xs\"\n                })\n              }), /*#__PURE__*/_jsxs(\"div\", {\n                className: \"w-full p-2\",\n                children: [/*#__PURE__*/_jsxs(\"p\", {\n                  className: \"mb-2 text-xs text-gray-500\",\n                  children: [comment.username, /*#__PURE__*/_jsx(\"span\", {\n                    children: \" commented on \"\n                  }), /*#__PURE__*/_jsx(Link, {\n                    href: comment.post.url,\n                    children: /*#__PURE__*/_jsx(\"a\", {\n                      href: \"\",\n                      className: \"font-semibold cursor-pointer hover:underline\",\n                      children: comment.post.title\n                    })\n                  }), /*#__PURE__*/_jsx(\"span\", {\n                    className: \"mx-1\",\n                    children: \".\"\n                  }), /*#__PURE__*/_jsx(Link, {\n                    href: `/r/${comment.post.subName}`,\n                    children: /*#__PURE__*/_jsxs(\"a\", {\n                      href: \"\",\n                      className: \"text-black cursor-pointer hover:underline\",\n                      children: [\"/r/\", comment.post.subName]\n                    })\n                  })]\n                }), /*#__PURE__*/_jsx(\"hr\", {}), /*#__PURE__*/_jsx(\"p\", {\n                  children: comment.body\n                })]\n              })]\n            }, comment.identifier);\n          }\n        })\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: \"ml-6 w-80\",\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: \"bg-white rounded\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"p-3 bg-blue-500 rounded-t\",\n            children: /*#__PURE__*/_jsx(\"img\", {\n              src: data.user.imageUrl,\n              alt: \"user-profile\",\n              className: classNames(\"w-16 h-16 mx-auto border-2 border-white rounded-full\", {\n                'cursor-pointer': loggedInUser\n              }),\n              onClick: () => openFileInput('image')\n            })\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: \"p-3 text-center\",\n            children: [/*#__PURE__*/_jsx(\"h1\", {\n              className: \"mb-3 text-xl\",\n              children: data.user.username\n            }), /*#__PURE__*/_jsx(\"hr\", {}), /*#__PURE__*/_jsxs(\"p\", {\n              className: \"mt-3\",\n              children: [\"Joined \", dayjs(data.user.createdAt).format('MMM YYYY')]\n            })]\n          })]\n        })\n      })]\n    })]\n  });\n}","map":null,"metadata":{},"sourceType":"module"}