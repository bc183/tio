{"ast":null,"code":"import _classCallCheck from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _get from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/get\";\nimport _inherits from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nimport './actionbar.css';\nimport { Disposable, dispose as _dispose } from '../../../common/lifecycle.js';\nimport { ActionRunner } from '../../../common/actions.js';\nimport * as DOM from '../../dom.js';\nimport * as types from '../../../common/types.js';\nimport { StandardKeyboardEvent } from '../../keyboardEvent.js';\nimport { Emitter } from '../../../common/event.js';\nimport { ActionViewItem, BaseActionViewItem } from './actionViewItems.js';\nexport var ActionBar = /*#__PURE__*/function (_Disposable) {\n  _inherits(ActionBar, _Disposable);\n\n  var _super = _createSuper(ActionBar);\n\n  function ActionBar(container) {\n    var _this;\n\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, ActionBar);\n\n    var _a, _b, _c, _d, _e, _f;\n\n    _this = _super.call(this); // Trigger Key Tracking\n\n    _this.triggerKeyDown = false;\n    _this._onDidBlur = _this._register(new Emitter());\n    _this.onDidBlur = _this._onDidBlur.event;\n    _this._onDidCancel = _this._register(new Emitter({\n      onFirstListenerAdd: function onFirstListenerAdd() {\n        return _this.cancelHasListener = true;\n      }\n    }));\n    _this.onDidCancel = _this._onDidCancel.event;\n    _this.cancelHasListener = false;\n    _this._onDidRun = _this._register(new Emitter());\n    _this.onDidRun = _this._onDidRun.event;\n    _this._onBeforeRun = _this._register(new Emitter());\n    _this.onBeforeRun = _this._onBeforeRun.event;\n    _this.options = options;\n    _this._context = (_a = options.context) !== null && _a !== void 0 ? _a : null;\n    _this._orientation = (_b = _this.options.orientation) !== null && _b !== void 0 ? _b : 0\n    /* HORIZONTAL */\n    ;\n    _this._triggerKeys = {\n      keyDown: (_d = (_c = _this.options.triggerKeys) === null || _c === void 0 ? void 0 : _c.keyDown) !== null && _d !== void 0 ? _d : false,\n      keys: (_f = (_e = _this.options.triggerKeys) === null || _e === void 0 ? void 0 : _e.keys) !== null && _f !== void 0 ? _f : [3\n      /* Enter */\n      , 10\n      /* Space */\n      ]\n    };\n\n    if (_this.options.actionRunner) {\n      _this._actionRunner = _this.options.actionRunner;\n    } else {\n      _this._actionRunner = new ActionRunner();\n\n      _this._register(_this._actionRunner);\n    }\n\n    _this._register(_this._actionRunner.onDidRun(function (e) {\n      return _this._onDidRun.fire(e);\n    }));\n\n    _this._register(_this._actionRunner.onBeforeRun(function (e) {\n      return _this._onBeforeRun.fire(e);\n    }));\n\n    _this._actionIds = [];\n    _this.viewItems = [];\n    _this.focusedItem = undefined;\n    _this.domNode = document.createElement('div');\n    _this.domNode.className = 'monaco-action-bar';\n\n    if (options.animated !== false) {\n      _this.domNode.classList.add('animated');\n    }\n\n    var previousKeys;\n    var nextKeys;\n\n    switch (_this._orientation) {\n      case 0\n      /* HORIZONTAL */\n      :\n        previousKeys = _this.options.ignoreOrientationForPreviousAndNextKey ? [15\n        /* LeftArrow */\n        , 16\n        /* UpArrow */\n        ] : [15\n        /* LeftArrow */\n        ];\n        nextKeys = _this.options.ignoreOrientationForPreviousAndNextKey ? [17\n        /* RightArrow */\n        , 18\n        /* DownArrow */\n        ] : [17\n        /* RightArrow */\n        ];\n        break;\n\n      case 1\n      /* HORIZONTAL_REVERSE */\n      :\n        previousKeys = _this.options.ignoreOrientationForPreviousAndNextKey ? [17\n        /* RightArrow */\n        , 18\n        /* DownArrow */\n        ] : [17\n        /* RightArrow */\n        ];\n        nextKeys = _this.options.ignoreOrientationForPreviousAndNextKey ? [15\n        /* LeftArrow */\n        , 16\n        /* UpArrow */\n        ] : [15\n        /* LeftArrow */\n        ];\n        _this.domNode.className += ' reverse';\n        break;\n\n      case 2\n      /* VERTICAL */\n      :\n        previousKeys = _this.options.ignoreOrientationForPreviousAndNextKey ? [15\n        /* LeftArrow */\n        , 16\n        /* UpArrow */\n        ] : [16\n        /* UpArrow */\n        ];\n        nextKeys = _this.options.ignoreOrientationForPreviousAndNextKey ? [17\n        /* RightArrow */\n        , 18\n        /* DownArrow */\n        ] : [18\n        /* DownArrow */\n        ];\n        _this.domNode.className += ' vertical';\n        break;\n\n      case 3\n      /* VERTICAL_REVERSE */\n      :\n        previousKeys = _this.options.ignoreOrientationForPreviousAndNextKey ? [17\n        /* RightArrow */\n        , 18\n        /* DownArrow */\n        ] : [18\n        /* DownArrow */\n        ];\n        nextKeys = _this.options.ignoreOrientationForPreviousAndNextKey ? [15\n        /* LeftArrow */\n        , 16\n        /* UpArrow */\n        ] : [16\n        /* UpArrow */\n        ];\n        _this.domNode.className += ' vertical reverse';\n        break;\n    }\n\n    _this._register(DOM.addDisposableListener(_this.domNode, DOM.EventType.KEY_DOWN, function (e) {\n      var event = new StandardKeyboardEvent(e);\n      var eventHandled = true;\n\n      if (previousKeys && (event.equals(previousKeys[0]) || event.equals(previousKeys[1]))) {\n        eventHandled = _this.focusPrevious();\n      } else if (nextKeys && (event.equals(nextKeys[0]) || event.equals(nextKeys[1]))) {\n        eventHandled = _this.focusNext();\n      } else if (event.equals(9\n      /* Escape */\n      ) && _this.cancelHasListener) {\n        _this._onDidCancel.fire();\n      } else if (_this.isTriggerKeyEvent(event)) {\n        // Staying out of the else branch even if not triggered\n        if (_this._triggerKeys.keyDown) {\n          _this.doTrigger(event);\n        } else {\n          _this.triggerKeyDown = true;\n        }\n      } else {\n        eventHandled = false;\n      }\n\n      if (eventHandled) {\n        event.preventDefault();\n        event.stopPropagation();\n      }\n    }));\n\n    _this._register(DOM.addDisposableListener(_this.domNode, DOM.EventType.KEY_UP, function (e) {\n      var event = new StandardKeyboardEvent(e); // Run action on Enter/Space\n\n      if (_this.isTriggerKeyEvent(event)) {\n        if (!_this._triggerKeys.keyDown && _this.triggerKeyDown) {\n          _this.triggerKeyDown = false;\n\n          _this.doTrigger(event);\n        }\n\n        event.preventDefault();\n        event.stopPropagation();\n      } // Recompute focused item\n      else if (event.equals(2\n        /* Tab */\n        ) || event.equals(1024\n        /* Shift */\n        | 2\n        /* Tab */\n        )) {\n          _this.updateFocusedItem();\n        }\n    }));\n\n    _this.focusTracker = _this._register(DOM.trackFocus(_this.domNode));\n\n    _this._register(_this.focusTracker.onDidBlur(function () {\n      if (DOM.getActiveElement() === _this.domNode || !DOM.isAncestor(DOM.getActiveElement(), _this.domNode)) {\n        _this._onDidBlur.fire();\n\n        _this.focusedItem = undefined;\n        _this.triggerKeyDown = false;\n      }\n    }));\n\n    _this._register(_this.focusTracker.onDidFocus(function () {\n      return _this.updateFocusedItem();\n    }));\n\n    _this.actionsList = document.createElement('ul');\n    _this.actionsList.className = 'actions-container';\n\n    _this.actionsList.setAttribute('role', 'toolbar');\n\n    if (_this.options.ariaLabel) {\n      _this.actionsList.setAttribute('aria-label', _this.options.ariaLabel);\n    }\n\n    _this.domNode.appendChild(_this.actionsList);\n\n    container.appendChild(_this.domNode);\n    return _this;\n  }\n\n  _createClass(ActionBar, [{\n    key: \"isTriggerKeyEvent\",\n    value: function isTriggerKeyEvent(event) {\n      var ret = false;\n\n      this._triggerKeys.keys.forEach(function (keyCode) {\n        ret = ret || event.equals(keyCode);\n      });\n\n      return ret;\n    }\n  }, {\n    key: \"updateFocusedItem\",\n    value: function updateFocusedItem() {\n      for (var i = 0; i < this.actionsList.children.length; i++) {\n        var elem = this.actionsList.children[i];\n\n        if (DOM.isAncestor(DOM.getActiveElement(), elem)) {\n          this.focusedItem = i;\n          break;\n        }\n      }\n    }\n  }, {\n    key: \"getContainer\",\n    value: function getContainer() {\n      return this.domNode;\n    }\n  }, {\n    key: \"push\",\n    value: function push(arg) {\n      var _this2 = this;\n\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var actions = Array.isArray(arg) ? arg : [arg];\n      var index = types.isNumber(options.index) ? options.index : null;\n      actions.forEach(function (action) {\n        var actionViewItemElement = document.createElement('li');\n        actionViewItemElement.className = 'action-item';\n        actionViewItemElement.setAttribute('role', 'presentation'); // Prevent native context menu on actions\n\n        if (!_this2.options.allowContextMenu) {\n          _this2._register(DOM.addDisposableListener(actionViewItemElement, DOM.EventType.CONTEXT_MENU, function (e) {\n            DOM.EventHelper.stop(e, true);\n          }));\n        }\n\n        var item;\n\n        if (_this2.options.actionViewItemProvider) {\n          item = _this2.options.actionViewItemProvider(action);\n        }\n\n        if (!item) {\n          item = new ActionViewItem(_this2.context, action, options);\n        }\n\n        item.actionRunner = _this2._actionRunner;\n        item.setActionContext(_this2.context);\n        item.render(actionViewItemElement);\n\n        if (index === null || index < 0 || index >= _this2.actionsList.children.length) {\n          _this2.actionsList.appendChild(actionViewItemElement);\n\n          _this2.viewItems.push(item);\n\n          _this2._actionIds.push(action.id);\n        } else {\n          _this2.actionsList.insertBefore(actionViewItemElement, _this2.actionsList.children[index]);\n\n          _this2.viewItems.splice(index, 0, item);\n\n          _this2._actionIds.splice(index, 0, action.id);\n\n          index++;\n        }\n      });\n\n      if (this.focusedItem) {\n        // After a clear actions might be re-added to simply toggle some actions. We should preserve focus #97128\n        this.focus(this.focusedItem);\n      }\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      _dispose(this.viewItems);\n\n      this.viewItems = [];\n      this._actionIds = [];\n      DOM.clearNode(this.actionsList);\n    }\n  }, {\n    key: \"focus\",\n    value: function focus(arg) {\n      var selectFirst = false;\n      var index = undefined;\n\n      if (arg === undefined) {\n        selectFirst = true;\n      } else if (typeof arg === 'number') {\n        index = arg;\n      } else if (typeof arg === 'boolean') {\n        selectFirst = arg;\n      }\n\n      if (selectFirst && typeof this.focusedItem === 'undefined') {\n        var firstEnabled = this.viewItems.findIndex(function (item) {\n          return item.isEnabled();\n        }); // Focus the first enabled item\n\n        this.focusedItem = firstEnabled === -1 ? undefined : firstEnabled;\n        this.updateFocus();\n      } else {\n        if (index !== undefined) {\n          this.focusedItem = index;\n        }\n\n        this.updateFocus();\n      }\n    }\n  }, {\n    key: \"focusNext\",\n    value: function focusNext() {\n      if (typeof this.focusedItem === 'undefined') {\n        this.focusedItem = this.viewItems.length - 1;\n      }\n\n      var startIndex = this.focusedItem;\n      var item;\n\n      do {\n        if (this.options.preventLoopNavigation && this.focusedItem + 1 >= this.viewItems.length) {\n          this.focusedItem = startIndex;\n          return false;\n        }\n\n        this.focusedItem = (this.focusedItem + 1) % this.viewItems.length;\n        item = this.viewItems[this.focusedItem];\n      } while (this.focusedItem !== startIndex && !item.isEnabled());\n\n      if (this.focusedItem === startIndex && !item.isEnabled()) {\n        this.focusedItem = undefined;\n      }\n\n      this.updateFocus();\n      return true;\n    }\n  }, {\n    key: \"focusPrevious\",\n    value: function focusPrevious() {\n      if (typeof this.focusedItem === 'undefined') {\n        this.focusedItem = 0;\n      }\n\n      var startIndex = this.focusedItem;\n      var item;\n\n      do {\n        this.focusedItem = this.focusedItem - 1;\n\n        if (this.focusedItem < 0) {\n          if (this.options.preventLoopNavigation) {\n            this.focusedItem = startIndex;\n            return false;\n          }\n\n          this.focusedItem = this.viewItems.length - 1;\n        }\n\n        item = this.viewItems[this.focusedItem];\n      } while (this.focusedItem !== startIndex && !item.isEnabled());\n\n      if (this.focusedItem === startIndex && !item.isEnabled()) {\n        this.focusedItem = undefined;\n      }\n\n      this.updateFocus(true);\n      return true;\n    }\n  }, {\n    key: \"updateFocus\",\n    value: function updateFocus(fromRight, preventScroll) {\n      if (typeof this.focusedItem === 'undefined') {\n        this.actionsList.focus({\n          preventScroll: preventScroll\n        });\n      }\n\n      for (var i = 0; i < this.viewItems.length; i++) {\n        var item = this.viewItems[i];\n        var actionViewItem = item;\n\n        if (i === this.focusedItem) {\n          if (types.isFunction(actionViewItem.isEnabled)) {\n            if (actionViewItem.isEnabled() && types.isFunction(actionViewItem.focus)) {\n              actionViewItem.focus(fromRight);\n            } else {\n              this.actionsList.focus({\n                preventScroll: preventScroll\n              });\n            }\n          }\n        } else {\n          if (types.isFunction(actionViewItem.blur)) {\n            actionViewItem.blur();\n          }\n        }\n      }\n    }\n  }, {\n    key: \"doTrigger\",\n    value: function doTrigger(event) {\n      if (typeof this.focusedItem === 'undefined') {\n        return; //nothing to focus\n      } // trigger action\n\n\n      var actionViewItem = this.viewItems[this.focusedItem];\n\n      if (actionViewItem instanceof BaseActionViewItem) {\n        var context = actionViewItem._context === null || actionViewItem._context === undefined ? event : actionViewItem._context;\n        this.run(actionViewItem._action, context);\n      }\n    }\n  }, {\n    key: \"run\",\n    value: function run(action, context) {\n      return this._actionRunner.run(action, context);\n    }\n  }, {\n    key: \"dispose\",\n    value: function dispose() {\n      _dispose(this.viewItems);\n\n      this.viewItems = [];\n      this._actionIds = [];\n      this.getContainer().remove();\n\n      _get(_getPrototypeOf(ActionBar.prototype), \"dispose\", this).call(this);\n    }\n  }, {\n    key: \"context\",\n    get: function get() {\n      return this._context;\n    },\n    set: function set(context) {\n      this._context = context;\n      this.viewItems.forEach(function (i) {\n        return i.setActionContext(context);\n      });\n    }\n  }, {\n    key: \"actionRunner\",\n    get: function get() {\n      return this._actionRunner;\n    },\n    set: function set(actionRunner) {\n      if (actionRunner) {\n        this._actionRunner = actionRunner;\n        this.viewItems.forEach(function (item) {\n          return item.actionRunner = actionRunner;\n        });\n      }\n    }\n  }]);\n\n  return ActionBar;\n}(Disposable);","map":{"version":3,"sources":["/home/bar007/Desktop/projects/tio/client/node_modules/monaco-editor/esm/vs/base/browser/ui/actionbar/actionbar.js"],"names":["Disposable","dispose","ActionRunner","DOM","types","StandardKeyboardEvent","Emitter","ActionViewItem","BaseActionViewItem","ActionBar","container","options","_a","_b","_c","_d","_e","_f","triggerKeyDown","_onDidBlur","_register","onDidBlur","event","_onDidCancel","onFirstListenerAdd","cancelHasListener","onDidCancel","_onDidRun","onDidRun","_onBeforeRun","onBeforeRun","_context","context","_orientation","orientation","_triggerKeys","keyDown","triggerKeys","keys","actionRunner","_actionRunner","e","fire","_actionIds","viewItems","focusedItem","undefined","domNode","document","createElement","className","animated","classList","add","previousKeys","nextKeys","ignoreOrientationForPreviousAndNextKey","addDisposableListener","EventType","KEY_DOWN","eventHandled","equals","focusPrevious","focusNext","isTriggerKeyEvent","doTrigger","preventDefault","stopPropagation","KEY_UP","updateFocusedItem","focusTracker","trackFocus","getActiveElement","isAncestor","onDidFocus","actionsList","setAttribute","ariaLabel","appendChild","ret","forEach","keyCode","i","children","length","elem","arg","actions","Array","isArray","index","isNumber","action","actionViewItemElement","allowContextMenu","CONTEXT_MENU","EventHelper","stop","item","actionViewItemProvider","setActionContext","render","push","id","insertBefore","splice","focus","clearNode","selectFirst","firstEnabled","findIndex","isEnabled","updateFocus","startIndex","preventLoopNavigation","fromRight","preventScroll","actionViewItem","isFunction","blur","run","_action","getContainer","remove"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport './actionbar.css';\r\nimport { Disposable, dispose } from '../../../common/lifecycle.js';\r\nimport { ActionRunner } from '../../../common/actions.js';\r\nimport * as DOM from '../../dom.js';\r\nimport * as types from '../../../common/types.js';\r\nimport { StandardKeyboardEvent } from '../../keyboardEvent.js';\r\nimport { Emitter } from '../../../common/event.js';\r\nimport { ActionViewItem, BaseActionViewItem } from './actionViewItems.js';\r\nexport class ActionBar extends Disposable {\r\n    constructor(container, options = {}) {\r\n        var _a, _b, _c, _d, _e, _f;\r\n        super();\r\n        // Trigger Key Tracking\r\n        this.triggerKeyDown = false;\r\n        this._onDidBlur = this._register(new Emitter());\r\n        this.onDidBlur = this._onDidBlur.event;\r\n        this._onDidCancel = this._register(new Emitter({ onFirstListenerAdd: () => this.cancelHasListener = true }));\r\n        this.onDidCancel = this._onDidCancel.event;\r\n        this.cancelHasListener = false;\r\n        this._onDidRun = this._register(new Emitter());\r\n        this.onDidRun = this._onDidRun.event;\r\n        this._onBeforeRun = this._register(new Emitter());\r\n        this.onBeforeRun = this._onBeforeRun.event;\r\n        this.options = options;\r\n        this._context = (_a = options.context) !== null && _a !== void 0 ? _a : null;\r\n        this._orientation = (_b = this.options.orientation) !== null && _b !== void 0 ? _b : 0 /* HORIZONTAL */;\r\n        this._triggerKeys = {\r\n            keyDown: (_d = (_c = this.options.triggerKeys) === null || _c === void 0 ? void 0 : _c.keyDown) !== null && _d !== void 0 ? _d : false,\r\n            keys: (_f = (_e = this.options.triggerKeys) === null || _e === void 0 ? void 0 : _e.keys) !== null && _f !== void 0 ? _f : [3 /* Enter */, 10 /* Space */]\r\n        };\r\n        if (this.options.actionRunner) {\r\n            this._actionRunner = this.options.actionRunner;\r\n        }\r\n        else {\r\n            this._actionRunner = new ActionRunner();\r\n            this._register(this._actionRunner);\r\n        }\r\n        this._register(this._actionRunner.onDidRun(e => this._onDidRun.fire(e)));\r\n        this._register(this._actionRunner.onBeforeRun(e => this._onBeforeRun.fire(e)));\r\n        this._actionIds = [];\r\n        this.viewItems = [];\r\n        this.focusedItem = undefined;\r\n        this.domNode = document.createElement('div');\r\n        this.domNode.className = 'monaco-action-bar';\r\n        if (options.animated !== false) {\r\n            this.domNode.classList.add('animated');\r\n        }\r\n        let previousKeys;\r\n        let nextKeys;\r\n        switch (this._orientation) {\r\n            case 0 /* HORIZONTAL */:\r\n                previousKeys = this.options.ignoreOrientationForPreviousAndNextKey ? [15 /* LeftArrow */, 16 /* UpArrow */] : [15 /* LeftArrow */];\r\n                nextKeys = this.options.ignoreOrientationForPreviousAndNextKey ? [17 /* RightArrow */, 18 /* DownArrow */] : [17 /* RightArrow */];\r\n                break;\r\n            case 1 /* HORIZONTAL_REVERSE */:\r\n                previousKeys = this.options.ignoreOrientationForPreviousAndNextKey ? [17 /* RightArrow */, 18 /* DownArrow */] : [17 /* RightArrow */];\r\n                nextKeys = this.options.ignoreOrientationForPreviousAndNextKey ? [15 /* LeftArrow */, 16 /* UpArrow */] : [15 /* LeftArrow */];\r\n                this.domNode.className += ' reverse';\r\n                break;\r\n            case 2 /* VERTICAL */:\r\n                previousKeys = this.options.ignoreOrientationForPreviousAndNextKey ? [15 /* LeftArrow */, 16 /* UpArrow */] : [16 /* UpArrow */];\r\n                nextKeys = this.options.ignoreOrientationForPreviousAndNextKey ? [17 /* RightArrow */, 18 /* DownArrow */] : [18 /* DownArrow */];\r\n                this.domNode.className += ' vertical';\r\n                break;\r\n            case 3 /* VERTICAL_REVERSE */:\r\n                previousKeys = this.options.ignoreOrientationForPreviousAndNextKey ? [17 /* RightArrow */, 18 /* DownArrow */] : [18 /* DownArrow */];\r\n                nextKeys = this.options.ignoreOrientationForPreviousAndNextKey ? [15 /* LeftArrow */, 16 /* UpArrow */] : [16 /* UpArrow */];\r\n                this.domNode.className += ' vertical reverse';\r\n                break;\r\n        }\r\n        this._register(DOM.addDisposableListener(this.domNode, DOM.EventType.KEY_DOWN, e => {\r\n            const event = new StandardKeyboardEvent(e);\r\n            let eventHandled = true;\r\n            if (previousKeys && (event.equals(previousKeys[0]) || event.equals(previousKeys[1]))) {\r\n                eventHandled = this.focusPrevious();\r\n            }\r\n            else if (nextKeys && (event.equals(nextKeys[0]) || event.equals(nextKeys[1]))) {\r\n                eventHandled = this.focusNext();\r\n            }\r\n            else if (event.equals(9 /* Escape */) && this.cancelHasListener) {\r\n                this._onDidCancel.fire();\r\n            }\r\n            else if (this.isTriggerKeyEvent(event)) {\r\n                // Staying out of the else branch even if not triggered\r\n                if (this._triggerKeys.keyDown) {\r\n                    this.doTrigger(event);\r\n                }\r\n                else {\r\n                    this.triggerKeyDown = true;\r\n                }\r\n            }\r\n            else {\r\n                eventHandled = false;\r\n            }\r\n            if (eventHandled) {\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n            }\r\n        }));\r\n        this._register(DOM.addDisposableListener(this.domNode, DOM.EventType.KEY_UP, e => {\r\n            const event = new StandardKeyboardEvent(e);\r\n            // Run action on Enter/Space\r\n            if (this.isTriggerKeyEvent(event)) {\r\n                if (!this._triggerKeys.keyDown && this.triggerKeyDown) {\r\n                    this.triggerKeyDown = false;\r\n                    this.doTrigger(event);\r\n                }\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n            }\r\n            // Recompute focused item\r\n            else if (event.equals(2 /* Tab */) || event.equals(1024 /* Shift */ | 2 /* Tab */)) {\r\n                this.updateFocusedItem();\r\n            }\r\n        }));\r\n        this.focusTracker = this._register(DOM.trackFocus(this.domNode));\r\n        this._register(this.focusTracker.onDidBlur(() => {\r\n            if (DOM.getActiveElement() === this.domNode || !DOM.isAncestor(DOM.getActiveElement(), this.domNode)) {\r\n                this._onDidBlur.fire();\r\n                this.focusedItem = undefined;\r\n                this.triggerKeyDown = false;\r\n            }\r\n        }));\r\n        this._register(this.focusTracker.onDidFocus(() => this.updateFocusedItem()));\r\n        this.actionsList = document.createElement('ul');\r\n        this.actionsList.className = 'actions-container';\r\n        this.actionsList.setAttribute('role', 'toolbar');\r\n        if (this.options.ariaLabel) {\r\n            this.actionsList.setAttribute('aria-label', this.options.ariaLabel);\r\n        }\r\n        this.domNode.appendChild(this.actionsList);\r\n        container.appendChild(this.domNode);\r\n    }\r\n    isTriggerKeyEvent(event) {\r\n        let ret = false;\r\n        this._triggerKeys.keys.forEach(keyCode => {\r\n            ret = ret || event.equals(keyCode);\r\n        });\r\n        return ret;\r\n    }\r\n    updateFocusedItem() {\r\n        for (let i = 0; i < this.actionsList.children.length; i++) {\r\n            const elem = this.actionsList.children[i];\r\n            if (DOM.isAncestor(DOM.getActiveElement(), elem)) {\r\n                this.focusedItem = i;\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    get context() {\r\n        return this._context;\r\n    }\r\n    set context(context) {\r\n        this._context = context;\r\n        this.viewItems.forEach(i => i.setActionContext(context));\r\n    }\r\n    get actionRunner() {\r\n        return this._actionRunner;\r\n    }\r\n    set actionRunner(actionRunner) {\r\n        if (actionRunner) {\r\n            this._actionRunner = actionRunner;\r\n            this.viewItems.forEach(item => item.actionRunner = actionRunner);\r\n        }\r\n    }\r\n    getContainer() {\r\n        return this.domNode;\r\n    }\r\n    push(arg, options = {}) {\r\n        const actions = Array.isArray(arg) ? arg : [arg];\r\n        let index = types.isNumber(options.index) ? options.index : null;\r\n        actions.forEach((action) => {\r\n            const actionViewItemElement = document.createElement('li');\r\n            actionViewItemElement.className = 'action-item';\r\n            actionViewItemElement.setAttribute('role', 'presentation');\r\n            // Prevent native context menu on actions\r\n            if (!this.options.allowContextMenu) {\r\n                this._register(DOM.addDisposableListener(actionViewItemElement, DOM.EventType.CONTEXT_MENU, (e) => {\r\n                    DOM.EventHelper.stop(e, true);\r\n                }));\r\n            }\r\n            let item;\r\n            if (this.options.actionViewItemProvider) {\r\n                item = this.options.actionViewItemProvider(action);\r\n            }\r\n            if (!item) {\r\n                item = new ActionViewItem(this.context, action, options);\r\n            }\r\n            item.actionRunner = this._actionRunner;\r\n            item.setActionContext(this.context);\r\n            item.render(actionViewItemElement);\r\n            if (index === null || index < 0 || index >= this.actionsList.children.length) {\r\n                this.actionsList.appendChild(actionViewItemElement);\r\n                this.viewItems.push(item);\r\n                this._actionIds.push(action.id);\r\n            }\r\n            else {\r\n                this.actionsList.insertBefore(actionViewItemElement, this.actionsList.children[index]);\r\n                this.viewItems.splice(index, 0, item);\r\n                this._actionIds.splice(index, 0, action.id);\r\n                index++;\r\n            }\r\n        });\r\n        if (this.focusedItem) {\r\n            // After a clear actions might be re-added to simply toggle some actions. We should preserve focus #97128\r\n            this.focus(this.focusedItem);\r\n        }\r\n    }\r\n    clear() {\r\n        dispose(this.viewItems);\r\n        this.viewItems = [];\r\n        this._actionIds = [];\r\n        DOM.clearNode(this.actionsList);\r\n    }\r\n    focus(arg) {\r\n        let selectFirst = false;\r\n        let index = undefined;\r\n        if (arg === undefined) {\r\n            selectFirst = true;\r\n        }\r\n        else if (typeof arg === 'number') {\r\n            index = arg;\r\n        }\r\n        else if (typeof arg === 'boolean') {\r\n            selectFirst = arg;\r\n        }\r\n        if (selectFirst && typeof this.focusedItem === 'undefined') {\r\n            const firstEnabled = this.viewItems.findIndex(item => item.isEnabled());\r\n            // Focus the first enabled item\r\n            this.focusedItem = firstEnabled === -1 ? undefined : firstEnabled;\r\n            this.updateFocus();\r\n        }\r\n        else {\r\n            if (index !== undefined) {\r\n                this.focusedItem = index;\r\n            }\r\n            this.updateFocus();\r\n        }\r\n    }\r\n    focusNext() {\r\n        if (typeof this.focusedItem === 'undefined') {\r\n            this.focusedItem = this.viewItems.length - 1;\r\n        }\r\n        const startIndex = this.focusedItem;\r\n        let item;\r\n        do {\r\n            if (this.options.preventLoopNavigation && this.focusedItem + 1 >= this.viewItems.length) {\r\n                this.focusedItem = startIndex;\r\n                return false;\r\n            }\r\n            this.focusedItem = (this.focusedItem + 1) % this.viewItems.length;\r\n            item = this.viewItems[this.focusedItem];\r\n        } while (this.focusedItem !== startIndex && !item.isEnabled());\r\n        if (this.focusedItem === startIndex && !item.isEnabled()) {\r\n            this.focusedItem = undefined;\r\n        }\r\n        this.updateFocus();\r\n        return true;\r\n    }\r\n    focusPrevious() {\r\n        if (typeof this.focusedItem === 'undefined') {\r\n            this.focusedItem = 0;\r\n        }\r\n        const startIndex = this.focusedItem;\r\n        let item;\r\n        do {\r\n            this.focusedItem = this.focusedItem - 1;\r\n            if (this.focusedItem < 0) {\r\n                if (this.options.preventLoopNavigation) {\r\n                    this.focusedItem = startIndex;\r\n                    return false;\r\n                }\r\n                this.focusedItem = this.viewItems.length - 1;\r\n            }\r\n            item = this.viewItems[this.focusedItem];\r\n        } while (this.focusedItem !== startIndex && !item.isEnabled());\r\n        if (this.focusedItem === startIndex && !item.isEnabled()) {\r\n            this.focusedItem = undefined;\r\n        }\r\n        this.updateFocus(true);\r\n        return true;\r\n    }\r\n    updateFocus(fromRight, preventScroll) {\r\n        if (typeof this.focusedItem === 'undefined') {\r\n            this.actionsList.focus({ preventScroll });\r\n        }\r\n        for (let i = 0; i < this.viewItems.length; i++) {\r\n            const item = this.viewItems[i];\r\n            const actionViewItem = item;\r\n            if (i === this.focusedItem) {\r\n                if (types.isFunction(actionViewItem.isEnabled)) {\r\n                    if (actionViewItem.isEnabled() && types.isFunction(actionViewItem.focus)) {\r\n                        actionViewItem.focus(fromRight);\r\n                    }\r\n                    else {\r\n                        this.actionsList.focus({ preventScroll });\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                if (types.isFunction(actionViewItem.blur)) {\r\n                    actionViewItem.blur();\r\n                }\r\n            }\r\n        }\r\n    }\r\n    doTrigger(event) {\r\n        if (typeof this.focusedItem === 'undefined') {\r\n            return; //nothing to focus\r\n        }\r\n        // trigger action\r\n        const actionViewItem = this.viewItems[this.focusedItem];\r\n        if (actionViewItem instanceof BaseActionViewItem) {\r\n            const context = (actionViewItem._context === null || actionViewItem._context === undefined) ? event : actionViewItem._context;\r\n            this.run(actionViewItem._action, context);\r\n        }\r\n    }\r\n    run(action, context) {\r\n        return this._actionRunner.run(action, context);\r\n    }\r\n    dispose() {\r\n        dispose(this.viewItems);\r\n        this.viewItems = [];\r\n        this._actionIds = [];\r\n        this.getContainer().remove();\r\n        super.dispose();\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}