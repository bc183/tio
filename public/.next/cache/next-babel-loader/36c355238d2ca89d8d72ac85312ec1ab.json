{"ast":null,"code":"import _slicedToArray from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _classCallCheck from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/createClass\";\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) {\n    if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  }\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n\nimport { RunOnceScheduler } from '../../../base/common/async.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\nimport { IMenuService, isIMenuItem, MenuItemAction, MenuRegistry, SubmenuItemAction } from './actions.js';\nimport { ICommandService } from '../../commands/common/commands.js';\nimport { IContextKeyService } from '../../contextkey/common/contextkey.js';\n\nvar MenuService = /*#__PURE__*/function () {\n  function MenuService(_commandService) {\n    _classCallCheck(this, MenuService);\n\n    this._commandService = _commandService; //\n  }\n\n  _createClass(MenuService, [{\n    key: \"createMenu\",\n    value: function createMenu(id, contextKeyService) {\n      return new Menu(id, this._commandService, contextKeyService, this);\n    }\n  }]);\n\n  return MenuService;\n}();\n\nMenuService = __decorate([__param(0, ICommandService)], MenuService);\nexport { MenuService };\n\nvar Menu = /*#__PURE__*/function () {\n  function Menu(_id, _commandService, _contextKeyService, _menuService) {\n    var _this = this;\n\n    _classCallCheck(this, Menu);\n\n    this._id = _id;\n    this._commandService = _commandService;\n    this._contextKeyService = _contextKeyService;\n    this._menuService = _menuService;\n    this._dispoables = new DisposableStore();\n    this._onDidChange = new Emitter();\n    this.onDidChange = this._onDidChange.event;\n    this._menuGroups = [];\n    this._contextKeys = new Set();\n\n    this._build(); // rebuild this menu whenever the menu registry reports an\n    // event for this MenuId\n\n\n    var rebuildMenuSoon = new RunOnceScheduler(function () {\n      return _this._build();\n    }, 50);\n\n    this._dispoables.add(rebuildMenuSoon);\n\n    this._dispoables.add(MenuRegistry.onDidChangeMenu(function (e) {\n      if (e.has(_id)) {\n        rebuildMenuSoon.schedule();\n      }\n    })); // when context keys change we need to check if the menu also\n    // has changed\n\n\n    var fireChangeSoon = new RunOnceScheduler(function () {\n      return _this._onDidChange.fire(_this);\n    }, 50);\n\n    this._dispoables.add(fireChangeSoon);\n\n    this._dispoables.add(_contextKeyService.onDidChangeContext(function (e) {\n      if (e.affectsSome(_this._contextKeys)) {\n        fireChangeSoon.schedule();\n      }\n    }));\n  }\n\n  _createClass(Menu, [{\n    key: \"dispose\",\n    value: function dispose() {\n      this._dispoables.dispose();\n\n      this._onDidChange.dispose();\n    }\n  }, {\n    key: \"_build\",\n    value: function _build() {\n      // reset\n      this._menuGroups.length = 0;\n\n      this._contextKeys.clear();\n\n      var menuItems = MenuRegistry.getMenuItems(this._id);\n      var group;\n      menuItems.sort(Menu._compareMenuItems);\n\n      var _iterator = _createForOfIteratorHelper(menuItems),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var item = _step.value;\n          // group by groupId\n          var groupName = item.group || '';\n\n          if (!group || group[0] !== groupName) {\n            group = [groupName, []];\n\n            this._menuGroups.push(group);\n          }\n\n          group[1].push(item); // keep keys for eventing\n\n          Menu._fillInKbExprKeys(item.when, this._contextKeys);\n\n          if (isIMenuItem(item)) {\n            // keep precondition keys for event if applicable\n            if (item.command.precondition) {\n              Menu._fillInKbExprKeys(item.command.precondition, this._contextKeys);\n            } // keep toggled keys for event if applicable\n\n\n            if (item.command.toggled) {\n              var toggledExpression = item.command.toggled.condition || item.command.toggled;\n\n              Menu._fillInKbExprKeys(toggledExpression, this._contextKeys);\n            }\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      this._onDidChange.fire(this);\n    }\n  }, {\n    key: \"getActions\",\n    value: function getActions(options) {\n      var result = [];\n\n      var _iterator2 = _createForOfIteratorHelper(this._menuGroups),\n          _step2;\n\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var group = _step2.value;\n\n          var _group = _slicedToArray(group, 2),\n              id = _group[0],\n              items = _group[1];\n\n          var activeActions = [];\n\n          var _iterator3 = _createForOfIteratorHelper(items),\n              _step3;\n\n          try {\n            for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n              var item = _step3.value;\n\n              if (this._contextKeyService.contextMatchesRules(item.when)) {\n                var action = isIMenuItem(item) ? new MenuItemAction(item.command, item.alt, options, this._contextKeyService, this._commandService) : new SubmenuItemAction(item, this._menuService, this._contextKeyService, options);\n                activeActions.push(action);\n              }\n            }\n          } catch (err) {\n            _iterator3.e(err);\n          } finally {\n            _iterator3.f();\n          }\n\n          if (activeActions.length > 0) {\n            result.push([id, activeActions]);\n          }\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n\n      return result;\n    }\n  }], [{\n    key: \"_fillInKbExprKeys\",\n    value: function _fillInKbExprKeys(exp, set) {\n      if (exp) {\n        var _iterator4 = _createForOfIteratorHelper(exp.keys()),\n            _step4;\n\n        try {\n          for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n            var key = _step4.value;\n            set.add(key);\n          }\n        } catch (err) {\n          _iterator4.e(err);\n        } finally {\n          _iterator4.f();\n        }\n      }\n    }\n  }, {\n    key: \"_compareMenuItems\",\n    value: function _compareMenuItems(a, b) {\n      var aGroup = a.group;\n      var bGroup = b.group;\n\n      if (aGroup !== bGroup) {\n        // Falsy groups come last\n        if (!aGroup) {\n          return 1;\n        } else if (!bGroup) {\n          return -1;\n        } // 'navigation' group comes first\n\n\n        if (aGroup === 'navigation') {\n          return -1;\n        } else if (bGroup === 'navigation') {\n          return 1;\n        } // lexical sort for groups\n\n\n        var value = aGroup.localeCompare(bGroup);\n\n        if (value !== 0) {\n          return value;\n        }\n      } // sort on priority - default is 0\n\n\n      var aPrio = a.order || 0;\n      var bPrio = b.order || 0;\n\n      if (aPrio < bPrio) {\n        return -1;\n      } else if (aPrio > bPrio) {\n        return 1;\n      } // sort on titles\n\n\n      return Menu._compareTitles(isIMenuItem(a) ? a.command.title : a.title, isIMenuItem(b) ? b.command.title : b.title);\n    }\n  }, {\n    key: \"_compareTitles\",\n    value: function _compareTitles(a, b) {\n      var aStr = typeof a === 'string' ? a : a.original;\n      var bStr = typeof b === 'string' ? b : b.original;\n      return aStr.localeCompare(bStr);\n    }\n  }]);\n\n  return Menu;\n}();\n\nMenu = __decorate([__param(1, ICommandService), __param(2, IContextKeyService), __param(3, IMenuService)], Menu);","map":{"version":3,"sources":["/home/bar007/Desktop/projects/tio/client/node_modules/monaco-editor/esm/vs/platform/actions/common/menuService.js"],"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","RunOnceScheduler","Emitter","DisposableStore","IMenuService","isIMenuItem","MenuItemAction","MenuRegistry","SubmenuItemAction","ICommandService","IContextKeyService","MenuService","_commandService","id","contextKeyService","Menu","_id","_contextKeyService","_menuService","_dispoables","_onDidChange","onDidChange","event","_menuGroups","_contextKeys","Set","_build","rebuildMenuSoon","add","onDidChangeMenu","e","has","schedule","fireChangeSoon","fire","onDidChangeContext","affectsSome","dispose","clear","menuItems","getMenuItems","group","sort","_compareMenuItems","item","groupName","push","_fillInKbExprKeys","when","command","precondition","toggled","toggledExpression","condition","options","result","items","activeActions","contextMatchesRules","action","alt","exp","set","keys","a","b","aGroup","bGroup","value","localeCompare","aPrio","order","bPrio","_compareTitles","title","aStr","original","bStr"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { RunOnceScheduler } from '../../../base/common/async.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { IMenuService, isIMenuItem, MenuItemAction, MenuRegistry, SubmenuItemAction } from './actions.js';\r\nimport { ICommandService } from '../../commands/common/commands.js';\r\nimport { IContextKeyService } from '../../contextkey/common/contextkey.js';\r\nlet MenuService = class MenuService {\r\n    constructor(_commandService) {\r\n        this._commandService = _commandService;\r\n        //\r\n    }\r\n    createMenu(id, contextKeyService) {\r\n        return new Menu(id, this._commandService, contextKeyService, this);\r\n    }\r\n};\r\nMenuService = __decorate([\r\n    __param(0, ICommandService)\r\n], MenuService);\r\nexport { MenuService };\r\nlet Menu = class Menu {\r\n    constructor(_id, _commandService, _contextKeyService, _menuService) {\r\n        this._id = _id;\r\n        this._commandService = _commandService;\r\n        this._contextKeyService = _contextKeyService;\r\n        this._menuService = _menuService;\r\n        this._dispoables = new DisposableStore();\r\n        this._onDidChange = new Emitter();\r\n        this.onDidChange = this._onDidChange.event;\r\n        this._menuGroups = [];\r\n        this._contextKeys = new Set();\r\n        this._build();\r\n        // rebuild this menu whenever the menu registry reports an\r\n        // event for this MenuId\r\n        const rebuildMenuSoon = new RunOnceScheduler(() => this._build(), 50);\r\n        this._dispoables.add(rebuildMenuSoon);\r\n        this._dispoables.add(MenuRegistry.onDidChangeMenu(e => {\r\n            if (e.has(_id)) {\r\n                rebuildMenuSoon.schedule();\r\n            }\r\n        }));\r\n        // when context keys change we need to check if the menu also\r\n        // has changed\r\n        const fireChangeSoon = new RunOnceScheduler(() => this._onDidChange.fire(this), 50);\r\n        this._dispoables.add(fireChangeSoon);\r\n        this._dispoables.add(_contextKeyService.onDidChangeContext(e => {\r\n            if (e.affectsSome(this._contextKeys)) {\r\n                fireChangeSoon.schedule();\r\n            }\r\n        }));\r\n    }\r\n    dispose() {\r\n        this._dispoables.dispose();\r\n        this._onDidChange.dispose();\r\n    }\r\n    _build() {\r\n        // reset\r\n        this._menuGroups.length = 0;\r\n        this._contextKeys.clear();\r\n        const menuItems = MenuRegistry.getMenuItems(this._id);\r\n        let group;\r\n        menuItems.sort(Menu._compareMenuItems);\r\n        for (let item of menuItems) {\r\n            // group by groupId\r\n            const groupName = item.group || '';\r\n            if (!group || group[0] !== groupName) {\r\n                group = [groupName, []];\r\n                this._menuGroups.push(group);\r\n            }\r\n            group[1].push(item);\r\n            // keep keys for eventing\r\n            Menu._fillInKbExprKeys(item.when, this._contextKeys);\r\n            if (isIMenuItem(item)) {\r\n                // keep precondition keys for event if applicable\r\n                if (item.command.precondition) {\r\n                    Menu._fillInKbExprKeys(item.command.precondition, this._contextKeys);\r\n                }\r\n                // keep toggled keys for event if applicable\r\n                if (item.command.toggled) {\r\n                    const toggledExpression = item.command.toggled.condition || item.command.toggled;\r\n                    Menu._fillInKbExprKeys(toggledExpression, this._contextKeys);\r\n                }\r\n            }\r\n        }\r\n        this._onDidChange.fire(this);\r\n    }\r\n    getActions(options) {\r\n        const result = [];\r\n        for (let group of this._menuGroups) {\r\n            const [id, items] = group;\r\n            const activeActions = [];\r\n            for (const item of items) {\r\n                if (this._contextKeyService.contextMatchesRules(item.when)) {\r\n                    const action = isIMenuItem(item)\r\n                        ? new MenuItemAction(item.command, item.alt, options, this._contextKeyService, this._commandService)\r\n                        : new SubmenuItemAction(item, this._menuService, this._contextKeyService, options);\r\n                    activeActions.push(action);\r\n                }\r\n            }\r\n            if (activeActions.length > 0) {\r\n                result.push([id, activeActions]);\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n    static _fillInKbExprKeys(exp, set) {\r\n        if (exp) {\r\n            for (let key of exp.keys()) {\r\n                set.add(key);\r\n            }\r\n        }\r\n    }\r\n    static _compareMenuItems(a, b) {\r\n        let aGroup = a.group;\r\n        let bGroup = b.group;\r\n        if (aGroup !== bGroup) {\r\n            // Falsy groups come last\r\n            if (!aGroup) {\r\n                return 1;\r\n            }\r\n            else if (!bGroup) {\r\n                return -1;\r\n            }\r\n            // 'navigation' group comes first\r\n            if (aGroup === 'navigation') {\r\n                return -1;\r\n            }\r\n            else if (bGroup === 'navigation') {\r\n                return 1;\r\n            }\r\n            // lexical sort for groups\r\n            let value = aGroup.localeCompare(bGroup);\r\n            if (value !== 0) {\r\n                return value;\r\n            }\r\n        }\r\n        // sort on priority - default is 0\r\n        let aPrio = a.order || 0;\r\n        let bPrio = b.order || 0;\r\n        if (aPrio < bPrio) {\r\n            return -1;\r\n        }\r\n        else if (aPrio > bPrio) {\r\n            return 1;\r\n        }\r\n        // sort on titles\r\n        return Menu._compareTitles(isIMenuItem(a) ? a.command.title : a.title, isIMenuItem(b) ? b.command.title : b.title);\r\n    }\r\n    static _compareTitles(a, b) {\r\n        const aStr = typeof a === 'string' ? a : a.original;\r\n        const bStr = typeof b === 'string' ? b : b.original;\r\n        return aStr.localeCompare(bStr);\r\n    }\r\n};\r\nMenu = __decorate([\r\n    __param(1, ICommandService),\r\n    __param(2, IContextKeyService),\r\n    __param(3, IMenuService)\r\n], Menu);\r\n"]},"metadata":{},"sourceType":"module"}