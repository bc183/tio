{"ast":null,"code":"import _regeneratorRuntime from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport Axios from \"axios\";\nimport Image from \"next/image\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/router\";\nimport { Fragment, useEffect, useState } from \"react\";\nimport { useAuthDispatch, useAuthState } from \"../context/auth\";\n\nvar NavBar = function NavBar() {\n  var _useAuthState = useAuthState(),\n      authenticated = _useAuthState.authenticated,\n      loading = _useAuthState.loading;\n\n  var _useState = useState(null),\n      timer = _useState[0],\n      setTimer = _useState[1];\n\n  var _useState2 = useState(\"\"),\n      name = _useState2[0],\n      setName = _useState2[1];\n\n  var _useState3 = useState([]),\n      subs = _useState3[0],\n      setSubs = _useState3[1];\n\n  var dispatch = useAuthDispatch();\n  var router = useRouter();\n\n  var logout = function logout() {\n    Axios.get('/auth/logout').then(function () {\n      dispatch({\n        type: 'LOGOUT'\n      });\n      window.location.reload();\n    })[\"catch\"](function (err) {\n      console.log(err);\n    });\n  };\n\n  useEffect(function () {\n    if (name.trim() === '') {\n      setSubs([]);\n      return;\n    }\n\n    searchSubs();\n  }, [name]);\n\n  var searchSubs = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              clearTimeout(timer);\n              setTimer(setTimeout( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n                var _yield$Axios$get, data;\n\n                return _regeneratorRuntime.wrap(function _callee$(_context) {\n                  while (1) {\n                    switch (_context.prev = _context.next) {\n                      case 0:\n                        _context.prev = 0;\n                        _context.next = 3;\n                        return Axios.get(\"/subs/search/\".concat(name));\n\n                      case 3:\n                        _yield$Axios$get = _context.sent;\n                        data = _yield$Axios$get.data;\n                        setSubs(data);\n                        console.log(data);\n                        _context.next = 12;\n                        break;\n\n                      case 9:\n                        _context.prev = 9;\n                        _context.t0 = _context[\"catch\"](0);\n                        console.log(_context.t0);\n\n                      case 12:\n                      case \"end\":\n                        return _context.stop();\n                    }\n                  }\n                }, _callee, null, [[0, 9]]);\n              })), 250));\n\n            case 2:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function searchSubs() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var goToSub = function goToSub(subName) {\n    router.push(\"/r/\".concat(subName));\n    setName('');\n  };\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: \"fixed inset-x-0 top-0 z-10 flex items-center justify-between h-12 px-5 bg-white\",\n    children: [/*#__PURE__*/_jsx(\"div\", {\n      className: \"flex items-center\",\n      children: /*#__PURE__*/_jsx(\"span\", {\n        className: \"text-2xl font-semibold\",\n        children: /*#__PURE__*/_jsx(Link, {\n          href: \"/\",\n          children: /*#__PURE__*/_jsx(\"a\", {\n            children: \"TIO\"\n          })\n        })\n      })\n    }), /*#__PURE__*/_jsx(\"div\", {\n      className: \"max-w-full px-4 w-160\",\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: \"relative flex items-center mx-auto bg-gray-100 border rounded hover:border-blue-500 hover:bg-white\",\n        children: [/*#__PURE__*/_jsx(\"i\", {\n          className: \"pl-4 pr-3 text-gray-500 fas fa-search\"\n        }), /*#__PURE__*/_jsx(\"input\", {\n          type: \"text\",\n          placeholder: \"Search\",\n          value: name,\n          onChange: function onChange(e) {\n            return setName(e.target.value);\n          },\n          className: \"py-1 pr-3 bg-transparent rounded focus:outline-none\"\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"absolute left-0 right-0 bg-white\",\n          style: {\n            top: '100%'\n          },\n          children: subs === null || subs === void 0 ? void 0 : subs.map(function (sub) {\n            return /*#__PURE__*/_jsxs(\"div\", {\n              onClick: function onClick() {\n                return goToSub(sub.name);\n              },\n              className: \"flex items-center px-4 py-3 cursor-pointer hover:bg-gray-200\",\n              children: [/*#__PURE__*/_jsx(Image, {\n                className: \"rounded-full\",\n                src: sub.imageUrl,\n                alt: \"Sub\",\n                height: 8 * 16 / 4,\n                width: 8 * 16 / 4\n              }), /*#__PURE__*/_jsxs(\"div\", {\n                className: \"ml-4 text-sm\",\n                children: [/*#__PURE__*/_jsx(\"p\", {\n                  className: \"font-medium\",\n                  children: sub.name\n                }), /*#__PURE__*/_jsx(\"p\", {\n                  className: \"text-gray-600\",\n                  children: sub.title\n                })]\n              })]\n            }, sub.name);\n          })\n        })]\n      })\n    }), /*#__PURE__*/_jsx(\"div\", {\n      className: \"flex\",\n      children: !loading && (authenticated ? /*#__PURE__*/_jsx(\"button\", {\n        onClick: logout,\n        className: \"hidden w-20 py-1 mr-4 leading-5 sm:block lg:w-32 hollow blue button\",\n        children: \"Logout\"\n      }) : /*#__PURE__*/_jsxs(Fragment, {\n        children: [/*#__PURE__*/_jsx(Link, {\n          href: \"/login\",\n          children: /*#__PURE__*/_jsx(\"a\", {\n            className: \"hidden w-20 py-1 mr-4 leading-5 sm:block lg:w-32 hollow blue button\",\n            children: \"log in\"\n          })\n        }), /*#__PURE__*/_jsx(Link, {\n          href: \"/register\",\n          children: /*#__PURE__*/_jsx(\"a\", {\n            className: \"hidden w-20 py-1 leading-5 sm:block lg:w-32 blue button\",\n            children: \"register\"\n          })\n        })]\n      }))\n    })]\n  });\n};\n\nexport default NavBar;","map":null,"metadata":{},"sourceType":"module"}