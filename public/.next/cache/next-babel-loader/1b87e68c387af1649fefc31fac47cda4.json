{"ast":null,"code":"import _regeneratorRuntime from \"/home/barath007/projects/tio/client/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/barath007/projects/tio/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport Axios from \"axios\";\nimport Head from \"next/head\";\nimport { useRouter } from \"next/router\";\nimport { createRef, Fragment, useState } from \"react\";\nimport useSWR from \"swr\";\nimport SideBar from \"../../../components/SideBar\";\nexport var __N_SSP = true;\nexport default function submit() {\n  var router = useRouter();\n  var fileInputRef = /*#__PURE__*/createRef();\n  var subName = router.query.sub;\n\n  var _useSWR = useSWR(subName ? \"/subs/\".concat(subName) : null),\n      sub = _useSWR.data,\n      error = _useSWR.error;\n\n  if (error) {\n    router.push('/');\n  }\n\n  var _useState = useState(\"\"),\n      title = _useState[0],\n      setTitle = _useState[1];\n\n  var _useState2 = useState(false),\n      toggle = _useState2[0],\n      setToggle = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      body = _useState3[0],\n      setBody = _useState3[1];\n\n  var _useState4 = useState(null),\n      image = _useState4[0],\n      setImage = _useState4[1];\n\n  var _useState5 = useState(false),\n      isCode = _useState5[0],\n      setIsCode = _useState5[1];\n\n  var _useState6 = useState(\"Languages\"),\n      language = _useState6[0],\n      setLanguage = _useState6[1];\n\n  var openFileInput = function openFileInput(type) {\n    fileInputRef.current.name = type;\n    fileInputRef.current.click();\n  };\n\n  var changeImage = function changeImage(event) {\n    var file = event.target.files[0];\n    setImage(file);\n  };\n\n  var uploadImageAndSubmit = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(event) {\n      var formData, _yield$Axios$post, post;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              event.preventDefault();\n              formData = new FormData();\n              formData.append('file', image);\n              formData.append('title', title);\n              formData.append('body', body);\n              formData.append('sub', sub.name);\n              formData.append('isCode', isCode.toString());\n              formData.append('language', language);\n              console.log(isCode.toString());\n              _context.prev = 9;\n              _context.next = 12;\n              return Axios.post('/posts', formData, {\n                headers: {\n                  'Content-Type': 'multipart/form-data'\n                }\n              });\n\n            case 12:\n              _yield$Axios$post = _context.sent;\n              post = _yield$Axios$post.data;\n              router.push(\"/r/\".concat(sub.name, \"/\").concat(post.identifier, \"/\").concat(post.slug));\n              _context.next = 20;\n              break;\n\n            case 17:\n              _context.prev = 17;\n              _context.t0 = _context[\"catch\"](9);\n              console.log(_context.t0);\n\n            case 20:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[9, 17]]);\n    }));\n\n    return function uploadImageAndSubmit(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: \"container flex pt-5\",\n    children: [/*#__PURE__*/_jsx(Head, {\n      children: /*#__PURE__*/_jsx(\"title\", {\n        children: \"Submit to TIO\"\n      })\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: \"w-160\",\n      children: [/*#__PURE__*/_jsx(\"input\", {\n        type: \"file\",\n        hidden: true,\n        ref: fileInputRef,\n        onChange: changeImage\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"p-4 bg-white rounded\",\n        children: [/*#__PURE__*/_jsxs(\"h1\", {\n          className: \"mb-3 text-lg\",\n          children: [\"Submit a post to /r/\", subName]\n        }), /*#__PURE__*/_jsxs(\"form\", {\n          onSubmit: uploadImageAndSubmit,\n          children: [/*#__PURE__*/_jsxs(\"div\", {\n            className: \"relative mb-2\",\n            children: [/*#__PURE__*/_jsx(\"input\", {\n              type: \"text\",\n              className: \"w-full px-3 py-3 border border-gray-300 rounded focus:outline-none focus:border-gray-600\",\n              placeholder: \"Title\",\n              maxLength: 300,\n              value: title,\n              onChange: function onChange(e) {\n                return setTitle(e.target.value);\n              }\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: \"absolute mb-2 text-sm text-gray-500 select-none\",\n              style: {\n                top: 11,\n                right: 10\n              },\n              children: [title.trim().length, \" / 300\"]\n            })]\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            children: [/*#__PURE__*/_jsx(\"span\", {\n              onClick: function onClick() {\n                return openFileInput('file');\n              },\n              className: \"mb-2 fa fa-plus hover:bg-gray-200\"\n            }), /*#__PURE__*/_jsx(\"span\", {\n              className: \"m-2\",\n              children: \"Add Photo\"\n            })]\n          }), image && /*#__PURE__*/_jsx(\"p\", {\n            className: \"text-sm\",\n            children: \"Image uploaded!\"\n          }), (sub === null || sub === void 0 ? void 0 : sub.isCodingCommunity) === 'true' && /*#__PURE__*/_jsxs(Fragment, {\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              className: \"m-2 text-sm\",\n              children: /*#__PURE__*/_jsx(\"span\", {\n                children: \"Want to add a Code snippet? Select the Language and Paste the code in the text.\"\n              })\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: \"relative inline-block my-1 text-left\",\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                children: /*#__PURE__*/_jsxs(\"button\", {\n                  onClick: function onClick() {\n                    return setToggle(!toggle);\n                  },\n                  type: \"button\",\n                  className: \"inline-flex justify-center w-full px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none\",\n                  id: \"options-menu\",\n                  \"aria-haspopup\": \"true\",\n                  \"aria-expanded\": \"true\",\n                  children: [language, /*#__PURE__*/_jsx(\"svg\", {\n                    className: \"w-5 h-5 ml-2 -mr-1\",\n                    xmlns: \"http://www.w3.org/2000/svg\",\n                    viewBox: \"0 0 20 20\",\n                    fill: \"currentColor\",\n                    \"aria-hidden\": \"true\",\n                    children: /*#__PURE__*/_jsx(\"path\", {\n                      \"fill-rule\": \"evenodd\",\n                      d: \"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z\",\n                      \"clip-rule\": \"evenodd\"\n                    })\n                  })]\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"\".concat(toggle ? 'show' : 'hidden', \" absolute right-0 w-56 mt-2 origin-top-right bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5\"),\n                children: /*#__PURE__*/_jsxs(\"div\", {\n                  className: \"py-1\",\n                  role: \"menu\",\n                  \"aria-orientation\": \"vertical\",\n                  \"aria-labelledby\": \"options-menu\",\n                  children: [/*#__PURE__*/_jsx(\"p\", {\n                    className: \"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900\",\n                    role: \"menuitem\",\n                    onClick: function onClick() {\n                      setLanguage(\"c\");\n                      setToggle(false);\n                    },\n                    children: \" C \"\n                  }), /*#__PURE__*/_jsx(\"p\", {\n                    className: \"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900\",\n                    role: \"menuitem\",\n                    onClick: function onClick() {\n                      setLanguage(\"cpp\");\n                      setToggle(false);\n                    },\n                    children: \" C++ \"\n                  }), /*#__PURE__*/_jsx(\"p\", {\n                    className: \"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900\",\n                    role: \"menuitem\",\n                    onClick: function onClick() {\n                      setLanguage(\"python\");\n                      setToggle(false);\n                    },\n                    children: \" Python \"\n                  }), /*#__PURE__*/_jsx(\"p\", {\n                    className: \"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900\",\n                    role: \"menuitem\",\n                    onClick: function onClick() {\n                      setLanguage(\"java\");\n                      setToggle(false);\n                    },\n                    children: \" Java \"\n                  }), /*#__PURE__*/_jsx(\"p\", {\n                    className: \"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900\",\n                    role: \"menuitem\",\n                    onClick: function onClick() {\n                      setLanguage(\"javascript\");\n                      setToggle(false);\n                    },\n                    children: \" Javascript \"\n                  }), /*#__PURE__*/_jsx(\"p\", {\n                    className: \"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900\",\n                    role: \"menuitem\",\n                    onClick: function onClick() {\n                      setLanguage(\"ruby\");\n                      setToggle(false);\n                    },\n                    children: \" Ruby \"\n                  })]\n                })\n              })]\n            })]\n          }), /*#__PURE__*/_jsx(\"textarea\", {\n            className: \"w-full p-3 border border-gray-300 rounded focus:outline-none focus:border-gray-600\",\n            value: body,\n            placeholder: \"Text (optional)\",\n            rows: 4,\n            onChange: function onChange(e) {\n              return setBody(e.target.value);\n            }\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"flex justify-end\",\n            children: /*#__PURE__*/_jsx(\"button\", {\n              className: \"px-3 py-1 blue button\",\n              type: \"submit\",\n              disabled: title.trim().length === 0,\n              children: \"Submit\"\n            })\n          })]\n        })]\n      })]\n    }), sub && /*#__PURE__*/_jsx(SideBar, {\n      sub: sub\n    })]\n  });\n}","map":null,"metadata":{},"sourceType":"module"}