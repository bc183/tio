{"ast":null,"code":"import _classCallCheck from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _get from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/get\";\nimport _inherits from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport { SmoothScrollableElement } from '../../../../base/browser/ui/scrollbar/scrollableElement.js';\nimport { PartFingerprints, ViewPart } from '../../view/viewPart.js';\nimport { getThemeTypeSelector } from '../../../../platform/theme/common/themeService.js';\nexport var EditorScrollbar = /*#__PURE__*/function (_ViewPart) {\n  _inherits(EditorScrollbar, _ViewPart);\n\n  var _super = _createSuper(EditorScrollbar);\n\n  function EditorScrollbar(context, linesContent, viewDomNode, overflowGuardDomNode) {\n    var _this;\n\n    _classCallCheck(this, EditorScrollbar);\n\n    _this = _super.call(this, context);\n    var options = _this._context.configuration.options;\n    var scrollbar = options.get(87\n    /* scrollbar */\n    );\n    var mouseWheelScrollSensitivity = options.get(61\n    /* mouseWheelScrollSensitivity */\n    );\n    var fastScrollSensitivity = options.get(30\n    /* fastScrollSensitivity */\n    );\n    var scrollPredominantAxis = options.get(90\n    /* scrollPredominantAxis */\n    );\n    var scrollbarOptions = {\n      listenOnDomNode: viewDomNode.domNode,\n      className: 'editor-scrollable' + ' ' + getThemeTypeSelector(context.theme.type),\n      useShadows: false,\n      lazyRender: true,\n      vertical: scrollbar.vertical,\n      horizontal: scrollbar.horizontal,\n      verticalHasArrows: scrollbar.verticalHasArrows,\n      horizontalHasArrows: scrollbar.horizontalHasArrows,\n      verticalScrollbarSize: scrollbar.verticalScrollbarSize,\n      verticalSliderSize: scrollbar.verticalSliderSize,\n      horizontalScrollbarSize: scrollbar.horizontalScrollbarSize,\n      horizontalSliderSize: scrollbar.horizontalSliderSize,\n      handleMouseWheel: scrollbar.handleMouseWheel,\n      alwaysConsumeMouseWheel: scrollbar.alwaysConsumeMouseWheel,\n      arrowSize: scrollbar.arrowSize,\n      mouseWheelScrollSensitivity: mouseWheelScrollSensitivity,\n      fastScrollSensitivity: fastScrollSensitivity,\n      scrollPredominantAxis: scrollPredominantAxis,\n      scrollByPage: scrollbar.scrollByPage\n    };\n    _this.scrollbar = _this._register(new SmoothScrollableElement(linesContent.domNode, scrollbarOptions, _this._context.viewLayout.getScrollable()));\n    PartFingerprints.write(_this.scrollbar.getDomNode(), 5\n    /* ScrollableElement */\n    );\n    _this.scrollbarDomNode = createFastDomNode(_this.scrollbar.getDomNode());\n\n    _this.scrollbarDomNode.setPosition('absolute');\n\n    _this._setLayout(); // When having a zone widget that calls .focus() on one of its dom elements,\n    // the browser will try desperately to reveal that dom node, unexpectedly\n    // changing the .scrollTop of this.linesContent\n\n\n    var onBrowserDesperateReveal = function onBrowserDesperateReveal(domNode, lookAtScrollTop, lookAtScrollLeft) {\n      var newScrollPosition = {};\n\n      if (lookAtScrollTop) {\n        var deltaTop = domNode.scrollTop;\n\n        if (deltaTop) {\n          newScrollPosition.scrollTop = _this._context.viewLayout.getCurrentScrollTop() + deltaTop;\n          domNode.scrollTop = 0;\n        }\n      }\n\n      if (lookAtScrollLeft) {\n        var deltaLeft = domNode.scrollLeft;\n\n        if (deltaLeft) {\n          newScrollPosition.scrollLeft = _this._context.viewLayout.getCurrentScrollLeft() + deltaLeft;\n          domNode.scrollLeft = 0;\n        }\n      }\n\n      _this._context.model.setScrollPosition(newScrollPosition, 1\n      /* Immediate */\n      );\n    }; // I've seen this happen both on the view dom node & on the lines content dom node.\n\n\n    _this._register(dom.addDisposableListener(viewDomNode.domNode, 'scroll', function (e) {\n      return onBrowserDesperateReveal(viewDomNode.domNode, true, true);\n    }));\n\n    _this._register(dom.addDisposableListener(linesContent.domNode, 'scroll', function (e) {\n      return onBrowserDesperateReveal(linesContent.domNode, true, false);\n    }));\n\n    _this._register(dom.addDisposableListener(overflowGuardDomNode.domNode, 'scroll', function (e) {\n      return onBrowserDesperateReveal(overflowGuardDomNode.domNode, true, false);\n    }));\n\n    _this._register(dom.addDisposableListener(_this.scrollbarDomNode.domNode, 'scroll', function (e) {\n      return onBrowserDesperateReveal(_this.scrollbarDomNode.domNode, true, false);\n    }));\n\n    return _this;\n  }\n\n  _createClass(EditorScrollbar, [{\n    key: \"dispose\",\n    value: function dispose() {\n      _get(_getPrototypeOf(EditorScrollbar.prototype), \"dispose\", this).call(this);\n    }\n  }, {\n    key: \"_setLayout\",\n    value: function _setLayout() {\n      var options = this._context.configuration.options;\n      var layoutInfo = options.get(124\n      /* layoutInfo */\n      );\n      this.scrollbarDomNode.setLeft(layoutInfo.contentLeft);\n      var minimap = options.get(59\n      /* minimap */\n      );\n      var side = minimap.side;\n\n      if (side === 'right') {\n        this.scrollbarDomNode.setWidth(layoutInfo.contentWidth + layoutInfo.minimap.minimapWidth);\n      } else {\n        this.scrollbarDomNode.setWidth(layoutInfo.contentWidth);\n      }\n\n      this.scrollbarDomNode.setHeight(layoutInfo.height);\n    }\n  }, {\n    key: \"getOverviewRulerLayoutInfo\",\n    value: function getOverviewRulerLayoutInfo() {\n      return this.scrollbar.getOverviewRulerLayoutInfo();\n    }\n  }, {\n    key: \"getDomNode\",\n    value: function getDomNode() {\n      return this.scrollbarDomNode;\n    }\n  }, {\n    key: \"delegateVerticalScrollbarMouseDown\",\n    value: function delegateVerticalScrollbarMouseDown(browserEvent) {\n      this.scrollbar.delegateVerticalScrollbarMouseDown(browserEvent);\n    } // --- begin event handlers\n\n  }, {\n    key: \"onConfigurationChanged\",\n    value: function onConfigurationChanged(e) {\n      if (e.hasChanged(87\n      /* scrollbar */\n      ) || e.hasChanged(61\n      /* mouseWheelScrollSensitivity */\n      ) || e.hasChanged(30\n      /* fastScrollSensitivity */\n      )) {\n        var options = this._context.configuration.options;\n        var scrollbar = options.get(87\n        /* scrollbar */\n        );\n        var mouseWheelScrollSensitivity = options.get(61\n        /* mouseWheelScrollSensitivity */\n        );\n        var fastScrollSensitivity = options.get(30\n        /* fastScrollSensitivity */\n        );\n        var scrollPredominantAxis = options.get(90\n        /* scrollPredominantAxis */\n        );\n        var newOpts = {\n          handleMouseWheel: scrollbar.handleMouseWheel,\n          mouseWheelScrollSensitivity: mouseWheelScrollSensitivity,\n          fastScrollSensitivity: fastScrollSensitivity,\n          scrollPredominantAxis: scrollPredominantAxis\n        };\n        this.scrollbar.updateOptions(newOpts);\n      }\n\n      if (e.hasChanged(124\n      /* layoutInfo */\n      )) {\n        this._setLayout();\n      }\n\n      return true;\n    }\n  }, {\n    key: \"onScrollChanged\",\n    value: function onScrollChanged(e) {\n      return true;\n    }\n  }, {\n    key: \"onThemeChanged\",\n    value: function onThemeChanged(e) {\n      this.scrollbar.updateClassName('editor-scrollable' + ' ' + getThemeTypeSelector(this._context.theme.type));\n      return true;\n    } // --- end event handlers\n\n  }, {\n    key: \"prepareRender\",\n    value: function prepareRender(ctx) {// Nothing to do\n    }\n  }, {\n    key: \"render\",\n    value: function render(ctx) {\n      this.scrollbar.renderNow();\n    }\n  }]);\n\n  return EditorScrollbar;\n}(ViewPart);","map":{"version":3,"sources":["/home/bar007/Desktop/projects/tio/client/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/editorScrollbar/editorScrollbar.js"],"names":["dom","createFastDomNode","SmoothScrollableElement","PartFingerprints","ViewPart","getThemeTypeSelector","EditorScrollbar","context","linesContent","viewDomNode","overflowGuardDomNode","options","_context","configuration","scrollbar","get","mouseWheelScrollSensitivity","fastScrollSensitivity","scrollPredominantAxis","scrollbarOptions","listenOnDomNode","domNode","className","theme","type","useShadows","lazyRender","vertical","horizontal","verticalHasArrows","horizontalHasArrows","verticalScrollbarSize","verticalSliderSize","horizontalScrollbarSize","horizontalSliderSize","handleMouseWheel","alwaysConsumeMouseWheel","arrowSize","scrollByPage","_register","viewLayout","getScrollable","write","getDomNode","scrollbarDomNode","setPosition","_setLayout","onBrowserDesperateReveal","lookAtScrollTop","lookAtScrollLeft","newScrollPosition","deltaTop","scrollTop","getCurrentScrollTop","deltaLeft","scrollLeft","getCurrentScrollLeft","model","setScrollPosition","addDisposableListener","e","layoutInfo","setLeft","contentLeft","minimap","side","setWidth","contentWidth","minimapWidth","setHeight","height","getOverviewRulerLayoutInfo","browserEvent","delegateVerticalScrollbarMouseDown","hasChanged","newOpts","updateOptions","updateClassName","ctx","renderNow"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as dom from '../../../../base/browser/dom.js';\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport { SmoothScrollableElement } from '../../../../base/browser/ui/scrollbar/scrollableElement.js';\r\nimport { PartFingerprints, ViewPart } from '../../view/viewPart.js';\r\nimport { getThemeTypeSelector } from '../../../../platform/theme/common/themeService.js';\r\nexport class EditorScrollbar extends ViewPart {\r\n    constructor(context, linesContent, viewDomNode, overflowGuardDomNode) {\r\n        super(context);\r\n        const options = this._context.configuration.options;\r\n        const scrollbar = options.get(87 /* scrollbar */);\r\n        const mouseWheelScrollSensitivity = options.get(61 /* mouseWheelScrollSensitivity */);\r\n        const fastScrollSensitivity = options.get(30 /* fastScrollSensitivity */);\r\n        const scrollPredominantAxis = options.get(90 /* scrollPredominantAxis */);\r\n        const scrollbarOptions = {\r\n            listenOnDomNode: viewDomNode.domNode,\r\n            className: 'editor-scrollable' + ' ' + getThemeTypeSelector(context.theme.type),\r\n            useShadows: false,\r\n            lazyRender: true,\r\n            vertical: scrollbar.vertical,\r\n            horizontal: scrollbar.horizontal,\r\n            verticalHasArrows: scrollbar.verticalHasArrows,\r\n            horizontalHasArrows: scrollbar.horizontalHasArrows,\r\n            verticalScrollbarSize: scrollbar.verticalScrollbarSize,\r\n            verticalSliderSize: scrollbar.verticalSliderSize,\r\n            horizontalScrollbarSize: scrollbar.horizontalScrollbarSize,\r\n            horizontalSliderSize: scrollbar.horizontalSliderSize,\r\n            handleMouseWheel: scrollbar.handleMouseWheel,\r\n            alwaysConsumeMouseWheel: scrollbar.alwaysConsumeMouseWheel,\r\n            arrowSize: scrollbar.arrowSize,\r\n            mouseWheelScrollSensitivity: mouseWheelScrollSensitivity,\r\n            fastScrollSensitivity: fastScrollSensitivity,\r\n            scrollPredominantAxis: scrollPredominantAxis,\r\n            scrollByPage: scrollbar.scrollByPage,\r\n        };\r\n        this.scrollbar = this._register(new SmoothScrollableElement(linesContent.domNode, scrollbarOptions, this._context.viewLayout.getScrollable()));\r\n        PartFingerprints.write(this.scrollbar.getDomNode(), 5 /* ScrollableElement */);\r\n        this.scrollbarDomNode = createFastDomNode(this.scrollbar.getDomNode());\r\n        this.scrollbarDomNode.setPosition('absolute');\r\n        this._setLayout();\r\n        // When having a zone widget that calls .focus() on one of its dom elements,\r\n        // the browser will try desperately to reveal that dom node, unexpectedly\r\n        // changing the .scrollTop of this.linesContent\r\n        const onBrowserDesperateReveal = (domNode, lookAtScrollTop, lookAtScrollLeft) => {\r\n            const newScrollPosition = {};\r\n            if (lookAtScrollTop) {\r\n                const deltaTop = domNode.scrollTop;\r\n                if (deltaTop) {\r\n                    newScrollPosition.scrollTop = this._context.viewLayout.getCurrentScrollTop() + deltaTop;\r\n                    domNode.scrollTop = 0;\r\n                }\r\n            }\r\n            if (lookAtScrollLeft) {\r\n                const deltaLeft = domNode.scrollLeft;\r\n                if (deltaLeft) {\r\n                    newScrollPosition.scrollLeft = this._context.viewLayout.getCurrentScrollLeft() + deltaLeft;\r\n                    domNode.scrollLeft = 0;\r\n                }\r\n            }\r\n            this._context.model.setScrollPosition(newScrollPosition, 1 /* Immediate */);\r\n        };\r\n        // I've seen this happen both on the view dom node & on the lines content dom node.\r\n        this._register(dom.addDisposableListener(viewDomNode.domNode, 'scroll', (e) => onBrowserDesperateReveal(viewDomNode.domNode, true, true)));\r\n        this._register(dom.addDisposableListener(linesContent.domNode, 'scroll', (e) => onBrowserDesperateReveal(linesContent.domNode, true, false)));\r\n        this._register(dom.addDisposableListener(overflowGuardDomNode.domNode, 'scroll', (e) => onBrowserDesperateReveal(overflowGuardDomNode.domNode, true, false)));\r\n        this._register(dom.addDisposableListener(this.scrollbarDomNode.domNode, 'scroll', (e) => onBrowserDesperateReveal(this.scrollbarDomNode.domNode, true, false)));\r\n    }\r\n    dispose() {\r\n        super.dispose();\r\n    }\r\n    _setLayout() {\r\n        const options = this._context.configuration.options;\r\n        const layoutInfo = options.get(124 /* layoutInfo */);\r\n        this.scrollbarDomNode.setLeft(layoutInfo.contentLeft);\r\n        const minimap = options.get(59 /* minimap */);\r\n        const side = minimap.side;\r\n        if (side === 'right') {\r\n            this.scrollbarDomNode.setWidth(layoutInfo.contentWidth + layoutInfo.minimap.minimapWidth);\r\n        }\r\n        else {\r\n            this.scrollbarDomNode.setWidth(layoutInfo.contentWidth);\r\n        }\r\n        this.scrollbarDomNode.setHeight(layoutInfo.height);\r\n    }\r\n    getOverviewRulerLayoutInfo() {\r\n        return this.scrollbar.getOverviewRulerLayoutInfo();\r\n    }\r\n    getDomNode() {\r\n        return this.scrollbarDomNode;\r\n    }\r\n    delegateVerticalScrollbarMouseDown(browserEvent) {\r\n        this.scrollbar.delegateVerticalScrollbarMouseDown(browserEvent);\r\n    }\r\n    // --- begin event handlers\r\n    onConfigurationChanged(e) {\r\n        if (e.hasChanged(87 /* scrollbar */)\r\n            || e.hasChanged(61 /* mouseWheelScrollSensitivity */)\r\n            || e.hasChanged(30 /* fastScrollSensitivity */)) {\r\n            const options = this._context.configuration.options;\r\n            const scrollbar = options.get(87 /* scrollbar */);\r\n            const mouseWheelScrollSensitivity = options.get(61 /* mouseWheelScrollSensitivity */);\r\n            const fastScrollSensitivity = options.get(30 /* fastScrollSensitivity */);\r\n            const scrollPredominantAxis = options.get(90 /* scrollPredominantAxis */);\r\n            const newOpts = {\r\n                handleMouseWheel: scrollbar.handleMouseWheel,\r\n                mouseWheelScrollSensitivity: mouseWheelScrollSensitivity,\r\n                fastScrollSensitivity: fastScrollSensitivity,\r\n                scrollPredominantAxis: scrollPredominantAxis\r\n            };\r\n            this.scrollbar.updateOptions(newOpts);\r\n        }\r\n        if (e.hasChanged(124 /* layoutInfo */)) {\r\n            this._setLayout();\r\n        }\r\n        return true;\r\n    }\r\n    onScrollChanged(e) {\r\n        return true;\r\n    }\r\n    onThemeChanged(e) {\r\n        this.scrollbar.updateClassName('editor-scrollable' + ' ' + getThemeTypeSelector(this._context.theme.type));\r\n        return true;\r\n    }\r\n    // --- end event handlers\r\n    prepareRender(ctx) {\r\n        // Nothing to do\r\n    }\r\n    render(ctx) {\r\n        this.scrollbar.renderNow();\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}