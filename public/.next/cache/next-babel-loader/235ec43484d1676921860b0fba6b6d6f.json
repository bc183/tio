{"ast":null,"code":"import _regeneratorRuntime from \"/home/barath007/projects/tio/client/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/barath007/projects/tio/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/home/barath007/projects/tio/client/pages/r/[sub]/[identifier]/[slug].tsx\",\n    _s = $RefreshSig$();\n\nimport Head from 'next/head';\nimport Link from 'next/link';\nimport { useRouter } from 'next/router';\nimport useSWR from 'swr';\nimport Image from 'next/image';\nimport dayjs from 'dayjs';\nimport relativeTime from 'dayjs/plugin/relativeTime';\nimport classNames from 'classnames';\nimport Sidebar from '../../../../components/SideBar';\nimport Axios from 'axios';\nimport { useAuthState } from '../../../../context/auth';\nimport ActionButton from '../../../../components/ActionButton';\nimport { Fragment, useEffect, useState } from 'react';\nimport SyntaxHighlighter from 'react-syntax-highlighter';\ndayjs.extend(relativeTime);\nexport default function PostPage() {\n  _s();\n\n  var _this = this;\n\n  // Local state\n  var _useState = useState(\"\"),\n      newComment = _useState[0],\n      setNewComment = _useState[1]; // Global state\n\n\n  var _useAuthState = useAuthState(),\n      authenticated = _useAuthState.authenticated,\n      user = _useAuthState.user;\n\n  var _useState2 = useState(\"\"),\n      description = _useState2[0],\n      setDescription = _useState2[1]; // Utils\n\n\n  var router = useRouter();\n  var _router$query = router.query,\n      identifier = _router$query.identifier,\n      sub = _router$query.sub,\n      slug = _router$query.slug;\n\n  var _useSWR = useSWR(identifier && slug ? \"/posts/\".concat(identifier, \"/\").concat(slug) : null),\n      post = _useSWR.data,\n      error = _useSWR.error,\n      revalidatePost = _useSWR.revalidate;\n\n  var _useSWR2 = useSWR(identifier && slug ? \"/posts/\".concat(identifier, \"/\").concat(slug, \"/comments\") : null),\n      comments = _useSWR2.data,\n      revalidate = _useSWR2.revalidate;\n\n  useEffect(function () {\n    if (!post) {\n      return;\n    }\n\n    var desc = post.body || post.title;\n    desc = desc.substr(0, 158).concat('...');\n    setDescription(desc);\n  }, [post]);\n  if (error) router.push('/');\n\n  var vote = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(value, comment) {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              // If not logged in go to login\n              if (!authenticated) router.push('/login'); // If vote is the same reset vote\n\n              if (!comment && value === post.userVote || comment && comment.userVote === value) value = 0;\n              _context.prev = 2;\n              _context.next = 5;\n              return Axios.post('/misc/vote', {\n                identifier: identifier,\n                slug: slug,\n                commentIdentifier: comment === null || comment === void 0 ? void 0 : comment.identifier,\n                value: value\n              });\n\n            case 5:\n              res = _context.sent;\n\n              if (revalidate) {\n                revalidatePost();\n              }\n\n              if (comment) {\n                revalidate();\n              } //console.log(res.data)\n\n\n              _context.next = 13;\n              break;\n\n            case 10:\n              _context.prev = 10;\n              _context.t0 = _context[\"catch\"](2);\n              console.log(_context.t0);\n\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[2, 10]]);\n    }));\n\n    return function vote(_x, _x2) {\n      return _ref.apply(this, arguments);\n    };\n  }(); //console.log(comments);\n\n\n  var submitComment = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event) {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              event.preventDefault();\n\n              if (!(newComment.trim() === '')) {\n                _context2.next = 3;\n                break;\n              }\n\n              return _context2.abrupt(\"return\");\n\n            case 3:\n              _context2.prev = 3;\n              _context2.next = 6;\n              return Axios.post(\"/posts/\".concat(post.identifier, \"/\").concat(post.slug, \"/comments\"), {\n                body: newComment\n              });\n\n            case 6:\n              setNewComment('');\n\n              if (revalidate) {\n                revalidate();\n              }\n\n              _context2.next = 13;\n              break;\n\n            case 10:\n              _context2.prev = 10;\n              _context2.t0 = _context2[\"catch\"](3);\n              console.log(_context2.t0);\n\n            case 13:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[3, 10]]);\n    }));\n\n    return function submitComment(_x3) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Head, {\n      children: [/*#__PURE__*/_jsxDEV(\"title\", {\n        children: post === null || post === void 0 ? void 0 : post.title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"meta\", {\n        name: \"description\",\n        content: description\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"meta\", {\n        property: \"og:description\",\n        content: description\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"meta\", {\n        property: \"og:title\",\n        content: post === null || post === void 0 ? void 0 : post.title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"meta\", {\n        property: \"twitter:title\",\n        content: post === null || post === void 0 ? void 0 : post.title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"meta\", {\n        property: \"twitter:description\",\n        content: description\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Link, {\n      href: \"/r/\".concat(sub),\n      children: /*#__PURE__*/_jsxDEV(\"a\", {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center w-full h-20 p-8 bg-blue-500\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"container flex\",\n            children: [post && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-8 h-8 mr-2 overflow-hidden rounded-full\",\n              children: /*#__PURE__*/_jsxDEV(Image, {\n                src: post.sub.imageUrl,\n                height: 8 * 16 / 4,\n                width: 8 * 16 / 4\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 120,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 119,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-xl font-semibold text-white\",\n              children: [\"/r/\", sub]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 127,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 117,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container flex pt-5\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-160\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white rounded\",\n          children: post && /*#__PURE__*/_jsxDEV(Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex-shrink-0 w-10 py-2 text-center rounded-l\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"w-6 mx-auto text-gray-400 rounded cursor-pointer hover:bg-gray-300 hover:text-red-500\",\n                  onClick: function onClick() {\n                    return vote(1);\n                  },\n                  children: /*#__PURE__*/_jsxDEV(\"i\", {\n                    className: classNames('icon-arrow-up', {\n                      'text-red-500': post.userVote === 1\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 146,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 142,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-xs font-bold\",\n                  children: post.voteScore\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 152,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"w-6 mx-auto text-gray-400 rounded cursor-pointer hover:bg-gray-300 hover:text-blue-600\",\n                  onClick: function onClick() {\n                    return vote(-1);\n                  },\n                  children: /*#__PURE__*/_jsxDEV(\"i\", {\n                    className: classNames('icon-arrow-down', {\n                      'text-blue-600': post.userVote === -1\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 158,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 154,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 140,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"py-2 pr-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center\",\n                  children: /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"text-xs text-gray-500\",\n                    children: [\"Posted by\", /*#__PURE__*/_jsxDEV(Link, {\n                      href: \"/u/\".concat(post.username),\n                      children: /*#__PURE__*/_jsxDEV(\"a\", {\n                        className: \"mx-1 hover:underline\",\n                        children: [\"/u/\", post.username]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 170,\n                        columnNumber: 25\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 169,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(Link, {\n                      href: post.url,\n                      children: /*#__PURE__*/_jsxDEV(\"a\", {\n                        className: \"mx-1 hover:underline\",\n                        children: dayjs(post.createdAt).fromNow()\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 175,\n                        columnNumber: 25\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 174,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 167,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 166,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n                  className: \"my-1 text-xl font-medium\",\n                  children: post.title\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 182,\n                  columnNumber: 19\n                }, this), post.imageUrl !== null && /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: post.imageUrl\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 183,\n                  columnNumber: 46\n                }, this), post.body && post.language !== 'Languages' ? /*#__PURE__*/_jsxDEV(SyntaxHighlighter, {\n                  className: \"my-1 text-sm\",\n                  language: post.language,\n                  children: post.body\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 185,\n                  columnNumber: 67\n                }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"my-1 text-sm\",\n                  children: post.body\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 187,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex\",\n                  children: [/*#__PURE__*/_jsxDEV(Link, {\n                    href: post.url,\n                    children: /*#__PURE__*/_jsxDEV(\"a\", {\n                      children: /*#__PURE__*/_jsxDEV(ActionButton, {\n                        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                          className: \"mr-1 fas fa-comment-alt fa-xs\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 195,\n                          columnNumber: 27\n                        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"font-bold\",\n                          children: [post.commentCount, \" Comments\"]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 196,\n                          columnNumber: 27\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 194,\n                        columnNumber: 25\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 193,\n                      columnNumber: 23\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 192,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(ActionButton, {\n                    children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                      className: \"mr-1 fas fa-share fa-xs\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 203,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"font-bold\",\n                      children: \"Share\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 204,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 202,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(ActionButton, {\n                    children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                      className: \"mr-1 fas fa-bookmark fa-xs\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 207,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"font-bold\",\n                      children: \"Save\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 208,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 206,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 191,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 165,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 138,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"pl-10 pr-6 mb-4\",\n              children: authenticated ? /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"mb-1 text-xs\",\n                  children: [\"Comment as\", /*#__PURE__*/_jsxDEV(Link, {\n                    href: \"/u/\".concat(user.username),\n                    children: /*#__PURE__*/_jsxDEV(\"a\", {\n                      className: \"ml-1 font-semibold text-blue-500\",\n                      children: user.username\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 220,\n                      columnNumber: 33\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 219,\n                    columnNumber: 29\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 217,\n                  columnNumber: 27\n                }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n                  onSubmit: submitComment,\n                  children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n                    className: \"w-full p-3 border border-gray-300 rounded focus:outline-none focus:border-gray-600\",\n                    onChange: function onChange(e) {\n                      return setNewComment(e.target.value);\n                    },\n                    value: newComment\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 226,\n                    columnNumber: 29\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex justify-end\",\n                    children: /*#__PURE__*/_jsxDEV(\"button\", {\n                      className: \"px-3 py-1 blue button\",\n                      disabled: newComment.trim() === '',\n                      children: \"Comment\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 232,\n                      columnNumber: 33\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 231,\n                    columnNumber: 29\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 225,\n                  columnNumber: 27\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 216,\n                columnNumber: 23\n              }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center justify-between px-2 py-4 border border-gray-200\",\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"font-semibold text-gray-400\",\n                  children: \"Log in or Sign up to leave a comment\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 240,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(Link, {\n                    href: \"/login\",\n                    children: /*#__PURE__*/_jsxDEV(\"a\", {\n                      className: \"px-4 py-1 mr-4 hollow blue button\",\n                      children: \"Login\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 245,\n                      columnNumber: 33\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 244,\n                    columnNumber: 29\n                  }, this), /*#__PURE__*/_jsxDEV(Link, {\n                    href: \"/register\",\n                    children: /*#__PURE__*/_jsxDEV(\"a\", {\n                      className: \"px-4 py-1 blue button\",\n                      children: \"Sign up\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 250,\n                      columnNumber: 33\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 249,\n                    columnNumber: 29\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 243,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 239,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 214,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 258,\n              columnNumber: 15\n            }, this), comments === null || comments === void 0 ? void 0 : comments.map(function (comment) {\n              return /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex-shrink-0 w-10 py-2 text-center rounded-l\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"w-6 mx-auto text-gray-400 rounded cursor-pointer hover:bg-gray-300 hover:text-red-500\",\n                    onClick: function onClick() {\n                      return vote(1, comment);\n                    },\n                    children: /*#__PURE__*/_jsxDEV(\"i\", {\n                      className: classNames('icon-arrow-up', {\n                        'text-red-500': comment.userVote === 1\n                      })\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 267,\n                      columnNumber: 21\n                    }, _this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 263,\n                    columnNumber: 19\n                  }, _this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"text-xs font-bold\",\n                    children: comment.voteScore\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 273,\n                    columnNumber: 19\n                  }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"w-6 mx-auto text-gray-400 rounded cursor-pointer hover:bg-gray-300 hover:text-blue-600\",\n                    onClick: function onClick() {\n                      return vote(-1, comment);\n                    },\n                    children: /*#__PURE__*/_jsxDEV(\"i\", {\n                      className: classNames('icon-arrow-down', {\n                        'text-blue-600': comment.userVote === -1\n                      })\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 279,\n                      columnNumber: 21\n                    }, _this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 275,\n                    columnNumber: 19\n                  }, _this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 261,\n                  columnNumber: 21\n                }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"py-2 pr-2\",\n                  children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"mb-1 text-xs leading-none\",\n                    children: [/*#__PURE__*/_jsxDEV(Link, {\n                      href: \"/u/\".concat(comment.username),\n                      children: /*#__PURE__*/_jsxDEV(\"a\", {\n                        className: \"mr-1 font-bold hover:underline\",\n                        children: comment.username\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 289,\n                        columnNumber: 29\n                      }, _this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 288,\n                      columnNumber: 25\n                    }, _this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-gray-600\",\n                      children: \"\\n                                \".concat(comment.voteScore, \"\\n                                points .\\n                                \").concat(dayjs(comment.createdAt).fromNow(), \"\\n                            \")\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 293,\n                      columnNumber: 25\n                    }, _this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 287,\n                    columnNumber: 21\n                  }, _this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    children: comment.body\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 301,\n                    columnNumber: 21\n                  }, _this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 286,\n                  columnNumber: 17\n                }, _this)]\n              }, comment.identifier, true, {\n                fileName: _jsxFileName,\n                lineNumber: 260,\n                columnNumber: 19\n              }, _this);\n            })]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 9\n      }, this), post && /*#__PURE__*/_jsxDEV(Sidebar, {\n        sub: post.sub\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 310,\n        columnNumber: 18\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\n_s(PostPage, \"TJYoNojCk0BgX4f0lcQa02U3Q0U=\", false, function () {\n  return [useAuthState, useRouter, useSWR, useSWR];\n});\n\n_c = PostPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"PostPage\");","map":{"version":3,"sources":["/home/barath007/projects/tio/client/pages/r/[sub]/[identifier]/[slug].tsx"],"names":["Head","Link","useRouter","useSWR","Image","dayjs","relativeTime","classNames","Sidebar","Axios","useAuthState","ActionButton","Fragment","useEffect","useState","SyntaxHighlighter","extend","PostPage","newComment","setNewComment","authenticated","user","description","setDescription","router","query","identifier","sub","slug","post","data","error","revalidatePost","revalidate","comments","desc","body","title","substr","concat","push","vote","value","comment","userVote","commentIdentifier","res","console","log","submitComment","event","preventDefault","trim","imageUrl","voteScore","username","url","createdAt","fromNow","language","commentCount","e","target","map"],"mappings":"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","sourcesContent":["import Head from 'next/head'\nimport Link from 'next/link'\nimport { useRouter } from 'next/router'\nimport useSWR from 'swr'\nimport Image from 'next/image'\nimport dayjs from 'dayjs'\nimport relativeTime from 'dayjs/plugin/relativeTime'\nimport classNames from 'classnames'\n\nimport { Post, Comment } from '../../../../types'\nimport Sidebar from '../../../../components/SideBar';\nimport Axios from 'axios'\nimport { useAuthState } from '../../../../context/auth'\nimport ActionButton from '../../../../components/ActionButton';\nimport { FormEvent, Fragment, useEffect, useState } from 'react';\nimport SyntaxHighlighter from 'react-syntax-highlighter';\n\n\ndayjs.extend(relativeTime)\n\nexport default function PostPage() {\n  // Local state\n    const [newComment, setNewComment] = useState(\"\");\n  // Global state\n  const { authenticated, user } = useAuthState();\n  const [description, setDescription] = useState(\"\");\n\n  \n\n  // Utils\n  const router = useRouter();\n  const { identifier, sub, slug } = router.query\n\n  const { data: post, error, revalidate: revalidatePost } = useSWR<Post>(\n    identifier && slug ? `/posts/${identifier}/${slug}` : null\n  )\n\n  const { data: comments, revalidate} = useSWR<Comment[]>(\n    identifier && slug ? `/posts/${identifier}/${slug}/comments` : null\n  )\n\n  useEffect(() => {\n    if(!post) {\n      return;\n    }\n\n    let desc = post.body || post.title;\n    desc = desc.substr(0, 158).concat('...');\n    setDescription(desc);\n  }, [post])\n\n  if (error) router.push('/')\n\n  const vote = async (value: number, comment?: Comment) => {\n    // If not logged in go to login\n    if (!authenticated) router.push('/login')\n\n    // If vote is the same reset vote\n    if ((!comment && value === post.userVote) || (comment && comment.userVote === value)) value = 0\n\n    try {\n      const res = await Axios.post('/misc/vote', {\n        identifier,\n        slug,\n        commentIdentifier: comment?.identifier,\n        value,\n      })\n\n      if (revalidate) {\n        revalidatePost();\n      }\n\n      if(comment) {\n        revalidate();\n      }\n\n      //console.log(res.data)\n    } catch (err) {\n      console.log(err)\n    }\n  }\n  //console.log(comments);\n\n  const submitComment = async (event: FormEvent) => {\n    event.preventDefault();\n    if(newComment.trim() === '') {\n        return;\n    }\n\n    try {\n        await Axios.post(`/posts/${post.identifier}/${post.slug}/comments`, {\n            body: newComment\n        });\n        setNewComment('');\n        if (revalidate) {\n          revalidate();\n        }\n    } catch (error) {\n        console.log(error);\n    }\n  }\n\n  return (\n    <>\n      <Head>\n        <title>{post?.title}</title>\n        <meta name=\"description\" content={description}>\n        </meta>\n        <meta property=\"og:description\" content={description} />\n        <meta property=\"og:title\" content={post?.title} />\n        <meta property=\"twitter:title\" content={post?.title} />\n        <meta property=\"twitter:description\" content={description} />\n      </Head>\n      <Link href={`/r/${sub}`}>\n        <a>\n          <div className=\"flex items-center w-full h-20 p-8 bg-blue-500\">\n            <div className=\"container flex\">\n              {post && (\n                <div className=\"w-8 h-8 mr-2 overflow-hidden rounded-full\">\n                  <Image\n                    src={post.sub.imageUrl}\n                    height={(8 * 16) / 4}\n                    width={(8 * 16) / 4}\n                  />\n                </div>\n              )}\n              <p className=\"text-xl font-semibold text-white\">/r/{sub}</p>\n            </div>\n          </div>\n        </a>\n      </Link>\n      <div className=\"container flex pt-5\">\n        {/* Post */}\n        <div className=\"w-160\">\n          <div className=\"bg-white rounded\">\n            {post && (\n                <Fragment>\n              <div className=\"flex\">\n                {/* Vote section */}\n                <div className=\"flex-shrink-0 w-10 py-2 text-center rounded-l\">\n                  {/* Upvote */}\n                  <div\n                    className=\"w-6 mx-auto text-gray-400 rounded cursor-pointer hover:bg-gray-300 hover:text-red-500\"\n                    onClick={() => vote(1)}\n                  >\n                    <i\n                      className={classNames('icon-arrow-up', {\n                        'text-red-500': post.userVote === 1,\n                      })}\n                    ></i>\n                  </div>\n                  <p className=\"text-xs font-bold\">{post.voteScore}</p>\n                  {/* Downvote */}\n                  <div\n                    className=\"w-6 mx-auto text-gray-400 rounded cursor-pointer hover:bg-gray-300 hover:text-blue-600\"\n                    onClick={() => vote(-1)}\n                  >\n                    <i\n                      className={classNames('icon-arrow-down', {\n                        'text-blue-600': post.userVote === -1,\n                      })}\n                    ></i>\n                  </div>\n                </div>\n                <div className=\"py-2 pr-2\">\n                  <div className=\"flex items-center\">\n                    <p className=\"text-xs text-gray-500\">\n                      Posted by\n                      <Link href={`/u/${post.username}`}>\n                        <a className=\"mx-1 hover:underline\">\n                          /u/{post.username}\n                        </a>\n                      </Link>\n                      <Link href={post.url}>\n                        <a className=\"mx-1 hover:underline\">\n                          {dayjs(post.createdAt).fromNow()}\n                        </a>\n                      </Link>\n                    </p>\n                  </div>\n                  {/* Post title */}\n                  <h1 className=\"my-1 text-xl font-medium\">{post.title}</h1>\n                  {post.imageUrl !== null && <img src={post.imageUrl}/>}\n                  {/* Post body */}\n                  {(post.body && post.language !== 'Languages') ? <SyntaxHighlighter className=\"my-1 text-sm\" language={post.language}>\n                        {post.body}\n                  </SyntaxHighlighter>: <p className=\"my-1 text-sm\">\n                    {post.body}\n                  </p>}\n                  {/* Actions */}\n                  <div className=\"flex\">\n                    <Link href={post.url}>\n                      <a>\n                        <ActionButton>\n                          <i className=\"mr-1 fas fa-comment-alt fa-xs\"></i>\n                          <span className=\"font-bold\">\n                            {post.commentCount} Comments\n                          </span>\n                        </ActionButton>\n                      </a>\n                    </Link>\n                    <ActionButton>\n                      <i className=\"mr-1 fas fa-share fa-xs\"></i>\n                      <span className=\"font-bold\">Share</span>\n                    </ActionButton>\n                    <ActionButton>\n                      <i className=\"mr-1 fas fa-bookmark fa-xs\"></i>\n                      <span className=\"font-bold\">Save</span>\n                    </ActionButton>\n                  </div>\n                </div>\n              </div>\n              {/* comment input area */}\n              <div className=\"pl-10 pr-6 mb-4\">\n                  {authenticated ? (\n                      <div>\n                          <p className=\"mb-1 text-xs\">\n                            Comment as \n                            <Link href={`/u/${user.username}`}>\n                                <a className=\"ml-1 font-semibold text-blue-500\">\n                                    {user.username}\n                                </a>\n                            </Link>\n                          </p>\n                          <form onSubmit={submitComment}>\n                            <textarea className=\"w-full p-3 border border-gray-300 rounded focus:outline-none focus:border-gray-600\"\n                                onChange={e => setNewComment(e.target.value)}\n                                value={newComment}\n                            >\n                            </textarea>\n                            <div className=\"flex justify-end\">\n                                <button className=\"px-3 py-1 blue button\" disabled={newComment.trim() === ''}>\n                                    Comment\n                                </button>\n                            </div>\n                          </form>\n                      </div>\n                  ): (\n                    <div className=\"flex items-center justify-between px-2 py-4 border border-gray-200\">\n                        <p className=\"font-semibold text-gray-400\">\n                            Log in or Sign up to leave a comment\n                        </p>\n                        <div>\n                            <Link href=\"/login\">\n                                <a className=\"px-4 py-1 mr-4 hollow blue button\">\n                                    Login\n                                </a>\n                            </Link>\n                            <Link href=\"/register\">\n                                <a className=\"px-4 py-1 blue button\">\n                                    Sign up\n                                </a>\n                            </Link>\n                        </div>\n                    </div>\n                  )}\n              </div>\n              <hr/>\n              {comments?.map(comment => (\n                  <div className=\"flex\" key={comment.identifier}>\n                    <div className=\"flex-shrink-0 w-10 py-2 text-center rounded-l\">\n                  {/* Upvote */}\n                  <div\n                    className=\"w-6 mx-auto text-gray-400 rounded cursor-pointer hover:bg-gray-300 hover:text-red-500\"\n                    onClick={() => vote(1, comment)}\n                  >\n                    <i\n                      className={classNames('icon-arrow-up', {\n                        'text-red-500': comment.userVote === 1,\n                      })}\n                    ></i>\n                  </div>\n                  <p className=\"text-xs font-bold\">{comment.voteScore}</p>\n                  {/* Downvote */}\n                  <div\n                    className=\"w-6 mx-auto text-gray-400 rounded cursor-pointer hover:bg-gray-300 hover:text-blue-600\"\n                    onClick={() => vote(-1, comment)}\n                  >\n                    <i\n                      className={classNames('icon-arrow-down', {\n                        'text-blue-600': comment.userVote === -1,\n                      })}\n                    ></i>\n                  </div>\n                </div>\n                <div className=\"py-2 pr-2\">\n                    <p className=\"mb-1 text-xs leading-none\">\n                        <Link href={`/u/${comment.username}`}>\n                            <a className=\"mr-1 font-bold hover:underline\">\n                                {comment.username}\n                            </a>\n                        </Link>\n                        <span className=\"text-gray-600\">\n                            {`\n                                ${comment.voteScore}\n                                points .\n                                ${dayjs(comment.createdAt).fromNow()}\n                            `}\n                        </span>\n                    </p>\n                    <p>{comment.body}</p>\n                </div>\n                  </div>\n              ))}\n              </Fragment>\n            )}\n          </div>\n        </div>\n        {/* Sidebar */}\n        {post && <Sidebar sub={post.sub} />}\n      </div>\n    </>\n  )\n}"]},"metadata":{},"sourceType":"module"}