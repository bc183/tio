{"ast":null,"code":"import _classCallCheck from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _get from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/get\";\nimport _inherits from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nimport './viewCursors.css';\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport { IntervalTimer, TimeoutTimer } from '../../../../base/common/async.js';\nimport { ViewPart } from '../../view/viewPart.js';\nimport { ViewCursor } from './viewCursor.js';\nimport { TextEditorCursorStyle } from '../../../common/config/editorOptions.js';\nimport { editorCursorBackground, editorCursorForeground } from '../../../common/view/editorColorRegistry.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nexport var ViewCursors = /*#__PURE__*/function (_ViewPart) {\n  _inherits(ViewCursors, _ViewPart);\n\n  var _super = _createSuper(ViewCursors);\n\n  function ViewCursors(context) {\n    var _this;\n\n    _classCallCheck(this, ViewCursors);\n\n    _this = _super.call(this, context);\n    var options = _this._context.configuration.options;\n    _this._readOnly = options.get(75\n    /* readOnly */\n    );\n    _this._cursorBlinking = options.get(19\n    /* cursorBlinking */\n    );\n    _this._cursorStyle = options.get(21\n    /* cursorStyle */\n    );\n    _this._cursorSmoothCaretAnimation = options.get(20\n    /* cursorSmoothCaretAnimation */\n    );\n    _this._selectionIsEmpty = true;\n    _this._isComposingInput = false;\n    _this._isVisible = false;\n    _this._primaryCursor = new ViewCursor(_this._context);\n    _this._secondaryCursors = [];\n    _this._renderData = [];\n    _this._domNode = createFastDomNode(document.createElement('div'));\n\n    _this._domNode.setAttribute('role', 'presentation');\n\n    _this._domNode.setAttribute('aria-hidden', 'true');\n\n    _this._updateDomClassName();\n\n    _this._domNode.appendChild(_this._primaryCursor.getDomNode());\n\n    _this._startCursorBlinkAnimation = new TimeoutTimer();\n    _this._cursorFlatBlinkInterval = new IntervalTimer();\n    _this._blinkingEnabled = false;\n    _this._editorHasFocus = false;\n\n    _this._updateBlinking();\n\n    return _this;\n  }\n\n  _createClass(ViewCursors, [{\n    key: \"dispose\",\n    value: function dispose() {\n      _get(_getPrototypeOf(ViewCursors.prototype), \"dispose\", this).call(this);\n\n      this._startCursorBlinkAnimation.dispose();\n\n      this._cursorFlatBlinkInterval.dispose();\n    }\n  }, {\n    key: \"getDomNode\",\n    value: function getDomNode() {\n      return this._domNode;\n    } // --- begin event handlers\n\n  }, {\n    key: \"onCompositionStart\",\n    value: function onCompositionStart(e) {\n      this._isComposingInput = true;\n\n      this._updateBlinking();\n\n      return true;\n    }\n  }, {\n    key: \"onCompositionEnd\",\n    value: function onCompositionEnd(e) {\n      this._isComposingInput = false;\n\n      this._updateBlinking();\n\n      return true;\n    }\n  }, {\n    key: \"onConfigurationChanged\",\n    value: function onConfigurationChanged(e) {\n      var options = this._context.configuration.options;\n      this._readOnly = options.get(75\n      /* readOnly */\n      );\n      this._cursorBlinking = options.get(19\n      /* cursorBlinking */\n      );\n      this._cursorStyle = options.get(21\n      /* cursorStyle */\n      );\n      this._cursorSmoothCaretAnimation = options.get(20\n      /* cursorSmoothCaretAnimation */\n      );\n\n      this._updateBlinking();\n\n      this._updateDomClassName();\n\n      this._primaryCursor.onConfigurationChanged(e);\n\n      for (var i = 0, len = this._secondaryCursors.length; i < len; i++) {\n        this._secondaryCursors[i].onConfigurationChanged(e);\n      }\n\n      return true;\n    }\n  }, {\n    key: \"_onCursorPositionChanged\",\n    value: function _onCursorPositionChanged(position, secondaryPositions) {\n      this._primaryCursor.onCursorPositionChanged(position);\n\n      this._updateBlinking();\n\n      if (this._secondaryCursors.length < secondaryPositions.length) {\n        // Create new cursors\n        var addCnt = secondaryPositions.length - this._secondaryCursors.length;\n\n        for (var i = 0; i < addCnt; i++) {\n          var newCursor = new ViewCursor(this._context);\n\n          this._domNode.domNode.insertBefore(newCursor.getDomNode().domNode, this._primaryCursor.getDomNode().domNode.nextSibling);\n\n          this._secondaryCursors.push(newCursor);\n        }\n      } else if (this._secondaryCursors.length > secondaryPositions.length) {\n        // Remove some cursors\n        var removeCnt = this._secondaryCursors.length - secondaryPositions.length;\n\n        for (var _i = 0; _i < removeCnt; _i++) {\n          this._domNode.removeChild(this._secondaryCursors[0].getDomNode());\n\n          this._secondaryCursors.splice(0, 1);\n        }\n      }\n\n      for (var _i2 = 0; _i2 < secondaryPositions.length; _i2++) {\n        this._secondaryCursors[_i2].onCursorPositionChanged(secondaryPositions[_i2]);\n      }\n    }\n  }, {\n    key: \"onCursorStateChanged\",\n    value: function onCursorStateChanged(e) {\n      var positions = [];\n\n      for (var i = 0, len = e.selections.length; i < len; i++) {\n        positions[i] = e.selections[i].getPosition();\n      }\n\n      this._onCursorPositionChanged(positions[0], positions.slice(1));\n\n      var selectionIsEmpty = e.selections[0].isEmpty();\n\n      if (this._selectionIsEmpty !== selectionIsEmpty) {\n        this._selectionIsEmpty = selectionIsEmpty;\n\n        this._updateDomClassName();\n      }\n\n      return true;\n    }\n  }, {\n    key: \"onDecorationsChanged\",\n    value: function onDecorationsChanged(e) {\n      // true for inline decorations that can end up relayouting text\n      return true;\n    }\n  }, {\n    key: \"onFlushed\",\n    value: function onFlushed(e) {\n      return true;\n    }\n  }, {\n    key: \"onFocusChanged\",\n    value: function onFocusChanged(e) {\n      this._editorHasFocus = e.isFocused;\n\n      this._updateBlinking();\n\n      return false;\n    }\n  }, {\n    key: \"onLinesChanged\",\n    value: function onLinesChanged(e) {\n      return true;\n    }\n  }, {\n    key: \"onLinesDeleted\",\n    value: function onLinesDeleted(e) {\n      return true;\n    }\n  }, {\n    key: \"onLinesInserted\",\n    value: function onLinesInserted(e) {\n      return true;\n    }\n  }, {\n    key: \"onScrollChanged\",\n    value: function onScrollChanged(e) {\n      return true;\n    }\n  }, {\n    key: \"onTokensChanged\",\n    value: function onTokensChanged(e) {\n      var shouldRender = function shouldRender(position) {\n        for (var i = 0, len = e.ranges.length; i < len; i++) {\n          if (e.ranges[i].fromLineNumber <= position.lineNumber && position.lineNumber <= e.ranges[i].toLineNumber) {\n            return true;\n          }\n        }\n\n        return false;\n      };\n\n      if (shouldRender(this._primaryCursor.getPosition())) {\n        return true;\n      }\n\n      var _iterator = _createForOfIteratorHelper(this._secondaryCursors),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var secondaryCursor = _step.value;\n\n          if (shouldRender(secondaryCursor.getPosition())) {\n            return true;\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      return false;\n    }\n  }, {\n    key: \"onZonesChanged\",\n    value: function onZonesChanged(e) {\n      return true;\n    } // --- end event handlers\n    // ---- blinking logic\n\n  }, {\n    key: \"_getCursorBlinking\",\n    value: function _getCursorBlinking() {\n      if (this._isComposingInput) {\n        // avoid double cursors\n        return 0\n        /* Hidden */\n        ;\n      }\n\n      if (!this._editorHasFocus) {\n        return 0\n        /* Hidden */\n        ;\n      }\n\n      if (this._readOnly) {\n        return 5\n        /* Solid */\n        ;\n      }\n\n      return this._cursorBlinking;\n    }\n  }, {\n    key: \"_updateBlinking\",\n    value: function _updateBlinking() {\n      var _this2 = this;\n\n      this._startCursorBlinkAnimation.cancel();\n\n      this._cursorFlatBlinkInterval.cancel();\n\n      var blinkingStyle = this._getCursorBlinking(); // hidden and solid are special as they involve no animations\n\n\n      var isHidden = blinkingStyle === 0\n      /* Hidden */\n      ;\n      var isSolid = blinkingStyle === 5\n      /* Solid */\n      ;\n\n      if (isHidden) {\n        this._hide();\n      } else {\n        this._show();\n      }\n\n      this._blinkingEnabled = false;\n\n      this._updateDomClassName();\n\n      if (!isHidden && !isSolid) {\n        if (blinkingStyle === 1\n        /* Blink */\n        ) {\n            // flat blinking is handled by JavaScript to save battery life due to Chromium step timing issue https://bugs.chromium.org/p/chromium/issues/detail?id=361587\n            this._cursorFlatBlinkInterval.cancelAndSet(function () {\n              if (_this2._isVisible) {\n                _this2._hide();\n              } else {\n                _this2._show();\n              }\n            }, ViewCursors.BLINK_INTERVAL);\n          } else {\n          this._startCursorBlinkAnimation.setIfNotSet(function () {\n            _this2._blinkingEnabled = true;\n\n            _this2._updateDomClassName();\n          }, ViewCursors.BLINK_INTERVAL);\n        }\n      }\n    } // --- end blinking logic\n\n  }, {\n    key: \"_updateDomClassName\",\n    value: function _updateDomClassName() {\n      this._domNode.setClassName(this._getClassName());\n    }\n  }, {\n    key: \"_getClassName\",\n    value: function _getClassName() {\n      var result = 'cursors-layer';\n\n      if (!this._selectionIsEmpty) {\n        result += ' has-selection';\n      }\n\n      switch (this._cursorStyle) {\n        case TextEditorCursorStyle.Line:\n          result += ' cursor-line-style';\n          break;\n\n        case TextEditorCursorStyle.Block:\n          result += ' cursor-block-style';\n          break;\n\n        case TextEditorCursorStyle.Underline:\n          result += ' cursor-underline-style';\n          break;\n\n        case TextEditorCursorStyle.LineThin:\n          result += ' cursor-line-thin-style';\n          break;\n\n        case TextEditorCursorStyle.BlockOutline:\n          result += ' cursor-block-outline-style';\n          break;\n\n        case TextEditorCursorStyle.UnderlineThin:\n          result += ' cursor-underline-thin-style';\n          break;\n\n        default:\n          result += ' cursor-line-style';\n      }\n\n      if (this._blinkingEnabled) {\n        switch (this._getCursorBlinking()) {\n          case 1\n          /* Blink */\n          :\n            result += ' cursor-blink';\n            break;\n\n          case 2\n          /* Smooth */\n          :\n            result += ' cursor-smooth';\n            break;\n\n          case 3\n          /* Phase */\n          :\n            result += ' cursor-phase';\n            break;\n\n          case 4\n          /* Expand */\n          :\n            result += ' cursor-expand';\n            break;\n\n          case 5\n          /* Solid */\n          :\n            result += ' cursor-solid';\n            break;\n\n          default:\n            result += ' cursor-solid';\n        }\n      } else {\n        result += ' cursor-solid';\n      }\n\n      if (this._cursorSmoothCaretAnimation) {\n        result += ' cursor-smooth-caret-animation';\n      }\n\n      return result;\n    }\n  }, {\n    key: \"_show\",\n    value: function _show() {\n      this._primaryCursor.show();\n\n      for (var i = 0, len = this._secondaryCursors.length; i < len; i++) {\n        this._secondaryCursors[i].show();\n      }\n\n      this._isVisible = true;\n    }\n  }, {\n    key: \"_hide\",\n    value: function _hide() {\n      this._primaryCursor.hide();\n\n      for (var i = 0, len = this._secondaryCursors.length; i < len; i++) {\n        this._secondaryCursors[i].hide();\n      }\n\n      this._isVisible = false;\n    } // ---- IViewPart implementation\n\n  }, {\n    key: \"prepareRender\",\n    value: function prepareRender(ctx) {\n      this._primaryCursor.prepareRender(ctx);\n\n      for (var i = 0, len = this._secondaryCursors.length; i < len; i++) {\n        this._secondaryCursors[i].prepareRender(ctx);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render(ctx) {\n      var renderData = [],\n          renderDataLen = 0;\n\n      var primaryRenderData = this._primaryCursor.render(ctx);\n\n      if (primaryRenderData) {\n        renderData[renderDataLen++] = primaryRenderData;\n      }\n\n      for (var i = 0, len = this._secondaryCursors.length; i < len; i++) {\n        var secondaryRenderData = this._secondaryCursors[i].render(ctx);\n\n        if (secondaryRenderData) {\n          renderData[renderDataLen++] = secondaryRenderData;\n        }\n      }\n\n      this._renderData = renderData;\n    }\n  }, {\n    key: \"getLastRenderData\",\n    value: function getLastRenderData() {\n      return this._renderData;\n    }\n  }]);\n\n  return ViewCursors;\n}(ViewPart);\nViewCursors.BLINK_INTERVAL = 500;\nregisterThemingParticipant(function (theme, collector) {\n  var caret = theme.getColor(editorCursorForeground);\n\n  if (caret) {\n    var caretBackground = theme.getColor(editorCursorBackground);\n\n    if (!caretBackground) {\n      caretBackground = caret.opposite();\n    }\n\n    collector.addRule(\".monaco-editor .cursors-layer .cursor { background-color: \".concat(caret, \"; border-color: \").concat(caret, \"; color: \").concat(caretBackground, \"; }\"));\n\n    if (theme.type === 'hc') {\n      collector.addRule(\".monaco-editor .cursors-layer.has-selection .cursor { border-left: 1px solid \".concat(caretBackground, \"; border-right: 1px solid \").concat(caretBackground, \"; }\"));\n    }\n  }\n});","map":{"version":3,"sources":["/home/bar007/Desktop/projects/tio/client/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/viewCursors/viewCursors.js"],"names":["createFastDomNode","IntervalTimer","TimeoutTimer","ViewPart","ViewCursor","TextEditorCursorStyle","editorCursorBackground","editorCursorForeground","registerThemingParticipant","ViewCursors","context","options","_context","configuration","_readOnly","get","_cursorBlinking","_cursorStyle","_cursorSmoothCaretAnimation","_selectionIsEmpty","_isComposingInput","_isVisible","_primaryCursor","_secondaryCursors","_renderData","_domNode","document","createElement","setAttribute","_updateDomClassName","appendChild","getDomNode","_startCursorBlinkAnimation","_cursorFlatBlinkInterval","_blinkingEnabled","_editorHasFocus","_updateBlinking","dispose","e","onConfigurationChanged","i","len","length","position","secondaryPositions","onCursorPositionChanged","addCnt","newCursor","domNode","insertBefore","nextSibling","push","removeCnt","removeChild","splice","positions","selections","getPosition","_onCursorPositionChanged","slice","selectionIsEmpty","isEmpty","isFocused","shouldRender","ranges","fromLineNumber","lineNumber","toLineNumber","secondaryCursor","cancel","blinkingStyle","_getCursorBlinking","isHidden","isSolid","_hide","_show","cancelAndSet","BLINK_INTERVAL","setIfNotSet","setClassName","_getClassName","result","Line","Block","Underline","LineThin","BlockOutline","UnderlineThin","show","hide","ctx","prepareRender","renderData","renderDataLen","primaryRenderData","render","secondaryRenderData","theme","collector","caret","getColor","caretBackground","opposite","addRule","type"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport './viewCursors.css';\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport { IntervalTimer, TimeoutTimer } from '../../../../base/common/async.js';\r\nimport { ViewPart } from '../../view/viewPart.js';\r\nimport { ViewCursor } from './viewCursor.js';\r\nimport { TextEditorCursorStyle } from '../../../common/config/editorOptions.js';\r\nimport { editorCursorBackground, editorCursorForeground } from '../../../common/view/editorColorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nexport class ViewCursors extends ViewPart {\r\n    constructor(context) {\r\n        super(context);\r\n        const options = this._context.configuration.options;\r\n        this._readOnly = options.get(75 /* readOnly */);\r\n        this._cursorBlinking = options.get(19 /* cursorBlinking */);\r\n        this._cursorStyle = options.get(21 /* cursorStyle */);\r\n        this._cursorSmoothCaretAnimation = options.get(20 /* cursorSmoothCaretAnimation */);\r\n        this._selectionIsEmpty = true;\r\n        this._isComposingInput = false;\r\n        this._isVisible = false;\r\n        this._primaryCursor = new ViewCursor(this._context);\r\n        this._secondaryCursors = [];\r\n        this._renderData = [];\r\n        this._domNode = createFastDomNode(document.createElement('div'));\r\n        this._domNode.setAttribute('role', 'presentation');\r\n        this._domNode.setAttribute('aria-hidden', 'true');\r\n        this._updateDomClassName();\r\n        this._domNode.appendChild(this._primaryCursor.getDomNode());\r\n        this._startCursorBlinkAnimation = new TimeoutTimer();\r\n        this._cursorFlatBlinkInterval = new IntervalTimer();\r\n        this._blinkingEnabled = false;\r\n        this._editorHasFocus = false;\r\n        this._updateBlinking();\r\n    }\r\n    dispose() {\r\n        super.dispose();\r\n        this._startCursorBlinkAnimation.dispose();\r\n        this._cursorFlatBlinkInterval.dispose();\r\n    }\r\n    getDomNode() {\r\n        return this._domNode;\r\n    }\r\n    // --- begin event handlers\r\n    onCompositionStart(e) {\r\n        this._isComposingInput = true;\r\n        this._updateBlinking();\r\n        return true;\r\n    }\r\n    onCompositionEnd(e) {\r\n        this._isComposingInput = false;\r\n        this._updateBlinking();\r\n        return true;\r\n    }\r\n    onConfigurationChanged(e) {\r\n        const options = this._context.configuration.options;\r\n        this._readOnly = options.get(75 /* readOnly */);\r\n        this._cursorBlinking = options.get(19 /* cursorBlinking */);\r\n        this._cursorStyle = options.get(21 /* cursorStyle */);\r\n        this._cursorSmoothCaretAnimation = options.get(20 /* cursorSmoothCaretAnimation */);\r\n        this._updateBlinking();\r\n        this._updateDomClassName();\r\n        this._primaryCursor.onConfigurationChanged(e);\r\n        for (let i = 0, len = this._secondaryCursors.length; i < len; i++) {\r\n            this._secondaryCursors[i].onConfigurationChanged(e);\r\n        }\r\n        return true;\r\n    }\r\n    _onCursorPositionChanged(position, secondaryPositions) {\r\n        this._primaryCursor.onCursorPositionChanged(position);\r\n        this._updateBlinking();\r\n        if (this._secondaryCursors.length < secondaryPositions.length) {\r\n            // Create new cursors\r\n            const addCnt = secondaryPositions.length - this._secondaryCursors.length;\r\n            for (let i = 0; i < addCnt; i++) {\r\n                const newCursor = new ViewCursor(this._context);\r\n                this._domNode.domNode.insertBefore(newCursor.getDomNode().domNode, this._primaryCursor.getDomNode().domNode.nextSibling);\r\n                this._secondaryCursors.push(newCursor);\r\n            }\r\n        }\r\n        else if (this._secondaryCursors.length > secondaryPositions.length) {\r\n            // Remove some cursors\r\n            const removeCnt = this._secondaryCursors.length - secondaryPositions.length;\r\n            for (let i = 0; i < removeCnt; i++) {\r\n                this._domNode.removeChild(this._secondaryCursors[0].getDomNode());\r\n                this._secondaryCursors.splice(0, 1);\r\n            }\r\n        }\r\n        for (let i = 0; i < secondaryPositions.length; i++) {\r\n            this._secondaryCursors[i].onCursorPositionChanged(secondaryPositions[i]);\r\n        }\r\n    }\r\n    onCursorStateChanged(e) {\r\n        const positions = [];\r\n        for (let i = 0, len = e.selections.length; i < len; i++) {\r\n            positions[i] = e.selections[i].getPosition();\r\n        }\r\n        this._onCursorPositionChanged(positions[0], positions.slice(1));\r\n        const selectionIsEmpty = e.selections[0].isEmpty();\r\n        if (this._selectionIsEmpty !== selectionIsEmpty) {\r\n            this._selectionIsEmpty = selectionIsEmpty;\r\n            this._updateDomClassName();\r\n        }\r\n        return true;\r\n    }\r\n    onDecorationsChanged(e) {\r\n        // true for inline decorations that can end up relayouting text\r\n        return true;\r\n    }\r\n    onFlushed(e) {\r\n        return true;\r\n    }\r\n    onFocusChanged(e) {\r\n        this._editorHasFocus = e.isFocused;\r\n        this._updateBlinking();\r\n        return false;\r\n    }\r\n    onLinesChanged(e) {\r\n        return true;\r\n    }\r\n    onLinesDeleted(e) {\r\n        return true;\r\n    }\r\n    onLinesInserted(e) {\r\n        return true;\r\n    }\r\n    onScrollChanged(e) {\r\n        return true;\r\n    }\r\n    onTokensChanged(e) {\r\n        const shouldRender = (position) => {\r\n            for (let i = 0, len = e.ranges.length; i < len; i++) {\r\n                if (e.ranges[i].fromLineNumber <= position.lineNumber && position.lineNumber <= e.ranges[i].toLineNumber) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        };\r\n        if (shouldRender(this._primaryCursor.getPosition())) {\r\n            return true;\r\n        }\r\n        for (const secondaryCursor of this._secondaryCursors) {\r\n            if (shouldRender(secondaryCursor.getPosition())) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    onZonesChanged(e) {\r\n        return true;\r\n    }\r\n    // --- end event handlers\r\n    // ---- blinking logic\r\n    _getCursorBlinking() {\r\n        if (this._isComposingInput) {\r\n            // avoid double cursors\r\n            return 0 /* Hidden */;\r\n        }\r\n        if (!this._editorHasFocus) {\r\n            return 0 /* Hidden */;\r\n        }\r\n        if (this._readOnly) {\r\n            return 5 /* Solid */;\r\n        }\r\n        return this._cursorBlinking;\r\n    }\r\n    _updateBlinking() {\r\n        this._startCursorBlinkAnimation.cancel();\r\n        this._cursorFlatBlinkInterval.cancel();\r\n        const blinkingStyle = this._getCursorBlinking();\r\n        // hidden and solid are special as they involve no animations\r\n        const isHidden = (blinkingStyle === 0 /* Hidden */);\r\n        const isSolid = (blinkingStyle === 5 /* Solid */);\r\n        if (isHidden) {\r\n            this._hide();\r\n        }\r\n        else {\r\n            this._show();\r\n        }\r\n        this._blinkingEnabled = false;\r\n        this._updateDomClassName();\r\n        if (!isHidden && !isSolid) {\r\n            if (blinkingStyle === 1 /* Blink */) {\r\n                // flat blinking is handled by JavaScript to save battery life due to Chromium step timing issue https://bugs.chromium.org/p/chromium/issues/detail?id=361587\r\n                this._cursorFlatBlinkInterval.cancelAndSet(() => {\r\n                    if (this._isVisible) {\r\n                        this._hide();\r\n                    }\r\n                    else {\r\n                        this._show();\r\n                    }\r\n                }, ViewCursors.BLINK_INTERVAL);\r\n            }\r\n            else {\r\n                this._startCursorBlinkAnimation.setIfNotSet(() => {\r\n                    this._blinkingEnabled = true;\r\n                    this._updateDomClassName();\r\n                }, ViewCursors.BLINK_INTERVAL);\r\n            }\r\n        }\r\n    }\r\n    // --- end blinking logic\r\n    _updateDomClassName() {\r\n        this._domNode.setClassName(this._getClassName());\r\n    }\r\n    _getClassName() {\r\n        let result = 'cursors-layer';\r\n        if (!this._selectionIsEmpty) {\r\n            result += ' has-selection';\r\n        }\r\n        switch (this._cursorStyle) {\r\n            case TextEditorCursorStyle.Line:\r\n                result += ' cursor-line-style';\r\n                break;\r\n            case TextEditorCursorStyle.Block:\r\n                result += ' cursor-block-style';\r\n                break;\r\n            case TextEditorCursorStyle.Underline:\r\n                result += ' cursor-underline-style';\r\n                break;\r\n            case TextEditorCursorStyle.LineThin:\r\n                result += ' cursor-line-thin-style';\r\n                break;\r\n            case TextEditorCursorStyle.BlockOutline:\r\n                result += ' cursor-block-outline-style';\r\n                break;\r\n            case TextEditorCursorStyle.UnderlineThin:\r\n                result += ' cursor-underline-thin-style';\r\n                break;\r\n            default:\r\n                result += ' cursor-line-style';\r\n        }\r\n        if (this._blinkingEnabled) {\r\n            switch (this._getCursorBlinking()) {\r\n                case 1 /* Blink */:\r\n                    result += ' cursor-blink';\r\n                    break;\r\n                case 2 /* Smooth */:\r\n                    result += ' cursor-smooth';\r\n                    break;\r\n                case 3 /* Phase */:\r\n                    result += ' cursor-phase';\r\n                    break;\r\n                case 4 /* Expand */:\r\n                    result += ' cursor-expand';\r\n                    break;\r\n                case 5 /* Solid */:\r\n                    result += ' cursor-solid';\r\n                    break;\r\n                default:\r\n                    result += ' cursor-solid';\r\n            }\r\n        }\r\n        else {\r\n            result += ' cursor-solid';\r\n        }\r\n        if (this._cursorSmoothCaretAnimation) {\r\n            result += ' cursor-smooth-caret-animation';\r\n        }\r\n        return result;\r\n    }\r\n    _show() {\r\n        this._primaryCursor.show();\r\n        for (let i = 0, len = this._secondaryCursors.length; i < len; i++) {\r\n            this._secondaryCursors[i].show();\r\n        }\r\n        this._isVisible = true;\r\n    }\r\n    _hide() {\r\n        this._primaryCursor.hide();\r\n        for (let i = 0, len = this._secondaryCursors.length; i < len; i++) {\r\n            this._secondaryCursors[i].hide();\r\n        }\r\n        this._isVisible = false;\r\n    }\r\n    // ---- IViewPart implementation\r\n    prepareRender(ctx) {\r\n        this._primaryCursor.prepareRender(ctx);\r\n        for (let i = 0, len = this._secondaryCursors.length; i < len; i++) {\r\n            this._secondaryCursors[i].prepareRender(ctx);\r\n        }\r\n    }\r\n    render(ctx) {\r\n        let renderData = [], renderDataLen = 0;\r\n        const primaryRenderData = this._primaryCursor.render(ctx);\r\n        if (primaryRenderData) {\r\n            renderData[renderDataLen++] = primaryRenderData;\r\n        }\r\n        for (let i = 0, len = this._secondaryCursors.length; i < len; i++) {\r\n            const secondaryRenderData = this._secondaryCursors[i].render(ctx);\r\n            if (secondaryRenderData) {\r\n                renderData[renderDataLen++] = secondaryRenderData;\r\n            }\r\n        }\r\n        this._renderData = renderData;\r\n    }\r\n    getLastRenderData() {\r\n        return this._renderData;\r\n    }\r\n}\r\nViewCursors.BLINK_INTERVAL = 500;\r\nregisterThemingParticipant((theme, collector) => {\r\n    const caret = theme.getColor(editorCursorForeground);\r\n    if (caret) {\r\n        let caretBackground = theme.getColor(editorCursorBackground);\r\n        if (!caretBackground) {\r\n            caretBackground = caret.opposite();\r\n        }\r\n        collector.addRule(`.monaco-editor .cursors-layer .cursor { background-color: ${caret}; border-color: ${caret}; color: ${caretBackground}; }`);\r\n        if (theme.type === 'hc') {\r\n            collector.addRule(`.monaco-editor .cursors-layer.has-selection .cursor { border-left: 1px solid ${caretBackground}; border-right: 1px solid ${caretBackground}; }`);\r\n        }\r\n    }\r\n});\r\n"]},"metadata":{},"sourceType":"module"}