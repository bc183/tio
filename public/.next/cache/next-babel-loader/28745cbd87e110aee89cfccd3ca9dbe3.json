{"ast":null,"code":"import _get from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/get\";\nimport _inherits from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _classCallCheck from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/createClass\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nimport * as strings from '../../../base/common/strings.js';\nimport { Range } from '../../common/core/range.js';\nimport { CancellationTokenSource } from '../../../base/common/cancellation.js';\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\nimport { EditorKeybindingCancellationTokenSource } from './keybindingCancellation.js';\nexport var EditorState = /*#__PURE__*/function () {\n  function EditorState(editor, flags) {\n    _classCallCheck(this, EditorState);\n\n    this.flags = flags;\n\n    if ((this.flags & 1\n    /* Value */\n    ) !== 0) {\n      var model = editor.getModel();\n      this.modelVersionId = model ? strings.format('{0}#{1}', model.uri.toString(), model.getVersionId()) : null;\n    } else {\n      this.modelVersionId = null;\n    }\n\n    if ((this.flags & 4\n    /* Position */\n    ) !== 0) {\n      this.position = editor.getPosition();\n    } else {\n      this.position = null;\n    }\n\n    if ((this.flags & 2\n    /* Selection */\n    ) !== 0) {\n      this.selection = editor.getSelection();\n    } else {\n      this.selection = null;\n    }\n\n    if ((this.flags & 8\n    /* Scroll */\n    ) !== 0) {\n      this.scrollLeft = editor.getScrollLeft();\n      this.scrollTop = editor.getScrollTop();\n    } else {\n      this.scrollLeft = -1;\n      this.scrollTop = -1;\n    }\n  }\n\n  _createClass(EditorState, [{\n    key: \"_equals\",\n    value: function _equals(other) {\n      if (!(other instanceof EditorState)) {\n        return false;\n      }\n\n      var state = other;\n\n      if (this.modelVersionId !== state.modelVersionId) {\n        return false;\n      }\n\n      if (this.scrollLeft !== state.scrollLeft || this.scrollTop !== state.scrollTop) {\n        return false;\n      }\n\n      if (!this.position && state.position || this.position && !state.position || this.position && state.position && !this.position.equals(state.position)) {\n        return false;\n      }\n\n      if (!this.selection && state.selection || this.selection && !state.selection || this.selection && state.selection && !this.selection.equalsRange(state.selection)) {\n        return false;\n      }\n\n      return true;\n    }\n  }, {\n    key: \"validate\",\n    value: function validate(editor) {\n      return this._equals(new EditorState(editor, this.flags));\n    }\n  }]);\n\n  return EditorState;\n}();\n/**\r\n * A cancellation token source that cancels when the editor changes as expressed\r\n * by the provided flags\r\n * @param range If provided, changes in position and selection within this range will not trigger cancellation\r\n */\n\nexport var EditorStateCancellationTokenSource = /*#__PURE__*/function (_EditorKeybindingCanc) {\n  _inherits(EditorStateCancellationTokenSource, _EditorKeybindingCanc);\n\n  var _super = _createSuper(EditorStateCancellationTokenSource);\n\n  function EditorStateCancellationTokenSource(editor, flags, range, parent) {\n    var _this;\n\n    _classCallCheck(this, EditorStateCancellationTokenSource);\n\n    _this = _super.call(this, editor, parent);\n    _this.editor = editor;\n    _this._listener = new DisposableStore();\n\n    if (flags & 4\n    /* Position */\n    ) {\n        _this._listener.add(editor.onDidChangeCursorPosition(function (e) {\n          if (!range || !Range.containsPosition(range, e.position)) {\n            _this.cancel();\n          }\n        }));\n      }\n\n    if (flags & 2\n    /* Selection */\n    ) {\n        _this._listener.add(editor.onDidChangeCursorSelection(function (e) {\n          if (!range || !Range.containsRange(range, e.selection)) {\n            _this.cancel();\n          }\n        }));\n      }\n\n    if (flags & 8\n    /* Scroll */\n    ) {\n        _this._listener.add(editor.onDidScrollChange(function (_) {\n          return _this.cancel();\n        }));\n      }\n\n    if (flags & 1\n    /* Value */\n    ) {\n        _this._listener.add(editor.onDidChangeModel(function (_) {\n          return _this.cancel();\n        }));\n\n        _this._listener.add(editor.onDidChangeModelContent(function (_) {\n          return _this.cancel();\n        }));\n      }\n\n    return _this;\n  }\n\n  _createClass(EditorStateCancellationTokenSource, [{\n    key: \"dispose\",\n    value: function dispose() {\n      this._listener.dispose();\n\n      _get(_getPrototypeOf(EditorStateCancellationTokenSource.prototype), \"dispose\", this).call(this);\n    }\n  }]);\n\n  return EditorStateCancellationTokenSource;\n}(EditorKeybindingCancellationTokenSource);\n/**\r\n * A cancellation token source that cancels when the provided model changes\r\n */\n\nexport var TextModelCancellationTokenSource = /*#__PURE__*/function (_CancellationTokenSou) {\n  _inherits(TextModelCancellationTokenSource, _CancellationTokenSou);\n\n  var _super2 = _createSuper(TextModelCancellationTokenSource);\n\n  function TextModelCancellationTokenSource(model, parent) {\n    var _this2;\n\n    _classCallCheck(this, TextModelCancellationTokenSource);\n\n    _this2 = _super2.call(this, parent);\n    _this2._listener = model.onDidChangeContent(function () {\n      return _this2.cancel();\n    });\n    return _this2;\n  }\n\n  _createClass(TextModelCancellationTokenSource, [{\n    key: \"dispose\",\n    value: function dispose() {\n      this._listener.dispose();\n\n      _get(_getPrototypeOf(TextModelCancellationTokenSource.prototype), \"dispose\", this).call(this);\n    }\n  }]);\n\n  return TextModelCancellationTokenSource;\n}(CancellationTokenSource);\nexport var StableEditorScrollState = /*#__PURE__*/function () {\n  function StableEditorScrollState(_visiblePosition, _visiblePositionScrollDelta, _cursorPosition) {\n    _classCallCheck(this, StableEditorScrollState);\n\n    this._visiblePosition = _visiblePosition;\n    this._visiblePositionScrollDelta = _visiblePositionScrollDelta;\n    this._cursorPosition = _cursorPosition;\n  }\n\n  _createClass(StableEditorScrollState, [{\n    key: \"restore\",\n    value: function restore(editor) {\n      if (this._visiblePosition) {\n        var visiblePositionScrollTop = editor.getTopForPosition(this._visiblePosition.lineNumber, this._visiblePosition.column);\n        editor.setScrollTop(visiblePositionScrollTop + this._visiblePositionScrollDelta);\n      }\n    }\n  }, {\n    key: \"restoreRelativeVerticalPositionOfCursor\",\n    value: function restoreRelativeVerticalPositionOfCursor(editor) {\n      var currentCursorPosition = editor.getPosition();\n\n      if (!this._cursorPosition || !currentCursorPosition) {\n        return;\n      }\n\n      var offset = editor.getTopForLineNumber(currentCursorPosition.lineNumber) - editor.getTopForLineNumber(this._cursorPosition.lineNumber);\n      editor.setScrollTop(editor.getScrollTop() + offset);\n    }\n  }], [{\n    key: \"capture\",\n    value: function capture(editor) {\n      var visiblePosition = null;\n      var visiblePositionScrollDelta = 0;\n\n      if (editor.getScrollTop() !== 0) {\n        var visibleRanges = editor.getVisibleRanges();\n\n        if (visibleRanges.length > 0) {\n          visiblePosition = visibleRanges[0].getStartPosition();\n          var visiblePositionScrollTop = editor.getTopForPosition(visiblePosition.lineNumber, visiblePosition.column);\n          visiblePositionScrollDelta = editor.getScrollTop() - visiblePositionScrollTop;\n        }\n      }\n\n      return new StableEditorScrollState(visiblePosition, visiblePositionScrollDelta, editor.getPosition());\n    }\n  }]);\n\n  return StableEditorScrollState;\n}();","map":{"version":3,"sources":["/home/bar007/Desktop/projects/tio/client/node_modules/monaco-editor/esm/vs/editor/browser/core/editorState.js"],"names":["strings","Range","CancellationTokenSource","DisposableStore","EditorKeybindingCancellationTokenSource","EditorState","editor","flags","model","getModel","modelVersionId","format","uri","toString","getVersionId","position","getPosition","selection","getSelection","scrollLeft","getScrollLeft","scrollTop","getScrollTop","other","state","equals","equalsRange","_equals","EditorStateCancellationTokenSource","range","parent","_listener","add","onDidChangeCursorPosition","e","containsPosition","cancel","onDidChangeCursorSelection","containsRange","onDidScrollChange","_","onDidChangeModel","onDidChangeModelContent","dispose","TextModelCancellationTokenSource","onDidChangeContent","StableEditorScrollState","_visiblePosition","_visiblePositionScrollDelta","_cursorPosition","visiblePositionScrollTop","getTopForPosition","lineNumber","column","setScrollTop","currentCursorPosition","offset","getTopForLineNumber","visiblePosition","visiblePositionScrollDelta","visibleRanges","getVisibleRanges","length","getStartPosition"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { CancellationTokenSource } from '../../../base/common/cancellation.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { EditorKeybindingCancellationTokenSource } from './keybindingCancellation.js';\r\nexport class EditorState {\r\n    constructor(editor, flags) {\r\n        this.flags = flags;\r\n        if ((this.flags & 1 /* Value */) !== 0) {\r\n            const model = editor.getModel();\r\n            this.modelVersionId = model ? strings.format('{0}#{1}', model.uri.toString(), model.getVersionId()) : null;\r\n        }\r\n        else {\r\n            this.modelVersionId = null;\r\n        }\r\n        if ((this.flags & 4 /* Position */) !== 0) {\r\n            this.position = editor.getPosition();\r\n        }\r\n        else {\r\n            this.position = null;\r\n        }\r\n        if ((this.flags & 2 /* Selection */) !== 0) {\r\n            this.selection = editor.getSelection();\r\n        }\r\n        else {\r\n            this.selection = null;\r\n        }\r\n        if ((this.flags & 8 /* Scroll */) !== 0) {\r\n            this.scrollLeft = editor.getScrollLeft();\r\n            this.scrollTop = editor.getScrollTop();\r\n        }\r\n        else {\r\n            this.scrollLeft = -1;\r\n            this.scrollTop = -1;\r\n        }\r\n    }\r\n    _equals(other) {\r\n        if (!(other instanceof EditorState)) {\r\n            return false;\r\n        }\r\n        const state = other;\r\n        if (this.modelVersionId !== state.modelVersionId) {\r\n            return false;\r\n        }\r\n        if (this.scrollLeft !== state.scrollLeft || this.scrollTop !== state.scrollTop) {\r\n            return false;\r\n        }\r\n        if (!this.position && state.position || this.position && !state.position || this.position && state.position && !this.position.equals(state.position)) {\r\n            return false;\r\n        }\r\n        if (!this.selection && state.selection || this.selection && !state.selection || this.selection && state.selection && !this.selection.equalsRange(state.selection)) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    validate(editor) {\r\n        return this._equals(new EditorState(editor, this.flags));\r\n    }\r\n}\r\n/**\r\n * A cancellation token source that cancels when the editor changes as expressed\r\n * by the provided flags\r\n * @param range If provided, changes in position and selection within this range will not trigger cancellation\r\n */\r\nexport class EditorStateCancellationTokenSource extends EditorKeybindingCancellationTokenSource {\r\n    constructor(editor, flags, range, parent) {\r\n        super(editor, parent);\r\n        this.editor = editor;\r\n        this._listener = new DisposableStore();\r\n        if (flags & 4 /* Position */) {\r\n            this._listener.add(editor.onDidChangeCursorPosition(e => {\r\n                if (!range || !Range.containsPosition(range, e.position)) {\r\n                    this.cancel();\r\n                }\r\n            }));\r\n        }\r\n        if (flags & 2 /* Selection */) {\r\n            this._listener.add(editor.onDidChangeCursorSelection(e => {\r\n                if (!range || !Range.containsRange(range, e.selection)) {\r\n                    this.cancel();\r\n                }\r\n            }));\r\n        }\r\n        if (flags & 8 /* Scroll */) {\r\n            this._listener.add(editor.onDidScrollChange(_ => this.cancel()));\r\n        }\r\n        if (flags & 1 /* Value */) {\r\n            this._listener.add(editor.onDidChangeModel(_ => this.cancel()));\r\n            this._listener.add(editor.onDidChangeModelContent(_ => this.cancel()));\r\n        }\r\n    }\r\n    dispose() {\r\n        this._listener.dispose();\r\n        super.dispose();\r\n    }\r\n}\r\n/**\r\n * A cancellation token source that cancels when the provided model changes\r\n */\r\nexport class TextModelCancellationTokenSource extends CancellationTokenSource {\r\n    constructor(model, parent) {\r\n        super(parent);\r\n        this._listener = model.onDidChangeContent(() => this.cancel());\r\n    }\r\n    dispose() {\r\n        this._listener.dispose();\r\n        super.dispose();\r\n    }\r\n}\r\nexport class StableEditorScrollState {\r\n    constructor(_visiblePosition, _visiblePositionScrollDelta, _cursorPosition) {\r\n        this._visiblePosition = _visiblePosition;\r\n        this._visiblePositionScrollDelta = _visiblePositionScrollDelta;\r\n        this._cursorPosition = _cursorPosition;\r\n    }\r\n    static capture(editor) {\r\n        let visiblePosition = null;\r\n        let visiblePositionScrollDelta = 0;\r\n        if (editor.getScrollTop() !== 0) {\r\n            const visibleRanges = editor.getVisibleRanges();\r\n            if (visibleRanges.length > 0) {\r\n                visiblePosition = visibleRanges[0].getStartPosition();\r\n                const visiblePositionScrollTop = editor.getTopForPosition(visiblePosition.lineNumber, visiblePosition.column);\r\n                visiblePositionScrollDelta = editor.getScrollTop() - visiblePositionScrollTop;\r\n            }\r\n        }\r\n        return new StableEditorScrollState(visiblePosition, visiblePositionScrollDelta, editor.getPosition());\r\n    }\r\n    restore(editor) {\r\n        if (this._visiblePosition) {\r\n            const visiblePositionScrollTop = editor.getTopForPosition(this._visiblePosition.lineNumber, this._visiblePosition.column);\r\n            editor.setScrollTop(visiblePositionScrollTop + this._visiblePositionScrollDelta);\r\n        }\r\n    }\r\n    restoreRelativeVerticalPositionOfCursor(editor) {\r\n        const currentCursorPosition = editor.getPosition();\r\n        if (!this._cursorPosition || !currentCursorPosition) {\r\n            return;\r\n        }\r\n        const offset = editor.getTopForLineNumber(currentCursorPosition.lineNumber) - editor.getTopForLineNumber(this._cursorPosition.lineNumber);\r\n        editor.setScrollTop(editor.getScrollTop() + offset);\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}