{"ast":null,"code":"import _slicedToArray from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _assertThisInitialized from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _get from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/get\";\nimport _inherits from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _classCallCheck from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/createClass\";\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) {\n    if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  }\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n\nimport './media/editor.css';\nimport * as nls from '../../../nls.js';\nimport * as dom from '../../../base/browser/dom.js';\nimport { onUnexpectedError } from '../../../base/common/errors.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { Disposable, dispose as _dispose } from '../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../base/common/network.js';\nimport { Configuration } from '../config/configuration.js';\nimport { EditorExtensionsRegistry } from '../editorExtensions.js';\nimport { ICodeEditorService } from '../services/codeEditorService.js';\nimport { View } from '../view/viewImpl.js';\nimport { ViewUserInputEvents } from '../view/viewUserInputEvents.js';\nimport { filterValidationDecorations } from '../../common/config/editorOptions.js';\nimport { Cursor } from '../../common/controller/cursor.js';\nimport { CursorColumns } from '../../common/controller/cursorCommon.js';\nimport { Position } from '../../common/core/position.js';\nimport { Range } from '../../common/core/range.js';\nimport { Selection } from '../../common/core/selection.js';\nimport { InternalEditorAction } from '../../common/editorAction.js';\nimport * as editorCommon from '../../common/editorCommon.js';\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\nimport * as modes from '../../common/modes.js';\nimport { editorUnnecessaryCodeBorder, editorUnnecessaryCodeOpacity } from '../../common/view/editorColorRegistry.js';\nimport { editorErrorBorder, editorErrorForeground, editorHintBorder, editorHintForeground, editorInfoBorder, editorInfoForeground, editorWarningBorder, editorWarningForeground, editorForeground, editorErrorBackground, editorInfoBackground, editorWarningBackground } from '../../../platform/theme/common/colorRegistry.js';\nimport { ViewModel } from '../../common/viewModel/viewModelImpl.js';\nimport { ICommandService } from '../../../platform/commands/common/commands.js';\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\nimport { ServiceCollection } from '../../../platform/instantiation/common/serviceCollection.js';\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\nimport { IThemeService, registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\nimport { IAccessibilityService } from '../../../platform/accessibility/common/accessibility.js';\nimport { withNullAsUndefined } from '../../../base/common/types.js';\nimport { MonospaceLineBreaksComputerFactory } from '../../common/viewModel/monospaceLineBreaksComputer.js';\nimport { DOMLineBreaksComputerFactory } from '../view/domLineBreaksComputer.js';\nimport { WordOperations } from '../../common/controller/cursorWordOperations.js';\nvar EDITOR_ID = 0;\n\nvar ModelData = /*#__PURE__*/function () {\n  function ModelData(model, viewModel, view, hasRealView, listenersToRemove) {\n    _classCallCheck(this, ModelData);\n\n    this.model = model;\n    this.viewModel = viewModel;\n    this.view = view;\n    this.hasRealView = hasRealView;\n    this.listenersToRemove = listenersToRemove;\n  }\n\n  _createClass(ModelData, [{\n    key: \"dispose\",\n    value: function dispose() {\n      _dispose(this.listenersToRemove);\n\n      this.model.onBeforeDetached();\n\n      if (this.hasRealView) {\n        this.view.dispose();\n      }\n\n      this.viewModel.dispose();\n    }\n  }]);\n\n  return ModelData;\n}();\n\nvar CodeEditorWidget = /*#__PURE__*/function (_Disposable) {\n  _inherits(CodeEditorWidget, _Disposable);\n\n  var _super = _createSuper(CodeEditorWidget);\n\n  function CodeEditorWidget(domElement, _options, codeEditorWidgetOptions, instantiationService, codeEditorService, commandService, contextKeyService, themeService, notificationService, accessibilityService) {\n    var _this;\n\n    _classCallCheck(this, CodeEditorWidget);\n\n    _this = _super.call(this); //#region Eventing\n\n    _this._onDidDispose = _this._register(new Emitter());\n    _this.onDidDispose = _this._onDidDispose.event;\n    _this._onDidChangeModelContent = _this._register(new Emitter());\n    _this.onDidChangeModelContent = _this._onDidChangeModelContent.event;\n    _this._onDidChangeModelLanguage = _this._register(new Emitter());\n    _this.onDidChangeModelLanguage = _this._onDidChangeModelLanguage.event;\n    _this._onDidChangeModelLanguageConfiguration = _this._register(new Emitter());\n    _this.onDidChangeModelLanguageConfiguration = _this._onDidChangeModelLanguageConfiguration.event;\n    _this._onDidChangeModelOptions = _this._register(new Emitter());\n    _this.onDidChangeModelOptions = _this._onDidChangeModelOptions.event;\n    _this._onDidChangeModelDecorations = _this._register(new Emitter());\n    _this.onDidChangeModelDecorations = _this._onDidChangeModelDecorations.event;\n    _this._onDidChangeConfiguration = _this._register(new Emitter());\n    _this.onDidChangeConfiguration = _this._onDidChangeConfiguration.event;\n    _this._onDidChangeModel = _this._register(new Emitter());\n    _this.onDidChangeModel = _this._onDidChangeModel.event;\n    _this._onDidChangeCursorPosition = _this._register(new Emitter());\n    _this.onDidChangeCursorPosition = _this._onDidChangeCursorPosition.event;\n    _this._onDidChangeCursorSelection = _this._register(new Emitter());\n    _this.onDidChangeCursorSelection = _this._onDidChangeCursorSelection.event;\n    _this._onDidAttemptReadOnlyEdit = _this._register(new Emitter());\n    _this.onDidAttemptReadOnlyEdit = _this._onDidAttemptReadOnlyEdit.event;\n    _this._onDidLayoutChange = _this._register(new Emitter());\n    _this.onDidLayoutChange = _this._onDidLayoutChange.event;\n    _this._editorTextFocus = _this._register(new BooleanEventEmitter());\n    _this.onDidFocusEditorText = _this._editorTextFocus.onDidChangeToTrue;\n    _this.onDidBlurEditorText = _this._editorTextFocus.onDidChangeToFalse;\n    _this._editorWidgetFocus = _this._register(new BooleanEventEmitter());\n    _this.onDidFocusEditorWidget = _this._editorWidgetFocus.onDidChangeToTrue;\n    _this.onDidBlurEditorWidget = _this._editorWidgetFocus.onDidChangeToFalse;\n    _this._onWillType = _this._register(new Emitter());\n    _this.onWillType = _this._onWillType.event;\n    _this._onDidType = _this._register(new Emitter());\n    _this.onDidType = _this._onDidType.event;\n    _this._onDidCompositionStart = _this._register(new Emitter());\n    _this.onDidCompositionStart = _this._onDidCompositionStart.event;\n    _this._onDidCompositionEnd = _this._register(new Emitter());\n    _this.onDidCompositionEnd = _this._onDidCompositionEnd.event;\n    _this._onDidPaste = _this._register(new Emitter());\n    _this.onDidPaste = _this._onDidPaste.event;\n    _this._onMouseUp = _this._register(new Emitter());\n    _this.onMouseUp = _this._onMouseUp.event;\n    _this._onMouseDown = _this._register(new Emitter());\n    _this.onMouseDown = _this._onMouseDown.event;\n    _this._onMouseDrag = _this._register(new Emitter());\n    _this.onMouseDrag = _this._onMouseDrag.event;\n    _this._onMouseDrop = _this._register(new Emitter());\n    _this.onMouseDrop = _this._onMouseDrop.event;\n    _this._onMouseDropCanceled = _this._register(new Emitter());\n    _this.onMouseDropCanceled = _this._onMouseDropCanceled.event;\n    _this._onContextMenu = _this._register(new Emitter());\n    _this.onContextMenu = _this._onContextMenu.event;\n    _this._onMouseMove = _this._register(new Emitter());\n    _this.onMouseMove = _this._onMouseMove.event;\n    _this._onMouseLeave = _this._register(new Emitter());\n    _this.onMouseLeave = _this._onMouseLeave.event;\n    _this._onMouseWheel = _this._register(new Emitter());\n    _this.onMouseWheel = _this._onMouseWheel.event;\n    _this._onKeyUp = _this._register(new Emitter());\n    _this.onKeyUp = _this._onKeyUp.event;\n    _this._onKeyDown = _this._register(new Emitter());\n    _this.onKeyDown = _this._onKeyDown.event;\n    _this._onDidContentSizeChange = _this._register(new Emitter());\n    _this.onDidContentSizeChange = _this._onDidContentSizeChange.event;\n    _this._onDidScrollChange = _this._register(new Emitter());\n    _this.onDidScrollChange = _this._onDidScrollChange.event;\n    _this._onDidChangeViewZones = _this._register(new Emitter());\n    _this.onDidChangeViewZones = _this._onDidChangeViewZones.event;\n    var options = Object.assign({}, _options);\n    _this._domElement = domElement;\n    _this._overflowWidgetsDomNode = options.overflowWidgetsDomNode;\n    delete options.overflowWidgetsDomNode;\n    _this._id = ++EDITOR_ID;\n    _this._decorationTypeKeysToIds = {};\n    _this._decorationTypeSubtypes = {};\n    _this.isSimpleWidget = codeEditorWidgetOptions.isSimpleWidget || false;\n    _this._telemetryData = codeEditorWidgetOptions.telemetryData;\n    _this._configuration = _this._register(_this._createConfiguration(options, accessibilityService));\n\n    _this._register(_this._configuration.onDidChange(function (e) {\n      _this._onDidChangeConfiguration.fire(e);\n\n      var options = _this._configuration.options;\n\n      if (e.hasChanged(124\n      /* layoutInfo */\n      )) {\n        var layoutInfo = options.get(124\n        /* layoutInfo */\n        );\n\n        _this._onDidLayoutChange.fire(layoutInfo);\n      }\n    }));\n\n    _this._contextKeyService = _this._register(contextKeyService.createScoped(_this._domElement));\n    _this._notificationService = notificationService;\n    _this._codeEditorService = codeEditorService;\n    _this._commandService = commandService;\n    _this._themeService = themeService;\n\n    _this._register(new EditorContextKeysManager(_assertThisInitialized(_this), _this._contextKeyService));\n\n    _this._register(new EditorModeContext(_assertThisInitialized(_this), _this._contextKeyService));\n\n    _this._instantiationService = instantiationService.createChild(new ServiceCollection([IContextKeyService, _this._contextKeyService]));\n    _this._modelData = null;\n    _this._contributions = {};\n    _this._actions = {};\n    _this._focusTracker = new CodeEditorWidgetFocusTracker(domElement);\n\n    _this._focusTracker.onChange(function () {\n      _this._editorWidgetFocus.setValue(_this._focusTracker.hasFocus());\n    });\n\n    _this._contentWidgets = {};\n    _this._overlayWidgets = {};\n    var contributions;\n\n    if (Array.isArray(codeEditorWidgetOptions.contributions)) {\n      contributions = codeEditorWidgetOptions.contributions;\n    } else {\n      contributions = EditorExtensionsRegistry.getEditorContributions();\n    }\n\n    var _iterator = _createForOfIteratorHelper(contributions),\n        _step;\n\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var desc = _step.value;\n\n        try {\n          var contribution = _this._instantiationService.createInstance(desc.ctor, _assertThisInitialized(_this));\n\n          _this._contributions[desc.id] = contribution;\n        } catch (err) {\n          onUnexpectedError(err);\n        }\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n\n    EditorExtensionsRegistry.getEditorActions().forEach(function (action) {\n      var internalAction = new InternalEditorAction(action.id, action.label, action.alias, withNullAsUndefined(action.precondition), function () {\n        return _this._instantiationService.invokeFunction(function (accessor) {\n          return Promise.resolve(action.runEditorCommand(accessor, _assertThisInitialized(_this), null));\n        });\n      }, _this._contextKeyService);\n      _this._actions[internalAction.id] = internalAction;\n    });\n\n    _this._codeEditorService.addCodeEditor(_assertThisInitialized(_this));\n\n    return _this;\n  }\n\n  _createClass(CodeEditorWidget, [{\n    key: \"_createConfiguration\",\n    value: function _createConfiguration(options, accessibilityService) {\n      return new Configuration(this.isSimpleWidget, options, this._domElement, accessibilityService);\n    }\n  }, {\n    key: \"getId\",\n    value: function getId() {\n      return this.getEditorType() + ':' + this._id;\n    }\n  }, {\n    key: \"getEditorType\",\n    value: function getEditorType() {\n      return editorCommon.EditorType.ICodeEditor;\n    }\n  }, {\n    key: \"dispose\",\n    value: function dispose() {\n      this._codeEditorService.removeCodeEditor(this);\n\n      this._focusTracker.dispose();\n\n      var keys = Object.keys(this._contributions);\n\n      for (var i = 0, len = keys.length; i < len; i++) {\n        var contributionId = keys[i];\n\n        this._contributions[contributionId].dispose();\n      }\n\n      this._removeDecorationTypes();\n\n      this._postDetachModelCleanup(this._detachModel());\n\n      this._onDidDispose.fire();\n\n      _get(_getPrototypeOf(CodeEditorWidget.prototype), \"dispose\", this).call(this);\n    }\n  }, {\n    key: \"invokeWithinContext\",\n    value: function invokeWithinContext(fn) {\n      return this._instantiationService.invokeFunction(fn);\n    }\n  }, {\n    key: \"updateOptions\",\n    value: function updateOptions(newOptions) {\n      this._configuration.updateOptions(newOptions);\n    }\n  }, {\n    key: \"getOptions\",\n    value: function getOptions() {\n      return this._configuration.options;\n    }\n  }, {\n    key: \"getOption\",\n    value: function getOption(id) {\n      return this._configuration.options.get(id);\n    }\n  }, {\n    key: \"getRawOptions\",\n    value: function getRawOptions() {\n      return this._configuration.getRawOptions();\n    }\n  }, {\n    key: \"getOverflowWidgetsDomNode\",\n    value: function getOverflowWidgetsDomNode() {\n      return this._overflowWidgetsDomNode;\n    }\n  }, {\n    key: \"getConfiguredWordAtPosition\",\n    value: function getConfiguredWordAtPosition(position) {\n      if (!this._modelData) {\n        return null;\n      }\n\n      return WordOperations.getWordAtPosition(this._modelData.model, this._configuration.options.get(110\n      /* wordSeparators */\n      ), position);\n    }\n  }, {\n    key: \"getValue\",\n    value: function getValue() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n\n      if (!this._modelData) {\n        return '';\n      }\n\n      var preserveBOM = options && options.preserveBOM ? true : false;\n      var eolPreference = 0\n      /* TextDefined */\n      ;\n\n      if (options && options.lineEnding && options.lineEnding === '\\n') {\n        eolPreference = 1\n        /* LF */\n        ;\n      } else if (options && options.lineEnding && options.lineEnding === '\\r\\n') {\n        eolPreference = 2\n        /* CRLF */\n        ;\n      }\n\n      return this._modelData.model.getValue(eolPreference, preserveBOM);\n    }\n  }, {\n    key: \"setValue\",\n    value: function setValue(newValue) {\n      if (!this._modelData) {\n        return;\n      }\n\n      this._modelData.model.setValue(newValue);\n    }\n  }, {\n    key: \"getModel\",\n    value: function getModel() {\n      if (!this._modelData) {\n        return null;\n      }\n\n      return this._modelData.model;\n    }\n  }, {\n    key: \"setModel\",\n    value: function setModel() {\n      var _model = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n\n      var model = _model;\n\n      if (this._modelData === null && model === null) {\n        // Current model is the new model\n        return;\n      }\n\n      if (this._modelData && this._modelData.model === model) {\n        // Current model is the new model\n        return;\n      }\n\n      var hasTextFocus = this.hasTextFocus();\n\n      var detachedModel = this._detachModel();\n\n      this._attachModel(model);\n\n      if (hasTextFocus && this.hasModel()) {\n        this.focus();\n      }\n\n      var e = {\n        oldModelUrl: detachedModel ? detachedModel.uri : null,\n        newModelUrl: model ? model.uri : null\n      };\n\n      this._removeDecorationTypes();\n\n      this._onDidChangeModel.fire(e);\n\n      this._postDetachModelCleanup(detachedModel);\n    }\n  }, {\n    key: \"_removeDecorationTypes\",\n    value: function _removeDecorationTypes() {\n      this._decorationTypeKeysToIds = {};\n\n      if (this._decorationTypeSubtypes) {\n        for (var decorationType in this._decorationTypeSubtypes) {\n          var subTypes = this._decorationTypeSubtypes[decorationType];\n\n          for (var subType in subTypes) {\n            this._removeDecorationType(decorationType + '-' + subType);\n          }\n        }\n\n        this._decorationTypeSubtypes = {};\n      }\n    }\n  }, {\n    key: \"getVisibleRanges\",\n    value: function getVisibleRanges() {\n      if (!this._modelData) {\n        return [];\n      }\n\n      return this._modelData.viewModel.getVisibleRanges();\n    }\n  }, {\n    key: \"getVisibleRangesPlusViewportAboveBelow\",\n    value: function getVisibleRangesPlusViewportAboveBelow() {\n      if (!this._modelData) {\n        return [];\n      }\n\n      return this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow();\n    }\n  }, {\n    key: \"getWhitespaces\",\n    value: function getWhitespaces() {\n      if (!this._modelData) {\n        return [];\n      }\n\n      return this._modelData.viewModel.viewLayout.getWhitespaces();\n    }\n  }, {\n    key: \"getTopForLineNumber\",\n    value: function getTopForLineNumber(lineNumber) {\n      if (!this._modelData) {\n        return -1;\n      }\n\n      return CodeEditorWidget._getVerticalOffsetForPosition(this._modelData, lineNumber, 1);\n    }\n  }, {\n    key: \"getTopForPosition\",\n    value: function getTopForPosition(lineNumber, column) {\n      if (!this._modelData) {\n        return -1;\n      }\n\n      return CodeEditorWidget._getVerticalOffsetForPosition(this._modelData, lineNumber, column);\n    }\n  }, {\n    key: \"setHiddenAreas\",\n    value: function setHiddenAreas(ranges) {\n      if (this._modelData) {\n        this._modelData.viewModel.setHiddenAreas(ranges.map(function (r) {\n          return Range.lift(r);\n        }));\n      }\n    }\n  }, {\n    key: \"getVisibleColumnFromPosition\",\n    value: function getVisibleColumnFromPosition(rawPosition) {\n      if (!this._modelData) {\n        return rawPosition.column;\n      }\n\n      var position = this._modelData.model.validatePosition(rawPosition);\n\n      var tabSize = this._modelData.model.getOptions().tabSize;\n\n      return CursorColumns.visibleColumnFromColumn(this._modelData.model.getLineContent(position.lineNumber), position.column, tabSize) + 1;\n    }\n  }, {\n    key: \"getPosition\",\n    value: function getPosition() {\n      if (!this._modelData) {\n        return null;\n      }\n\n      return this._modelData.viewModel.getPosition();\n    }\n  }, {\n    key: \"setPosition\",\n    value: function setPosition(position) {\n      if (!this._modelData) {\n        return;\n      }\n\n      if (!Position.isIPosition(position)) {\n        throw new Error('Invalid arguments');\n      }\n\n      this._modelData.viewModel.setSelections('api', [{\n        selectionStartLineNumber: position.lineNumber,\n        selectionStartColumn: position.column,\n        positionLineNumber: position.lineNumber,\n        positionColumn: position.column\n      }]);\n    }\n  }, {\n    key: \"_sendRevealRange\",\n    value: function _sendRevealRange(modelRange, verticalType, revealHorizontal, scrollType) {\n      if (!this._modelData) {\n        return;\n      }\n\n      if (!Range.isIRange(modelRange)) {\n        throw new Error('Invalid arguments');\n      }\n\n      var validatedModelRange = this._modelData.model.validateRange(modelRange);\n\n      var viewRange = this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(validatedModelRange);\n\n      this._modelData.viewModel.revealRange('api', revealHorizontal, viewRange, verticalType, scrollType);\n    }\n  }, {\n    key: \"revealLine\",\n    value: function revealLine(lineNumber)\n    /* Smooth */\n    {\n      var scrollType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      this._revealLine(lineNumber, 0\n      /* Simple */\n      , scrollType);\n    }\n  }, {\n    key: \"revealLineInCenter\",\n    value: function revealLineInCenter(lineNumber)\n    /* Smooth */\n    {\n      var scrollType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      this._revealLine(lineNumber, 1\n      /* Center */\n      , scrollType);\n    }\n  }, {\n    key: \"revealLineInCenterIfOutsideViewport\",\n    value: function revealLineInCenterIfOutsideViewport(lineNumber)\n    /* Smooth */\n    {\n      var scrollType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      this._revealLine(lineNumber, 2\n      /* CenterIfOutsideViewport */\n      , scrollType);\n    }\n  }, {\n    key: \"revealLineNearTop\",\n    value: function revealLineNearTop(lineNumber)\n    /* Smooth */\n    {\n      var scrollType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      this._revealLine(lineNumber, 5\n      /* NearTop */\n      , scrollType);\n    }\n  }, {\n    key: \"_revealLine\",\n    value: function _revealLine(lineNumber, revealType, scrollType) {\n      if (typeof lineNumber !== 'number') {\n        throw new Error('Invalid arguments');\n      }\n\n      this._sendRevealRange(new Range(lineNumber, 1, lineNumber, 1), revealType, false, scrollType);\n    }\n  }, {\n    key: \"revealPosition\",\n    value: function revealPosition(position)\n    /* Smooth */\n    {\n      var scrollType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      this._revealPosition(position, 0\n      /* Simple */\n      , true, scrollType);\n    }\n  }, {\n    key: \"revealPositionInCenter\",\n    value: function revealPositionInCenter(position)\n    /* Smooth */\n    {\n      var scrollType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      this._revealPosition(position, 1\n      /* Center */\n      , true, scrollType);\n    }\n  }, {\n    key: \"revealPositionInCenterIfOutsideViewport\",\n    value: function revealPositionInCenterIfOutsideViewport(position)\n    /* Smooth */\n    {\n      var scrollType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      this._revealPosition(position, 2\n      /* CenterIfOutsideViewport */\n      , true, scrollType);\n    }\n  }, {\n    key: \"revealPositionNearTop\",\n    value: function revealPositionNearTop(position)\n    /* Smooth */\n    {\n      var scrollType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      this._revealPosition(position, 5\n      /* NearTop */\n      , true, scrollType);\n    }\n  }, {\n    key: \"_revealPosition\",\n    value: function _revealPosition(position, verticalType, revealHorizontal, scrollType) {\n      if (!Position.isIPosition(position)) {\n        throw new Error('Invalid arguments');\n      }\n\n      this._sendRevealRange(new Range(position.lineNumber, position.column, position.lineNumber, position.column), verticalType, revealHorizontal, scrollType);\n    }\n  }, {\n    key: \"getSelection\",\n    value: function getSelection() {\n      if (!this._modelData) {\n        return null;\n      }\n\n      return this._modelData.viewModel.getSelection();\n    }\n  }, {\n    key: \"getSelections\",\n    value: function getSelections() {\n      if (!this._modelData) {\n        return null;\n      }\n\n      return this._modelData.viewModel.getSelections();\n    }\n  }, {\n    key: \"setSelection\",\n    value: function setSelection(something) {\n      var isSelection = Selection.isISelection(something);\n      var isRange = Range.isIRange(something);\n\n      if (!isSelection && !isRange) {\n        throw new Error('Invalid arguments');\n      }\n\n      if (isSelection) {\n        this._setSelectionImpl(something);\n      } else if (isRange) {\n        // act as if it was an IRange\n        var selection = {\n          selectionStartLineNumber: something.startLineNumber,\n          selectionStartColumn: something.startColumn,\n          positionLineNumber: something.endLineNumber,\n          positionColumn: something.endColumn\n        };\n\n        this._setSelectionImpl(selection);\n      }\n    }\n  }, {\n    key: \"_setSelectionImpl\",\n    value: function _setSelectionImpl(sel) {\n      if (!this._modelData) {\n        return;\n      }\n\n      var selection = new Selection(sel.selectionStartLineNumber, sel.selectionStartColumn, sel.positionLineNumber, sel.positionColumn);\n\n      this._modelData.viewModel.setSelections('api', [selection]);\n    }\n  }, {\n    key: \"revealLines\",\n    value: function revealLines(startLineNumber, endLineNumber)\n    /* Smooth */\n    {\n      var scrollType = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n\n      this._revealLines(startLineNumber, endLineNumber, 0\n      /* Simple */\n      , scrollType);\n    }\n  }, {\n    key: \"revealLinesInCenter\",\n    value: function revealLinesInCenter(startLineNumber, endLineNumber)\n    /* Smooth */\n    {\n      var scrollType = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n\n      this._revealLines(startLineNumber, endLineNumber, 1\n      /* Center */\n      , scrollType);\n    }\n  }, {\n    key: \"revealLinesInCenterIfOutsideViewport\",\n    value: function revealLinesInCenterIfOutsideViewport(startLineNumber, endLineNumber)\n    /* Smooth */\n    {\n      var scrollType = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n\n      this._revealLines(startLineNumber, endLineNumber, 2\n      /* CenterIfOutsideViewport */\n      , scrollType);\n    }\n  }, {\n    key: \"revealLinesNearTop\",\n    value: function revealLinesNearTop(startLineNumber, endLineNumber)\n    /* Smooth */\n    {\n      var scrollType = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n\n      this._revealLines(startLineNumber, endLineNumber, 5\n      /* NearTop */\n      , scrollType);\n    }\n  }, {\n    key: \"_revealLines\",\n    value: function _revealLines(startLineNumber, endLineNumber, verticalType, scrollType) {\n      if (typeof startLineNumber !== 'number' || typeof endLineNumber !== 'number') {\n        throw new Error('Invalid arguments');\n      }\n\n      this._sendRevealRange(new Range(startLineNumber, 1, endLineNumber, 1), verticalType, false, scrollType);\n    }\n  }, {\n    key: \"revealRange\",\n    value: function revealRange(range) {\n      var scrollType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      var revealVerticalInCenter = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var revealHorizontal = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;\n\n      this._revealRange(range, revealVerticalInCenter ? 1\n      /* Center */\n      : 0\n      /* Simple */\n      , revealHorizontal, scrollType);\n    }\n  }, {\n    key: \"revealRangeInCenter\",\n    value: function revealRangeInCenter(range)\n    /* Smooth */\n    {\n      var scrollType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      this._revealRange(range, 1\n      /* Center */\n      , true, scrollType);\n    }\n  }, {\n    key: \"revealRangeInCenterIfOutsideViewport\",\n    value: function revealRangeInCenterIfOutsideViewport(range)\n    /* Smooth */\n    {\n      var scrollType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      this._revealRange(range, 2\n      /* CenterIfOutsideViewport */\n      , true, scrollType);\n    }\n  }, {\n    key: \"revealRangeNearTop\",\n    value: function revealRangeNearTop(range)\n    /* Smooth */\n    {\n      var scrollType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      this._revealRange(range, 5\n      /* NearTop */\n      , true, scrollType);\n    }\n  }, {\n    key: \"revealRangeNearTopIfOutsideViewport\",\n    value: function revealRangeNearTopIfOutsideViewport(range)\n    /* Smooth */\n    {\n      var scrollType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      this._revealRange(range, 6\n      /* NearTopIfOutsideViewport */\n      , true, scrollType);\n    }\n  }, {\n    key: \"revealRangeAtTop\",\n    value: function revealRangeAtTop(range)\n    /* Smooth */\n    {\n      var scrollType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      this._revealRange(range, 3\n      /* Top */\n      , true, scrollType);\n    }\n  }, {\n    key: \"_revealRange\",\n    value: function _revealRange(range, verticalType, revealHorizontal, scrollType) {\n      if (!Range.isIRange(range)) {\n        throw new Error('Invalid arguments');\n      }\n\n      this._sendRevealRange(Range.lift(range), verticalType, revealHorizontal, scrollType);\n    }\n  }, {\n    key: \"setSelections\",\n    value: function setSelections(ranges)\n    /* NotSet */\n    {\n      var source = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'api';\n      var reason = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n\n      if (!this._modelData) {\n        return;\n      }\n\n      if (!ranges || ranges.length === 0) {\n        throw new Error('Invalid arguments');\n      }\n\n      for (var i = 0, len = ranges.length; i < len; i++) {\n        if (!Selection.isISelection(ranges[i])) {\n          throw new Error('Invalid arguments');\n        }\n      }\n\n      this._modelData.viewModel.setSelections(source, ranges, reason);\n    }\n  }, {\n    key: \"getContentWidth\",\n    value: function getContentWidth() {\n      if (!this._modelData) {\n        return -1;\n      }\n\n      return this._modelData.viewModel.viewLayout.getContentWidth();\n    }\n  }, {\n    key: \"getScrollWidth\",\n    value: function getScrollWidth() {\n      if (!this._modelData) {\n        return -1;\n      }\n\n      return this._modelData.viewModel.viewLayout.getScrollWidth();\n    }\n  }, {\n    key: \"getScrollLeft\",\n    value: function getScrollLeft() {\n      if (!this._modelData) {\n        return -1;\n      }\n\n      return this._modelData.viewModel.viewLayout.getCurrentScrollLeft();\n    }\n  }, {\n    key: \"getContentHeight\",\n    value: function getContentHeight() {\n      if (!this._modelData) {\n        return -1;\n      }\n\n      return this._modelData.viewModel.viewLayout.getContentHeight();\n    }\n  }, {\n    key: \"getScrollHeight\",\n    value: function getScrollHeight() {\n      if (!this._modelData) {\n        return -1;\n      }\n\n      return this._modelData.viewModel.viewLayout.getScrollHeight();\n    }\n  }, {\n    key: \"getScrollTop\",\n    value: function getScrollTop() {\n      if (!this._modelData) {\n        return -1;\n      }\n\n      return this._modelData.viewModel.viewLayout.getCurrentScrollTop();\n    }\n  }, {\n    key: \"setScrollLeft\",\n    value: function setScrollLeft(newScrollLeft)\n    /* Immediate */\n    {\n      var scrollType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n\n      if (!this._modelData) {\n        return;\n      }\n\n      if (typeof newScrollLeft !== 'number') {\n        throw new Error('Invalid arguments');\n      }\n\n      this._modelData.viewModel.setScrollPosition({\n        scrollLeft: newScrollLeft\n      }, scrollType);\n    }\n  }, {\n    key: \"setScrollTop\",\n    value: function setScrollTop(newScrollTop)\n    /* Immediate */\n    {\n      var scrollType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n\n      if (!this._modelData) {\n        return;\n      }\n\n      if (typeof newScrollTop !== 'number') {\n        throw new Error('Invalid arguments');\n      }\n\n      this._modelData.viewModel.setScrollPosition({\n        scrollTop: newScrollTop\n      }, scrollType);\n    }\n  }, {\n    key: \"setScrollPosition\",\n    value: function setScrollPosition(position)\n    /* Immediate */\n    {\n      var scrollType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n\n      if (!this._modelData) {\n        return;\n      }\n\n      this._modelData.viewModel.setScrollPosition(position, scrollType);\n    }\n  }, {\n    key: \"saveViewState\",\n    value: function saveViewState() {\n      if (!this._modelData) {\n        return null;\n      }\n\n      var contributionsState = {};\n      var keys = Object.keys(this._contributions);\n\n      for (var _i = 0, _keys = keys; _i < _keys.length; _i++) {\n        var id = _keys[_i];\n        var contribution = this._contributions[id];\n\n        if (typeof contribution.saveViewState === 'function') {\n          contributionsState[id] = contribution.saveViewState();\n        }\n      }\n\n      var cursorState = this._modelData.viewModel.saveCursorState();\n\n      var viewState = this._modelData.viewModel.saveState();\n\n      return {\n        cursorState: cursorState,\n        viewState: viewState,\n        contributionsState: contributionsState\n      };\n    }\n  }, {\n    key: \"restoreViewState\",\n    value: function restoreViewState(s) {\n      if (!this._modelData || !this._modelData.hasRealView) {\n        return;\n      }\n\n      var codeEditorState = s;\n\n      if (codeEditorState && codeEditorState.cursorState && codeEditorState.viewState) {\n        var cursorState = codeEditorState.cursorState;\n\n        if (Array.isArray(cursorState)) {\n          this._modelData.viewModel.restoreCursorState(cursorState);\n        } else {\n          // Backwards compatibility\n          this._modelData.viewModel.restoreCursorState([cursorState]);\n        }\n\n        var contributionsState = codeEditorState.contributionsState || {};\n        var keys = Object.keys(this._contributions);\n\n        for (var i = 0, len = keys.length; i < len; i++) {\n          var id = keys[i];\n          var contribution = this._contributions[id];\n\n          if (typeof contribution.restoreViewState === 'function') {\n            contribution.restoreViewState(contributionsState[id]);\n          }\n        }\n\n        var reducedState = this._modelData.viewModel.reduceRestoreState(codeEditorState.viewState);\n\n        this._modelData.view.restoreState(reducedState);\n      }\n    }\n  }, {\n    key: \"getContribution\",\n    value: function getContribution(id) {\n      return this._contributions[id] || null;\n    }\n  }, {\n    key: \"getActions\",\n    value: function getActions() {\n      var result = [];\n      var keys = Object.keys(this._actions);\n\n      for (var i = 0, len = keys.length; i < len; i++) {\n        var id = keys[i];\n        result.push(this._actions[id]);\n      }\n\n      return result;\n    }\n  }, {\n    key: \"getSupportedActions\",\n    value: function getSupportedActions() {\n      var result = this.getActions();\n      result = result.filter(function (action) {\n        return action.isSupported();\n      });\n      return result;\n    }\n  }, {\n    key: \"getAction\",\n    value: function getAction(id) {\n      return this._actions[id] || null;\n    }\n  }, {\n    key: \"trigger\",\n    value: function trigger(source, handlerId, payload) {\n      payload = payload || {};\n\n      switch (handlerId) {\n        case \"compositionStart\"\n        /* CompositionStart */\n        :\n          this._startComposition();\n\n          return;\n\n        case \"compositionEnd\"\n        /* CompositionEnd */\n        :\n          this._endComposition(source);\n\n          return;\n\n        case \"type\"\n        /* Type */\n        :\n          {\n            var args = payload;\n\n            this._type(source, args.text || '');\n\n            return;\n          }\n\n        case \"replacePreviousChar\"\n        /* ReplacePreviousChar */\n        :\n          {\n            var _args = payload;\n\n            this._replacePreviousChar(source, _args.text || '', _args.replaceCharCnt || 0);\n\n            return;\n          }\n\n        case \"paste\"\n        /* Paste */\n        :\n          {\n            var _args2 = payload;\n\n            this._paste(source, _args2.text || '', _args2.pasteOnNewLine || false, _args2.multicursorText || null, _args2.mode || null);\n\n            return;\n          }\n\n        case \"cut\"\n        /* Cut */\n        :\n          this._cut(source);\n\n          return;\n      }\n\n      var action = this.getAction(handlerId);\n\n      if (action) {\n        Promise.resolve(action.run()).then(undefined, onUnexpectedError);\n        return;\n      }\n\n      if (!this._modelData) {\n        return;\n      }\n\n      if (this._triggerEditorCommand(source, handlerId, payload)) {\n        return;\n      }\n\n      this._commandService.executeCommand(handlerId, payload);\n    }\n  }, {\n    key: \"_startComposition\",\n    value: function _startComposition() {\n      if (!this._modelData) {\n        return;\n      }\n\n      this._modelData.viewModel.startComposition();\n\n      this._onDidCompositionStart.fire();\n    }\n  }, {\n    key: \"_endComposition\",\n    value: function _endComposition(source) {\n      if (!this._modelData) {\n        return;\n      }\n\n      this._modelData.viewModel.endComposition(source);\n\n      this._onDidCompositionEnd.fire();\n    }\n  }, {\n    key: \"_type\",\n    value: function _type(source, text) {\n      if (!this._modelData || text.length === 0) {\n        return;\n      }\n\n      if (source === 'keyboard') {\n        this._onWillType.fire(text);\n      }\n\n      this._modelData.viewModel.type(text, source);\n\n      if (source === 'keyboard') {\n        this._onDidType.fire(text);\n      }\n    }\n  }, {\n    key: \"_replacePreviousChar\",\n    value: function _replacePreviousChar(source, text, replaceCharCnt) {\n      if (!this._modelData) {\n        return;\n      }\n\n      this._modelData.viewModel.replacePreviousChar(text, replaceCharCnt, source);\n    }\n  }, {\n    key: \"_paste\",\n    value: function _paste(source, text, pasteOnNewLine, multicursorText, mode) {\n      if (!this._modelData || text.length === 0) {\n        return;\n      }\n\n      var startPosition = this._modelData.viewModel.getSelection().getStartPosition();\n\n      this._modelData.viewModel.paste(text, pasteOnNewLine, multicursorText, source);\n\n      var endPosition = this._modelData.viewModel.getSelection().getStartPosition();\n\n      if (source === 'keyboard') {\n        this._onDidPaste.fire({\n          range: new Range(startPosition.lineNumber, startPosition.column, endPosition.lineNumber, endPosition.column),\n          mode: mode\n        });\n      }\n    }\n  }, {\n    key: \"_cut\",\n    value: function _cut(source) {\n      if (!this._modelData) {\n        return;\n      }\n\n      this._modelData.viewModel.cut(source);\n    }\n  }, {\n    key: \"_triggerEditorCommand\",\n    value: function _triggerEditorCommand(source, handlerId, payload) {\n      var _this2 = this;\n\n      var command = EditorExtensionsRegistry.getEditorCommand(handlerId);\n\n      if (command) {\n        payload = payload || {};\n        payload.source = source;\n\n        this._instantiationService.invokeFunction(function (accessor) {\n          Promise.resolve(command.runEditorCommand(accessor, _this2, payload)).then(undefined, onUnexpectedError);\n        });\n\n        return true;\n      }\n\n      return false;\n    }\n  }, {\n    key: \"_getViewModel\",\n    value: function _getViewModel() {\n      if (!this._modelData) {\n        return null;\n      }\n\n      return this._modelData.viewModel;\n    }\n  }, {\n    key: \"pushUndoStop\",\n    value: function pushUndoStop() {\n      if (!this._modelData) {\n        return false;\n      }\n\n      if (this._configuration.options.get(75\n      /* readOnly */\n      )) {\n        // read only editor => sorry!\n        return false;\n      }\n\n      this._modelData.model.pushStackElement();\n\n      return true;\n    }\n  }, {\n    key: \"popUndoStop\",\n    value: function popUndoStop() {\n      if (!this._modelData) {\n        return false;\n      }\n\n      if (this._configuration.options.get(75\n      /* readOnly */\n      )) {\n        // read only editor => sorry!\n        return false;\n      }\n\n      this._modelData.model.popStackElement();\n\n      return true;\n    }\n  }, {\n    key: \"executeEdits\",\n    value: function executeEdits(source, edits, endCursorState) {\n      if (!this._modelData) {\n        return false;\n      }\n\n      if (this._configuration.options.get(75\n      /* readOnly */\n      )) {\n        // read only editor => sorry!\n        return false;\n      }\n\n      var cursorStateComputer;\n\n      if (!endCursorState) {\n        cursorStateComputer = function cursorStateComputer() {\n          return null;\n        };\n      } else if (Array.isArray(endCursorState)) {\n        cursorStateComputer = function cursorStateComputer() {\n          return endCursorState;\n        };\n      } else {\n        cursorStateComputer = endCursorState;\n      }\n\n      this._modelData.viewModel.executeEdits(source, edits, cursorStateComputer);\n\n      return true;\n    }\n  }, {\n    key: \"executeCommand\",\n    value: function executeCommand(source, command) {\n      if (!this._modelData) {\n        return;\n      }\n\n      this._modelData.viewModel.executeCommand(command, source);\n    }\n  }, {\n    key: \"executeCommands\",\n    value: function executeCommands(source, commands) {\n      if (!this._modelData) {\n        return;\n      }\n\n      this._modelData.viewModel.executeCommands(commands, source);\n    }\n  }, {\n    key: \"changeDecorations\",\n    value: function changeDecorations(callback) {\n      if (!this._modelData) {\n        // callback will not be called\n        return null;\n      }\n\n      return this._modelData.model.changeDecorations(callback, this._id);\n    }\n  }, {\n    key: \"getLineDecorations\",\n    value: function getLineDecorations(lineNumber) {\n      if (!this._modelData) {\n        return null;\n      }\n\n      return this._modelData.model.getLineDecorations(lineNumber, this._id, filterValidationDecorations(this._configuration.options));\n    }\n  }, {\n    key: \"deltaDecorations\",\n    value: function deltaDecorations(oldDecorations, newDecorations) {\n      if (!this._modelData) {\n        return [];\n      }\n\n      if (oldDecorations.length === 0 && newDecorations.length === 0) {\n        return oldDecorations;\n      }\n\n      return this._modelData.model.deltaDecorations(oldDecorations, newDecorations, this._id);\n    }\n  }, {\n    key: \"removeDecorations\",\n    value: function removeDecorations(decorationTypeKey) {\n      // remove decorations for type and sub type\n      var oldDecorationsIds = this._decorationTypeKeysToIds[decorationTypeKey];\n\n      if (oldDecorationsIds) {\n        this.deltaDecorations(oldDecorationsIds, []);\n      }\n\n      if (this._decorationTypeKeysToIds.hasOwnProperty(decorationTypeKey)) {\n        delete this._decorationTypeKeysToIds[decorationTypeKey];\n      }\n\n      if (this._decorationTypeSubtypes.hasOwnProperty(decorationTypeKey)) {\n        delete this._decorationTypeSubtypes[decorationTypeKey];\n      }\n    }\n  }, {\n    key: \"getLayoutInfo\",\n    value: function getLayoutInfo() {\n      var options = this._configuration.options;\n      var layoutInfo = options.get(124\n      /* layoutInfo */\n      );\n      return layoutInfo;\n    }\n  }, {\n    key: \"createOverviewRuler\",\n    value: function createOverviewRuler(cssClassName) {\n      if (!this._modelData || !this._modelData.hasRealView) {\n        return null;\n      }\n\n      return this._modelData.view.createOverviewRuler(cssClassName);\n    }\n  }, {\n    key: \"getContainerDomNode\",\n    value: function getContainerDomNode() {\n      return this._domElement;\n    }\n  }, {\n    key: \"getDomNode\",\n    value: function getDomNode() {\n      if (!this._modelData || !this._modelData.hasRealView) {\n        return null;\n      }\n\n      return this._modelData.view.domNode.domNode;\n    }\n  }, {\n    key: \"delegateVerticalScrollbarMouseDown\",\n    value: function delegateVerticalScrollbarMouseDown(browserEvent) {\n      if (!this._modelData || !this._modelData.hasRealView) {\n        return;\n      }\n\n      this._modelData.view.delegateVerticalScrollbarMouseDown(browserEvent);\n    }\n  }, {\n    key: \"layout\",\n    value: function layout(dimension) {\n      this._configuration.observeReferenceElement(dimension);\n\n      this.render();\n    }\n  }, {\n    key: \"focus\",\n    value: function focus() {\n      if (!this._modelData || !this._modelData.hasRealView) {\n        return;\n      }\n\n      this._modelData.view.focus();\n    }\n  }, {\n    key: \"hasTextFocus\",\n    value: function hasTextFocus() {\n      if (!this._modelData || !this._modelData.hasRealView) {\n        return false;\n      }\n\n      return this._modelData.view.isFocused();\n    }\n  }, {\n    key: \"hasWidgetFocus\",\n    value: function hasWidgetFocus() {\n      return this._focusTracker && this._focusTracker.hasFocus();\n    }\n  }, {\n    key: \"addContentWidget\",\n    value: function addContentWidget(widget) {\n      var widgetData = {\n        widget: widget,\n        position: widget.getPosition()\n      };\n\n      if (this._contentWidgets.hasOwnProperty(widget.getId())) {\n        console.warn('Overwriting a content widget with the same id.');\n      }\n\n      this._contentWidgets[widget.getId()] = widgetData;\n\n      if (this._modelData && this._modelData.hasRealView) {\n        this._modelData.view.addContentWidget(widgetData);\n      }\n    }\n  }, {\n    key: \"layoutContentWidget\",\n    value: function layoutContentWidget(widget) {\n      var widgetId = widget.getId();\n\n      if (this._contentWidgets.hasOwnProperty(widgetId)) {\n        var widgetData = this._contentWidgets[widgetId];\n        widgetData.position = widget.getPosition();\n\n        if (this._modelData && this._modelData.hasRealView) {\n          this._modelData.view.layoutContentWidget(widgetData);\n        }\n      }\n    }\n  }, {\n    key: \"removeContentWidget\",\n    value: function removeContentWidget(widget) {\n      var widgetId = widget.getId();\n\n      if (this._contentWidgets.hasOwnProperty(widgetId)) {\n        var widgetData = this._contentWidgets[widgetId];\n        delete this._contentWidgets[widgetId];\n\n        if (this._modelData && this._modelData.hasRealView) {\n          this._modelData.view.removeContentWidget(widgetData);\n        }\n      }\n    }\n  }, {\n    key: \"addOverlayWidget\",\n    value: function addOverlayWidget(widget) {\n      var widgetData = {\n        widget: widget,\n        position: widget.getPosition()\n      };\n\n      if (this._overlayWidgets.hasOwnProperty(widget.getId())) {\n        console.warn('Overwriting an overlay widget with the same id.');\n      }\n\n      this._overlayWidgets[widget.getId()] = widgetData;\n\n      if (this._modelData && this._modelData.hasRealView) {\n        this._modelData.view.addOverlayWidget(widgetData);\n      }\n    }\n  }, {\n    key: \"layoutOverlayWidget\",\n    value: function layoutOverlayWidget(widget) {\n      var widgetId = widget.getId();\n\n      if (this._overlayWidgets.hasOwnProperty(widgetId)) {\n        var widgetData = this._overlayWidgets[widgetId];\n        widgetData.position = widget.getPosition();\n\n        if (this._modelData && this._modelData.hasRealView) {\n          this._modelData.view.layoutOverlayWidget(widgetData);\n        }\n      }\n    }\n  }, {\n    key: \"removeOverlayWidget\",\n    value: function removeOverlayWidget(widget) {\n      var widgetId = widget.getId();\n\n      if (this._overlayWidgets.hasOwnProperty(widgetId)) {\n        var widgetData = this._overlayWidgets[widgetId];\n        delete this._overlayWidgets[widgetId];\n\n        if (this._modelData && this._modelData.hasRealView) {\n          this._modelData.view.removeOverlayWidget(widgetData);\n        }\n      }\n    }\n  }, {\n    key: \"changeViewZones\",\n    value: function changeViewZones(callback) {\n      if (!this._modelData || !this._modelData.hasRealView) {\n        return;\n      }\n\n      this._modelData.view.change(callback);\n    }\n  }, {\n    key: \"getTargetAtClientPoint\",\n    value: function getTargetAtClientPoint(clientX, clientY) {\n      if (!this._modelData || !this._modelData.hasRealView) {\n        return null;\n      }\n\n      return this._modelData.view.getTargetAtClientPoint(clientX, clientY);\n    }\n  }, {\n    key: \"getScrolledVisiblePosition\",\n    value: function getScrolledVisiblePosition(rawPosition) {\n      if (!this._modelData || !this._modelData.hasRealView) {\n        return null;\n      }\n\n      var position = this._modelData.model.validatePosition(rawPosition);\n\n      var options = this._configuration.options;\n      var layoutInfo = options.get(124\n      /* layoutInfo */\n      );\n      var top = CodeEditorWidget._getVerticalOffsetForPosition(this._modelData, position.lineNumber, position.column) - this.getScrollTop();\n      var left = this._modelData.view.getOffsetForColumn(position.lineNumber, position.column) + layoutInfo.glyphMarginWidth + layoutInfo.lineNumbersWidth + layoutInfo.decorationsWidth - this.getScrollLeft();\n      return {\n        top: top,\n        left: left,\n        height: options.get(53\n        /* lineHeight */\n        )\n      };\n    }\n  }, {\n    key: \"getOffsetForColumn\",\n    value: function getOffsetForColumn(lineNumber, column) {\n      if (!this._modelData || !this._modelData.hasRealView) {\n        return -1;\n      }\n\n      return this._modelData.view.getOffsetForColumn(lineNumber, column);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var forceRedraw = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n      if (!this._modelData || !this._modelData.hasRealView) {\n        return;\n      }\n\n      this._modelData.view.render(true, forceRedraw);\n    }\n  }, {\n    key: \"setAriaOptions\",\n    value: function setAriaOptions(options) {\n      if (!this._modelData || !this._modelData.hasRealView) {\n        return;\n      }\n\n      this._modelData.view.setAriaOptions(options);\n    }\n  }, {\n    key: \"applyFontInfo\",\n    value: function applyFontInfo(target) {\n      Configuration.applyFontInfoSlow(target, this._configuration.options.get(38\n      /* fontInfo */\n      ));\n    }\n  }, {\n    key: \"_attachModel\",\n    value: function _attachModel(model) {\n      var _this3 = this;\n\n      if (!model) {\n        this._modelData = null;\n        return;\n      }\n\n      var listenersToRemove = [];\n\n      this._domElement.setAttribute('data-mode-id', model.getLanguageIdentifier().language);\n\n      this._configuration.setIsDominatedByLongLines(model.isDominatedByLongLines());\n\n      this._configuration.setMaxLineNumber(model.getLineCount());\n\n      model.onBeforeAttached();\n      var viewModel = new ViewModel(this._id, this._configuration, model, DOMLineBreaksComputerFactory.create(), MonospaceLineBreaksComputerFactory.create(this._configuration.options), function (callback) {\n        return dom.scheduleAtNextAnimationFrame(callback);\n      });\n      listenersToRemove.push(model.onDidChangeDecorations(function (e) {\n        return _this3._onDidChangeModelDecorations.fire(e);\n      }));\n      listenersToRemove.push(model.onDidChangeLanguage(function (e) {\n        _this3._domElement.setAttribute('data-mode-id', model.getLanguageIdentifier().language);\n\n        _this3._onDidChangeModelLanguage.fire(e);\n      }));\n      listenersToRemove.push(model.onDidChangeLanguageConfiguration(function (e) {\n        return _this3._onDidChangeModelLanguageConfiguration.fire(e);\n      }));\n      listenersToRemove.push(model.onDidChangeContent(function (e) {\n        return _this3._onDidChangeModelContent.fire(e);\n      }));\n      listenersToRemove.push(model.onDidChangeOptions(function (e) {\n        return _this3._onDidChangeModelOptions.fire(e);\n      })); // Someone might destroy the model from under the editor, so prevent any exceptions by setting a null model\n\n      listenersToRemove.push(model.onWillDispose(function () {\n        return _this3.setModel(null);\n      }));\n      listenersToRemove.push(viewModel.onEvent(function (e) {\n        switch (e.kind) {\n          case 0\n          /* ContentSizeChanged */\n          :\n            _this3._onDidContentSizeChange.fire(e);\n\n            break;\n\n          case 1\n          /* FocusChanged */\n          :\n            _this3._editorTextFocus.setValue(e.hasFocus);\n\n            break;\n\n          case 2\n          /* ScrollChanged */\n          :\n            _this3._onDidScrollChange.fire(e);\n\n            break;\n\n          case 3\n          /* ViewZonesChanged */\n          :\n            _this3._onDidChangeViewZones.fire();\n\n            break;\n\n          case 4\n          /* ReadOnlyEditAttempt */\n          :\n            _this3._onDidAttemptReadOnlyEdit.fire();\n\n            break;\n\n          case 5\n          /* CursorStateChanged */\n          :\n            {\n              if (e.reachedMaxCursorCount) {\n                _this3._notificationService.warn(nls.localize('cursors.maximum', \"The number of cursors has been limited to {0}.\", Cursor.MAX_CURSOR_COUNT));\n              }\n\n              var positions = [];\n\n              for (var i = 0, len = e.selections.length; i < len; i++) {\n                positions[i] = e.selections[i].getPosition();\n              }\n\n              var e1 = {\n                position: positions[0],\n                secondaryPositions: positions.slice(1),\n                reason: e.reason,\n                source: e.source\n              };\n\n              _this3._onDidChangeCursorPosition.fire(e1);\n\n              var e2 = {\n                selection: e.selections[0],\n                secondarySelections: e.selections.slice(1),\n                modelVersionId: e.modelVersionId,\n                oldSelections: e.oldSelections,\n                oldModelVersionId: e.oldModelVersionId,\n                source: e.source,\n                reason: e.reason\n              };\n\n              _this3._onDidChangeCursorSelection.fire(e2);\n\n              break;\n            }\n        }\n      }));\n\n      var _this$_createView = this._createView(viewModel),\n          _this$_createView2 = _slicedToArray(_this$_createView, 2),\n          view = _this$_createView2[0],\n          hasRealView = _this$_createView2[1];\n\n      if (hasRealView) {\n        this._domElement.appendChild(view.domNode.domNode);\n\n        var keys = Object.keys(this._contentWidgets);\n\n        for (var i = 0, len = keys.length; i < len; i++) {\n          var widgetId = keys[i];\n          view.addContentWidget(this._contentWidgets[widgetId]);\n        }\n\n        keys = Object.keys(this._overlayWidgets);\n\n        for (var _i2 = 0, _len = keys.length; _i2 < _len; _i2++) {\n          var _widgetId = keys[_i2];\n          view.addOverlayWidget(this._overlayWidgets[_widgetId]);\n        }\n\n        view.render(false, true);\n        view.domNode.domNode.setAttribute('data-uri', model.uri.toString());\n      }\n\n      this._modelData = new ModelData(model, viewModel, view, hasRealView, listenersToRemove);\n    }\n  }, {\n    key: \"_createView\",\n    value: function _createView(viewModel) {\n      var _this4 = this;\n\n      var commandDelegate;\n\n      if (this.isSimpleWidget) {\n        commandDelegate = {\n          paste: function paste(text, pasteOnNewLine, multicursorText, mode) {\n            _this4._paste('keyboard', text, pasteOnNewLine, multicursorText, mode);\n          },\n          type: function type(text) {\n            _this4._type('keyboard', text);\n          },\n          replacePreviousChar: function replacePreviousChar(text, replaceCharCnt) {\n            _this4._replacePreviousChar('keyboard', text, replaceCharCnt);\n          },\n          startComposition: function startComposition() {\n            _this4._startComposition();\n          },\n          endComposition: function endComposition() {\n            _this4._endComposition('keyboard');\n          },\n          cut: function cut() {\n            _this4._cut('keyboard');\n          }\n        };\n      } else {\n        commandDelegate = {\n          paste: function paste(text, pasteOnNewLine, multicursorText, mode) {\n            var payload = {\n              text: text,\n              pasteOnNewLine: pasteOnNewLine,\n              multicursorText: multicursorText,\n              mode: mode\n            };\n\n            _this4._commandService.executeCommand(\"paste\"\n            /* Paste */\n            , payload);\n          },\n          type: function type(text) {\n            var payload = {\n              text: text\n            };\n\n            _this4._commandService.executeCommand(\"type\"\n            /* Type */\n            , payload);\n          },\n          replacePreviousChar: function replacePreviousChar(text, replaceCharCnt) {\n            var payload = {\n              text: text,\n              replaceCharCnt: replaceCharCnt\n            };\n\n            _this4._commandService.executeCommand(\"replacePreviousChar\"\n            /* ReplacePreviousChar */\n            , payload);\n          },\n          startComposition: function startComposition() {\n            _this4._commandService.executeCommand(\"compositionStart\"\n            /* CompositionStart */\n            , {});\n          },\n          endComposition: function endComposition() {\n            _this4._commandService.executeCommand(\"compositionEnd\"\n            /* CompositionEnd */\n            , {});\n          },\n          cut: function cut() {\n            _this4._commandService.executeCommand(\"cut\"\n            /* Cut */\n            , {});\n          }\n        };\n      }\n\n      var viewUserInputEvents = new ViewUserInputEvents(viewModel.coordinatesConverter);\n\n      viewUserInputEvents.onKeyDown = function (e) {\n        return _this4._onKeyDown.fire(e);\n      };\n\n      viewUserInputEvents.onKeyUp = function (e) {\n        return _this4._onKeyUp.fire(e);\n      };\n\n      viewUserInputEvents.onContextMenu = function (e) {\n        return _this4._onContextMenu.fire(e);\n      };\n\n      viewUserInputEvents.onMouseMove = function (e) {\n        return _this4._onMouseMove.fire(e);\n      };\n\n      viewUserInputEvents.onMouseLeave = function (e) {\n        return _this4._onMouseLeave.fire(e);\n      };\n\n      viewUserInputEvents.onMouseDown = function (e) {\n        return _this4._onMouseDown.fire(e);\n      };\n\n      viewUserInputEvents.onMouseUp = function (e) {\n        return _this4._onMouseUp.fire(e);\n      };\n\n      viewUserInputEvents.onMouseDrag = function (e) {\n        return _this4._onMouseDrag.fire(e);\n      };\n\n      viewUserInputEvents.onMouseDrop = function (e) {\n        return _this4._onMouseDrop.fire(e);\n      };\n\n      viewUserInputEvents.onMouseDropCanceled = function (e) {\n        return _this4._onMouseDropCanceled.fire(e);\n      };\n\n      viewUserInputEvents.onMouseWheel = function (e) {\n        return _this4._onMouseWheel.fire(e);\n      };\n\n      var view = new View(commandDelegate, this._configuration, this._themeService, viewModel, viewUserInputEvents, this._overflowWidgetsDomNode);\n      return [view, true];\n    }\n  }, {\n    key: \"_postDetachModelCleanup\",\n    value: function _postDetachModelCleanup(detachedModel) {\n      if (detachedModel) {\n        detachedModel.removeAllDecorationsWithOwnerId(this._id);\n      }\n    }\n  }, {\n    key: \"_detachModel\",\n    value: function _detachModel() {\n      if (!this._modelData) {\n        return null;\n      }\n\n      var model = this._modelData.model;\n      var removeDomNode = this._modelData.hasRealView ? this._modelData.view.domNode.domNode : null;\n\n      this._modelData.dispose();\n\n      this._modelData = null;\n\n      this._domElement.removeAttribute('data-mode-id');\n\n      if (removeDomNode && this._domElement.contains(removeDomNode)) {\n        this._domElement.removeChild(removeDomNode);\n      }\n\n      return model;\n    }\n  }, {\n    key: \"_removeDecorationType\",\n    value: function _removeDecorationType(key) {\n      this._codeEditorService.removeDecorationType(key);\n    }\n  }, {\n    key: \"hasModel\",\n    value: function hasModel() {\n      return this._modelData !== null;\n    }\n  }], [{\n    key: \"_getVerticalOffsetForPosition\",\n    value: function _getVerticalOffsetForPosition(modelData, modelLineNumber, modelColumn) {\n      var modelPosition = modelData.model.validatePosition({\n        lineNumber: modelLineNumber,\n        column: modelColumn\n      });\n      var viewPosition = modelData.viewModel.coordinatesConverter.convertModelPositionToViewPosition(modelPosition);\n      return modelData.viewModel.viewLayout.getVerticalOffsetForLineNumber(viewPosition.lineNumber);\n    }\n  }]);\n\n  return CodeEditorWidget;\n}(Disposable);\n\nCodeEditorWidget = __decorate([__param(3, IInstantiationService), __param(4, ICodeEditorService), __param(5, ICommandService), __param(6, IContextKeyService), __param(7, IThemeService), __param(8, INotificationService), __param(9, IAccessibilityService)], CodeEditorWidget);\nexport { CodeEditorWidget };\nexport var BooleanEventEmitter = /*#__PURE__*/function (_Disposable2) {\n  _inherits(BooleanEventEmitter, _Disposable2);\n\n  var _super2 = _createSuper(BooleanEventEmitter);\n\n  function BooleanEventEmitter() {\n    var _this5;\n\n    _classCallCheck(this, BooleanEventEmitter);\n\n    _this5 = _super2.call(this);\n    _this5._onDidChangeToTrue = _this5._register(new Emitter());\n    _this5.onDidChangeToTrue = _this5._onDidChangeToTrue.event;\n    _this5._onDidChangeToFalse = _this5._register(new Emitter());\n    _this5.onDidChangeToFalse = _this5._onDidChangeToFalse.event;\n    _this5._value = 0\n    /* NotSet */\n    ;\n    return _this5;\n  }\n\n  _createClass(BooleanEventEmitter, [{\n    key: \"setValue\",\n    value: function setValue(_value) {\n      var value = _value ? 2\n      /* True */\n      : 1\n      /* False */\n      ;\n\n      if (this._value === value) {\n        return;\n      }\n\n      this._value = value;\n\n      if (this._value === 2\n      /* True */\n      ) {\n          this._onDidChangeToTrue.fire();\n        } else if (this._value === 1\n      /* False */\n      ) {\n          this._onDidChangeToFalse.fire();\n        }\n    }\n  }]);\n\n  return BooleanEventEmitter;\n}(Disposable);\n\nvar EditorContextKeysManager = /*#__PURE__*/function (_Disposable3) {\n  _inherits(EditorContextKeysManager, _Disposable3);\n\n  var _super3 = _createSuper(EditorContextKeysManager);\n\n  function EditorContextKeysManager(editor, contextKeyService) {\n    var _this6;\n\n    _classCallCheck(this, EditorContextKeysManager);\n\n    _this6 = _super3.call(this);\n    _this6._editor = editor;\n    contextKeyService.createKey('editorId', editor.getId());\n    _this6._editorSimpleInput = EditorContextKeys.editorSimpleInput.bindTo(contextKeyService);\n    _this6._editorFocus = EditorContextKeys.focus.bindTo(contextKeyService);\n    _this6._textInputFocus = EditorContextKeys.textInputFocus.bindTo(contextKeyService);\n    _this6._editorTextFocus = EditorContextKeys.editorTextFocus.bindTo(contextKeyService);\n    _this6._editorTabMovesFocus = EditorContextKeys.tabMovesFocus.bindTo(contextKeyService);\n    _this6._editorReadonly = EditorContextKeys.readOnly.bindTo(contextKeyService);\n    _this6._inDiffEditor = EditorContextKeys.inDiffEditor.bindTo(contextKeyService);\n    _this6._editorColumnSelection = EditorContextKeys.columnSelection.bindTo(contextKeyService);\n    _this6._hasMultipleSelections = EditorContextKeys.hasMultipleSelections.bindTo(contextKeyService);\n    _this6._hasNonEmptySelection = EditorContextKeys.hasNonEmptySelection.bindTo(contextKeyService);\n    _this6._canUndo = EditorContextKeys.canUndo.bindTo(contextKeyService);\n    _this6._canRedo = EditorContextKeys.canRedo.bindTo(contextKeyService);\n\n    _this6._register(_this6._editor.onDidChangeConfiguration(function () {\n      return _this6._updateFromConfig();\n    }));\n\n    _this6._register(_this6._editor.onDidChangeCursorSelection(function () {\n      return _this6._updateFromSelection();\n    }));\n\n    _this6._register(_this6._editor.onDidFocusEditorWidget(function () {\n      return _this6._updateFromFocus();\n    }));\n\n    _this6._register(_this6._editor.onDidBlurEditorWidget(function () {\n      return _this6._updateFromFocus();\n    }));\n\n    _this6._register(_this6._editor.onDidFocusEditorText(function () {\n      return _this6._updateFromFocus();\n    }));\n\n    _this6._register(_this6._editor.onDidBlurEditorText(function () {\n      return _this6._updateFromFocus();\n    }));\n\n    _this6._register(_this6._editor.onDidChangeModel(function () {\n      return _this6._updateFromModel();\n    }));\n\n    _this6._register(_this6._editor.onDidChangeConfiguration(function () {\n      return _this6._updateFromModel();\n    }));\n\n    _this6._updateFromConfig();\n\n    _this6._updateFromSelection();\n\n    _this6._updateFromFocus();\n\n    _this6._updateFromModel();\n\n    _this6._editorSimpleInput.set(_this6._editor.isSimpleWidget);\n\n    return _this6;\n  }\n\n  _createClass(EditorContextKeysManager, [{\n    key: \"_updateFromConfig\",\n    value: function _updateFromConfig() {\n      var options = this._editor.getOptions();\n\n      this._editorTabMovesFocus.set(options.get(123\n      /* tabFocusMode */\n      ));\n\n      this._editorReadonly.set(options.get(75\n      /* readOnly */\n      ));\n\n      this._inDiffEditor.set(options.get(49\n      /* inDiffEditor */\n      ));\n\n      this._editorColumnSelection.set(options.get(15\n      /* columnSelection */\n      ));\n    }\n  }, {\n    key: \"_updateFromSelection\",\n    value: function _updateFromSelection() {\n      var selections = this._editor.getSelections();\n\n      if (!selections) {\n        this._hasMultipleSelections.reset();\n\n        this._hasNonEmptySelection.reset();\n      } else {\n        this._hasMultipleSelections.set(selections.length > 1);\n\n        this._hasNonEmptySelection.set(selections.some(function (s) {\n          return !s.isEmpty();\n        }));\n      }\n    }\n  }, {\n    key: \"_updateFromFocus\",\n    value: function _updateFromFocus() {\n      this._editorFocus.set(this._editor.hasWidgetFocus() && !this._editor.isSimpleWidget);\n\n      this._editorTextFocus.set(this._editor.hasTextFocus() && !this._editor.isSimpleWidget);\n\n      this._textInputFocus.set(this._editor.hasTextFocus());\n    }\n  }, {\n    key: \"_updateFromModel\",\n    value: function _updateFromModel() {\n      var model = this._editor.getModel();\n\n      this._canUndo.set(Boolean(model && model.canUndo()));\n\n      this._canRedo.set(Boolean(model && model.canRedo()));\n    }\n  }]);\n\n  return EditorContextKeysManager;\n}(Disposable);\n\nexport var EditorModeContext = /*#__PURE__*/function (_Disposable4) {\n  _inherits(EditorModeContext, _Disposable4);\n\n  var _super4 = _createSuper(EditorModeContext);\n\n  function EditorModeContext(_editor, _contextKeyService) {\n    var _this7;\n\n    _classCallCheck(this, EditorModeContext);\n\n    _this7 = _super4.call(this);\n    _this7._editor = _editor;\n    _this7._contextKeyService = _contextKeyService;\n    _this7._langId = EditorContextKeys.languageId.bindTo(_contextKeyService);\n    _this7._hasCompletionItemProvider = EditorContextKeys.hasCompletionItemProvider.bindTo(_contextKeyService);\n    _this7._hasCodeActionsProvider = EditorContextKeys.hasCodeActionsProvider.bindTo(_contextKeyService);\n    _this7._hasCodeLensProvider = EditorContextKeys.hasCodeLensProvider.bindTo(_contextKeyService);\n    _this7._hasDefinitionProvider = EditorContextKeys.hasDefinitionProvider.bindTo(_contextKeyService);\n    _this7._hasDeclarationProvider = EditorContextKeys.hasDeclarationProvider.bindTo(_contextKeyService);\n    _this7._hasImplementationProvider = EditorContextKeys.hasImplementationProvider.bindTo(_contextKeyService);\n    _this7._hasTypeDefinitionProvider = EditorContextKeys.hasTypeDefinitionProvider.bindTo(_contextKeyService);\n    _this7._hasHoverProvider = EditorContextKeys.hasHoverProvider.bindTo(_contextKeyService);\n    _this7._hasDocumentHighlightProvider = EditorContextKeys.hasDocumentHighlightProvider.bindTo(_contextKeyService);\n    _this7._hasDocumentSymbolProvider = EditorContextKeys.hasDocumentSymbolProvider.bindTo(_contextKeyService);\n    _this7._hasReferenceProvider = EditorContextKeys.hasReferenceProvider.bindTo(_contextKeyService);\n    _this7._hasRenameProvider = EditorContextKeys.hasRenameProvider.bindTo(_contextKeyService);\n    _this7._hasSignatureHelpProvider = EditorContextKeys.hasSignatureHelpProvider.bindTo(_contextKeyService);\n    _this7._hasInlineHintsProvider = EditorContextKeys.hasInlineHintsProvider.bindTo(_contextKeyService);\n    _this7._hasDocumentFormattingProvider = EditorContextKeys.hasDocumentFormattingProvider.bindTo(_contextKeyService);\n    _this7._hasDocumentSelectionFormattingProvider = EditorContextKeys.hasDocumentSelectionFormattingProvider.bindTo(_contextKeyService);\n    _this7._hasMultipleDocumentFormattingProvider = EditorContextKeys.hasMultipleDocumentFormattingProvider.bindTo(_contextKeyService);\n    _this7._hasMultipleDocumentSelectionFormattingProvider = EditorContextKeys.hasMultipleDocumentSelectionFormattingProvider.bindTo(_contextKeyService);\n    _this7._isInWalkThrough = EditorContextKeys.isInWalkThroughSnippet.bindTo(_contextKeyService);\n\n    var update = function update() {\n      return _this7._update();\n    }; // update when model/mode changes\n\n\n    _this7._register(_editor.onDidChangeModel(update));\n\n    _this7._register(_editor.onDidChangeModelLanguage(update)); // update when registries change\n\n\n    _this7._register(modes.CompletionProviderRegistry.onDidChange(update));\n\n    _this7._register(modes.CodeActionProviderRegistry.onDidChange(update));\n\n    _this7._register(modes.CodeLensProviderRegistry.onDidChange(update));\n\n    _this7._register(modes.DefinitionProviderRegistry.onDidChange(update));\n\n    _this7._register(modes.DeclarationProviderRegistry.onDidChange(update));\n\n    _this7._register(modes.ImplementationProviderRegistry.onDidChange(update));\n\n    _this7._register(modes.TypeDefinitionProviderRegistry.onDidChange(update));\n\n    _this7._register(modes.HoverProviderRegistry.onDidChange(update));\n\n    _this7._register(modes.DocumentHighlightProviderRegistry.onDidChange(update));\n\n    _this7._register(modes.DocumentSymbolProviderRegistry.onDidChange(update));\n\n    _this7._register(modes.ReferenceProviderRegistry.onDidChange(update));\n\n    _this7._register(modes.RenameProviderRegistry.onDidChange(update));\n\n    _this7._register(modes.DocumentFormattingEditProviderRegistry.onDidChange(update));\n\n    _this7._register(modes.DocumentRangeFormattingEditProviderRegistry.onDidChange(update));\n\n    _this7._register(modes.SignatureHelpProviderRegistry.onDidChange(update));\n\n    _this7._register(modes.InlineHintsProviderRegistry.onDidChange(update));\n\n    update();\n    return _this7;\n  }\n\n  _createClass(EditorModeContext, [{\n    key: \"dispose\",\n    value: function dispose() {\n      _get(_getPrototypeOf(EditorModeContext.prototype), \"dispose\", this).call(this);\n    }\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      var _this8 = this;\n\n      this._contextKeyService.bufferChangeEvents(function () {\n        _this8._langId.reset();\n\n        _this8._hasCompletionItemProvider.reset();\n\n        _this8._hasCodeActionsProvider.reset();\n\n        _this8._hasCodeLensProvider.reset();\n\n        _this8._hasDefinitionProvider.reset();\n\n        _this8._hasDeclarationProvider.reset();\n\n        _this8._hasImplementationProvider.reset();\n\n        _this8._hasTypeDefinitionProvider.reset();\n\n        _this8._hasHoverProvider.reset();\n\n        _this8._hasDocumentHighlightProvider.reset();\n\n        _this8._hasDocumentSymbolProvider.reset();\n\n        _this8._hasReferenceProvider.reset();\n\n        _this8._hasRenameProvider.reset();\n\n        _this8._hasDocumentFormattingProvider.reset();\n\n        _this8._hasDocumentSelectionFormattingProvider.reset();\n\n        _this8._hasSignatureHelpProvider.reset();\n\n        _this8._isInWalkThrough.reset();\n      });\n    }\n  }, {\n    key: \"_update\",\n    value: function _update() {\n      var _this9 = this;\n\n      var model = this._editor.getModel();\n\n      if (!model) {\n        this.reset();\n        return;\n      }\n\n      this._contextKeyService.bufferChangeEvents(function () {\n        _this9._langId.set(model.getLanguageIdentifier().language);\n\n        _this9._hasCompletionItemProvider.set(modes.CompletionProviderRegistry.has(model));\n\n        _this9._hasCodeActionsProvider.set(modes.CodeActionProviderRegistry.has(model));\n\n        _this9._hasCodeLensProvider.set(modes.CodeLensProviderRegistry.has(model));\n\n        _this9._hasDefinitionProvider.set(modes.DefinitionProviderRegistry.has(model));\n\n        _this9._hasDeclarationProvider.set(modes.DeclarationProviderRegistry.has(model));\n\n        _this9._hasImplementationProvider.set(modes.ImplementationProviderRegistry.has(model));\n\n        _this9._hasTypeDefinitionProvider.set(modes.TypeDefinitionProviderRegistry.has(model));\n\n        _this9._hasHoverProvider.set(modes.HoverProviderRegistry.has(model));\n\n        _this9._hasDocumentHighlightProvider.set(modes.DocumentHighlightProviderRegistry.has(model));\n\n        _this9._hasDocumentSymbolProvider.set(modes.DocumentSymbolProviderRegistry.has(model));\n\n        _this9._hasReferenceProvider.set(modes.ReferenceProviderRegistry.has(model));\n\n        _this9._hasRenameProvider.set(modes.RenameProviderRegistry.has(model));\n\n        _this9._hasSignatureHelpProvider.set(modes.SignatureHelpProviderRegistry.has(model));\n\n        _this9._hasInlineHintsProvider.set(modes.InlineHintsProviderRegistry.has(model));\n\n        _this9._hasDocumentFormattingProvider.set(modes.DocumentFormattingEditProviderRegistry.has(model) || modes.DocumentRangeFormattingEditProviderRegistry.has(model));\n\n        _this9._hasDocumentSelectionFormattingProvider.set(modes.DocumentRangeFormattingEditProviderRegistry.has(model));\n\n        _this9._hasMultipleDocumentFormattingProvider.set(modes.DocumentFormattingEditProviderRegistry.all(model).length + modes.DocumentRangeFormattingEditProviderRegistry.all(model).length > 1);\n\n        _this9._hasMultipleDocumentSelectionFormattingProvider.set(modes.DocumentRangeFormattingEditProviderRegistry.all(model).length > 1);\n\n        _this9._isInWalkThrough.set(model.uri.scheme === Schemas.walkThroughSnippet);\n      });\n    }\n  }]);\n\n  return EditorModeContext;\n}(Disposable);\n\nvar CodeEditorWidgetFocusTracker = /*#__PURE__*/function (_Disposable5) {\n  _inherits(CodeEditorWidgetFocusTracker, _Disposable5);\n\n  var _super5 = _createSuper(CodeEditorWidgetFocusTracker);\n\n  function CodeEditorWidgetFocusTracker(domElement) {\n    var _this10;\n\n    _classCallCheck(this, CodeEditorWidgetFocusTracker);\n\n    _this10 = _super5.call(this);\n    _this10._onChange = _this10._register(new Emitter());\n    _this10.onChange = _this10._onChange.event;\n    _this10._hasFocus = false;\n    _this10._domFocusTracker = _this10._register(dom.trackFocus(domElement));\n\n    _this10._register(_this10._domFocusTracker.onDidFocus(function () {\n      _this10._hasFocus = true;\n\n      _this10._onChange.fire(undefined);\n    }));\n\n    _this10._register(_this10._domFocusTracker.onDidBlur(function () {\n      _this10._hasFocus = false;\n\n      _this10._onChange.fire(undefined);\n    }));\n\n    return _this10;\n  }\n\n  _createClass(CodeEditorWidgetFocusTracker, [{\n    key: \"hasFocus\",\n    value: function hasFocus() {\n      return this._hasFocus;\n    }\n  }]);\n\n  return CodeEditorWidgetFocusTracker;\n}(Disposable);\n\nvar squigglyStart = encodeURIComponent(\"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='\");\nvar squigglyEnd = encodeURIComponent(\"'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>\");\n\nfunction getSquigglySVGData(color) {\n  return squigglyStart + encodeURIComponent(color.toString()) + squigglyEnd;\n}\n\nvar dotdotdotStart = encodeURIComponent(\"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" height=\\\"3\\\" width=\\\"12\\\"><g fill=\\\"\");\nvar dotdotdotEnd = encodeURIComponent(\"\\\"><circle cx=\\\"1\\\" cy=\\\"1\\\" r=\\\"1\\\"/><circle cx=\\\"5\\\" cy=\\\"1\\\" r=\\\"1\\\"/><circle cx=\\\"9\\\" cy=\\\"1\\\" r=\\\"1\\\"/></g></svg>\");\n\nfunction getDotDotDotSVGData(color) {\n  return dotdotdotStart + encodeURIComponent(color.toString()) + dotdotdotEnd;\n}\n\nregisterThemingParticipant(function (theme, collector) {\n  var errorBorderColor = theme.getColor(editorErrorBorder);\n\n  if (errorBorderColor) {\n    collector.addRule(\".monaco-editor .\".concat(\"squiggly-error\"\n    /* EditorErrorDecoration */\n    , \" { border-bottom: 4px double \", errorBorderColor, \"; }\"));\n  }\n\n  var errorForeground = theme.getColor(editorErrorForeground);\n\n  if (errorForeground) {\n    collector.addRule(\".monaco-editor .\".concat(\"squiggly-error\"\n    /* EditorErrorDecoration */\n    , \" { background: url(\\\"data:image/svg+xml,\", getSquigglySVGData(errorForeground), \"\\\") repeat-x bottom left; }\"));\n  }\n\n  var errorBackground = theme.getColor(editorErrorBackground);\n\n  if (errorBackground) {\n    collector.addRule(\".monaco-editor .\".concat(\"squiggly-error\"\n    /* EditorErrorDecoration */\n    , \"::before { display: block; content: ''; width: 100%; height: 100%; background: \", errorBackground, \"; }\"));\n  }\n\n  var warningBorderColor = theme.getColor(editorWarningBorder);\n\n  if (warningBorderColor) {\n    collector.addRule(\".monaco-editor .\".concat(\"squiggly-warning\"\n    /* EditorWarningDecoration */\n    , \" { border-bottom: 4px double \", warningBorderColor, \"; }\"));\n  }\n\n  var warningForeground = theme.getColor(editorWarningForeground);\n\n  if (warningForeground) {\n    collector.addRule(\".monaco-editor .\".concat(\"squiggly-warning\"\n    /* EditorWarningDecoration */\n    , \" { background: url(\\\"data:image/svg+xml,\", getSquigglySVGData(warningForeground), \"\\\") repeat-x bottom left; }\"));\n  }\n\n  var warningBackground = theme.getColor(editorWarningBackground);\n\n  if (warningBackground) {\n    collector.addRule(\".monaco-editor .\".concat(\"squiggly-warning\"\n    /* EditorWarningDecoration */\n    , \"::before { display: block; content: ''; width: 100%; height: 100%; background: \", warningBackground, \"; }\"));\n  }\n\n  var infoBorderColor = theme.getColor(editorInfoBorder);\n\n  if (infoBorderColor) {\n    collector.addRule(\".monaco-editor .\".concat(\"squiggly-info\"\n    /* EditorInfoDecoration */\n    , \" { border-bottom: 4px double \", infoBorderColor, \"; }\"));\n  }\n\n  var infoForeground = theme.getColor(editorInfoForeground);\n\n  if (infoForeground) {\n    collector.addRule(\".monaco-editor .\".concat(\"squiggly-info\"\n    /* EditorInfoDecoration */\n    , \" { background: url(\\\"data:image/svg+xml,\", getSquigglySVGData(infoForeground), \"\\\") repeat-x bottom left; }\"));\n  }\n\n  var infoBackground = theme.getColor(editorInfoBackground);\n\n  if (infoBackground) {\n    collector.addRule(\".monaco-editor .\".concat(\"squiggly-info\"\n    /* EditorInfoDecoration */\n    , \"::before { display: block; content: ''; width: 100%; height: 100%; background: \", infoBackground, \"; }\"));\n  }\n\n  var hintBorderColor = theme.getColor(editorHintBorder);\n\n  if (hintBorderColor) {\n    collector.addRule(\".monaco-editor .\".concat(\"squiggly-hint\"\n    /* EditorHintDecoration */\n    , \" { border-bottom: 2px dotted \", hintBorderColor, \"; }\"));\n  }\n\n  var hintForeground = theme.getColor(editorHintForeground);\n\n  if (hintForeground) {\n    collector.addRule(\".monaco-editor .\".concat(\"squiggly-hint\"\n    /* EditorHintDecoration */\n    , \" { background: url(\\\"data:image/svg+xml,\", getDotDotDotSVGData(hintForeground), \"\\\") no-repeat bottom left; }\"));\n  }\n\n  var unnecessaryForeground = theme.getColor(editorUnnecessaryCodeOpacity);\n\n  if (unnecessaryForeground) {\n    collector.addRule(\".monaco-editor.showUnused .\".concat(\"squiggly-inline-unnecessary\"\n    /* EditorUnnecessaryInlineDecoration */\n    , \" { opacity: \", unnecessaryForeground.rgba.a, \"; }\"));\n  }\n\n  var unnecessaryBorder = theme.getColor(editorUnnecessaryCodeBorder);\n\n  if (unnecessaryBorder) {\n    collector.addRule(\".monaco-editor.showUnused .\".concat(\"squiggly-unnecessary\"\n    /* EditorUnnecessaryDecoration */\n    , \" { border-bottom: 2px dashed \", unnecessaryBorder, \"; }\"));\n  }\n\n  var deprecatedForeground = theme.getColor(editorForeground) || 'inherit';\n  collector.addRule(\".monaco-editor.showDeprecated .\".concat(\"squiggly-inline-deprecated\"\n  /* EditorDeprecatedInlineDecoration */\n  , \" { text-decoration: line-through; text-decoration-color: \", deprecatedForeground, \"}\"));\n});","map":{"version":3,"sources":["/home/bar007/Desktop/projects/tio/client/node_modules/monaco-editor/esm/vs/editor/browser/widget/codeEditorWidget.js"],"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","nls","dom","onUnexpectedError","Emitter","Disposable","dispose","Schemas","Configuration","EditorExtensionsRegistry","ICodeEditorService","View","ViewUserInputEvents","filterValidationDecorations","Cursor","CursorColumns","Position","Range","Selection","InternalEditorAction","editorCommon","EditorContextKeys","modes","editorUnnecessaryCodeBorder","editorUnnecessaryCodeOpacity","editorErrorBorder","editorErrorForeground","editorHintBorder","editorHintForeground","editorInfoBorder","editorInfoForeground","editorWarningBorder","editorWarningForeground","editorForeground","editorErrorBackground","editorInfoBackground","editorWarningBackground","ViewModel","ICommandService","IContextKeyService","IInstantiationService","ServiceCollection","INotificationService","IThemeService","registerThemingParticipant","IAccessibilityService","withNullAsUndefined","MonospaceLineBreaksComputerFactory","DOMLineBreaksComputerFactory","WordOperations","EDITOR_ID","ModelData","model","viewModel","view","hasRealView","listenersToRemove","onBeforeDetached","CodeEditorWidget","domElement","_options","codeEditorWidgetOptions","instantiationService","codeEditorService","commandService","contextKeyService","themeService","notificationService","accessibilityService","_onDidDispose","_register","onDidDispose","event","_onDidChangeModelContent","onDidChangeModelContent","_onDidChangeModelLanguage","onDidChangeModelLanguage","_onDidChangeModelLanguageConfiguration","onDidChangeModelLanguageConfiguration","_onDidChangeModelOptions","onDidChangeModelOptions","_onDidChangeModelDecorations","onDidChangeModelDecorations","_onDidChangeConfiguration","onDidChangeConfiguration","_onDidChangeModel","onDidChangeModel","_onDidChangeCursorPosition","onDidChangeCursorPosition","_onDidChangeCursorSelection","onDidChangeCursorSelection","_onDidAttemptReadOnlyEdit","onDidAttemptReadOnlyEdit","_onDidLayoutChange","onDidLayoutChange","_editorTextFocus","BooleanEventEmitter","onDidFocusEditorText","onDidChangeToTrue","onDidBlurEditorText","onDidChangeToFalse","_editorWidgetFocus","onDidFocusEditorWidget","onDidBlurEditorWidget","_onWillType","onWillType","_onDidType","onDidType","_onDidCompositionStart","onDidCompositionStart","_onDidCompositionEnd","onDidCompositionEnd","_onDidPaste","onDidPaste","_onMouseUp","onMouseUp","_onMouseDown","onMouseDown","_onMouseDrag","onMouseDrag","_onMouseDrop","onMouseDrop","_onMouseDropCanceled","onMouseDropCanceled","_onContextMenu","onContextMenu","_onMouseMove","onMouseMove","_onMouseLeave","onMouseLeave","_onMouseWheel","onMouseWheel","_onKeyUp","onKeyUp","_onKeyDown","onKeyDown","_onDidContentSizeChange","onDidContentSizeChange","_onDidScrollChange","onDidScrollChange","_onDidChangeViewZones","onDidChangeViewZones","options","assign","_domElement","_overflowWidgetsDomNode","overflowWidgetsDomNode","_id","_decorationTypeKeysToIds","_decorationTypeSubtypes","isSimpleWidget","_telemetryData","telemetryData","_configuration","_createConfiguration","onDidChange","e","fire","hasChanged","layoutInfo","get","_contextKeyService","createScoped","_notificationService","_codeEditorService","_commandService","_themeService","EditorContextKeysManager","EditorModeContext","_instantiationService","createChild","_modelData","_contributions","_actions","_focusTracker","CodeEditorWidgetFocusTracker","onChange","setValue","hasFocus","_contentWidgets","_overlayWidgets","contributions","Array","isArray","getEditorContributions","contribution","createInstance","ctor","id","err","getEditorActions","forEach","action","internalAction","label","alias","precondition","invokeFunction","accessor","Promise","resolve","runEditorCommand","addCodeEditor","getEditorType","EditorType","ICodeEditor","removeCodeEditor","keys","len","contributionId","_removeDecorationTypes","_postDetachModelCleanup","_detachModel","fn","newOptions","updateOptions","getRawOptions","position","getWordAtPosition","preserveBOM","eolPreference","lineEnding","getValue","newValue","_model","hasTextFocus","detachedModel","_attachModel","hasModel","focus","oldModelUrl","uri","newModelUrl","decorationType","subTypes","subType","_removeDecorationType","getVisibleRanges","getVisibleRangesPlusViewportAboveBelow","viewLayout","getWhitespaces","lineNumber","_getVerticalOffsetForPosition","column","ranges","setHiddenAreas","map","lift","rawPosition","validatePosition","tabSize","getOptions","visibleColumnFromColumn","getLineContent","getPosition","isIPosition","Error","setSelections","selectionStartLineNumber","selectionStartColumn","positionLineNumber","positionColumn","modelRange","verticalType","revealHorizontal","scrollType","isIRange","validatedModelRange","validateRange","viewRange","coordinatesConverter","convertModelRangeToViewRange","revealRange","_revealLine","revealType","_sendRevealRange","_revealPosition","getSelection","getSelections","something","isSelection","isISelection","isRange","_setSelectionImpl","selection","startLineNumber","startColumn","endLineNumber","endColumn","sel","_revealLines","range","revealVerticalInCenter","_revealRange","source","reason","getContentWidth","getScrollWidth","getCurrentScrollLeft","getContentHeight","getScrollHeight","getCurrentScrollTop","newScrollLeft","setScrollPosition","scrollLeft","newScrollTop","scrollTop","contributionsState","saveViewState","cursorState","saveCursorState","viewState","saveState","s","codeEditorState","restoreCursorState","restoreViewState","reducedState","reduceRestoreState","restoreState","result","push","getActions","filter","isSupported","handlerId","payload","_startComposition","_endComposition","args","_type","text","_replacePreviousChar","replaceCharCnt","_paste","pasteOnNewLine","multicursorText","mode","_cut","getAction","run","then","undefined","_triggerEditorCommand","executeCommand","startComposition","endComposition","type","replacePreviousChar","startPosition","getStartPosition","paste","endPosition","cut","command","getEditorCommand","pushStackElement","popStackElement","edits","endCursorState","cursorStateComputer","executeEdits","commands","executeCommands","callback","changeDecorations","getLineDecorations","oldDecorations","newDecorations","deltaDecorations","decorationTypeKey","oldDecorationsIds","hasOwnProperty","cssClassName","createOverviewRuler","domNode","browserEvent","delegateVerticalScrollbarMouseDown","dimension","observeReferenceElement","render","isFocused","widget","widgetData","getId","console","warn","addContentWidget","widgetId","layoutContentWidget","removeContentWidget","addOverlayWidget","layoutOverlayWidget","removeOverlayWidget","change","clientX","clientY","getTargetAtClientPoint","top","getScrollTop","left","getOffsetForColumn","glyphMarginWidth","lineNumbersWidth","decorationsWidth","getScrollLeft","height","forceRedraw","setAriaOptions","applyFontInfoSlow","setAttribute","getLanguageIdentifier","language","setIsDominatedByLongLines","isDominatedByLongLines","setMaxLineNumber","getLineCount","onBeforeAttached","create","scheduleAtNextAnimationFrame","onDidChangeDecorations","onDidChangeLanguage","onDidChangeLanguageConfiguration","onDidChangeContent","onDidChangeOptions","onWillDispose","setModel","onEvent","kind","reachedMaxCursorCount","localize","MAX_CURSOR_COUNT","positions","selections","e1","secondaryPositions","slice","e2","secondarySelections","modelVersionId","oldSelections","oldModelVersionId","_createView","appendChild","toString","commandDelegate","viewUserInputEvents","removeAllDecorationsWithOwnerId","removeDomNode","removeAttribute","contains","removeChild","removeDecorationType","modelData","modelLineNumber","modelColumn","modelPosition","viewPosition","convertModelPositionToViewPosition","getVerticalOffsetForLineNumber","_onDidChangeToTrue","_onDidChangeToFalse","_value","value","editor","_editor","createKey","_editorSimpleInput","editorSimpleInput","bindTo","_editorFocus","_textInputFocus","textInputFocus","editorTextFocus","_editorTabMovesFocus","tabMovesFocus","_editorReadonly","readOnly","_inDiffEditor","inDiffEditor","_editorColumnSelection","columnSelection","_hasMultipleSelections","hasMultipleSelections","_hasNonEmptySelection","hasNonEmptySelection","_canUndo","canUndo","_canRedo","canRedo","_updateFromConfig","_updateFromSelection","_updateFromFocus","_updateFromModel","set","reset","some","isEmpty","hasWidgetFocus","getModel","Boolean","_langId","languageId","_hasCompletionItemProvider","hasCompletionItemProvider","_hasCodeActionsProvider","hasCodeActionsProvider","_hasCodeLensProvider","hasCodeLensProvider","_hasDefinitionProvider","hasDefinitionProvider","_hasDeclarationProvider","hasDeclarationProvider","_hasImplementationProvider","hasImplementationProvider","_hasTypeDefinitionProvider","hasTypeDefinitionProvider","_hasHoverProvider","hasHoverProvider","_hasDocumentHighlightProvider","hasDocumentHighlightProvider","_hasDocumentSymbolProvider","hasDocumentSymbolProvider","_hasReferenceProvider","hasReferenceProvider","_hasRenameProvider","hasRenameProvider","_hasSignatureHelpProvider","hasSignatureHelpProvider","_hasInlineHintsProvider","hasInlineHintsProvider","_hasDocumentFormattingProvider","hasDocumentFormattingProvider","_hasDocumentSelectionFormattingProvider","hasDocumentSelectionFormattingProvider","_hasMultipleDocumentFormattingProvider","hasMultipleDocumentFormattingProvider","_hasMultipleDocumentSelectionFormattingProvider","hasMultipleDocumentSelectionFormattingProvider","_isInWalkThrough","isInWalkThroughSnippet","update","_update","CompletionProviderRegistry","CodeActionProviderRegistry","CodeLensProviderRegistry","DefinitionProviderRegistry","DeclarationProviderRegistry","ImplementationProviderRegistry","TypeDefinitionProviderRegistry","HoverProviderRegistry","DocumentHighlightProviderRegistry","DocumentSymbolProviderRegistry","ReferenceProviderRegistry","RenameProviderRegistry","DocumentFormattingEditProviderRegistry","DocumentRangeFormattingEditProviderRegistry","SignatureHelpProviderRegistry","InlineHintsProviderRegistry","bufferChangeEvents","has","all","scheme","walkThroughSnippet","_onChange","_hasFocus","_domFocusTracker","trackFocus","onDidFocus","onDidBlur","squigglyStart","encodeURIComponent","squigglyEnd","getSquigglySVGData","color","dotdotdotStart","dotdotdotEnd","getDotDotDotSVGData","theme","collector","errorBorderColor","getColor","addRule","errorForeground","errorBackground","warningBorderColor","warningForeground","warningBackground","infoBorderColor","infoForeground","infoBackground","hintBorderColor","hintForeground","unnecessaryForeground","rgba","a","unnecessaryBorder","deprecatedForeground"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './media/editor.css';\r\nimport * as nls from '../../../nls.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable, dispose } from '../../../base/common/lifecycle.js';\r\nimport { Schemas } from '../../../base/common/network.js';\r\nimport { Configuration } from '../config/configuration.js';\r\nimport { EditorExtensionsRegistry } from '../editorExtensions.js';\r\nimport { ICodeEditorService } from '../services/codeEditorService.js';\r\nimport { View } from '../view/viewImpl.js';\r\nimport { ViewUserInputEvents } from '../view/viewUserInputEvents.js';\r\nimport { filterValidationDecorations } from '../../common/config/editorOptions.js';\r\nimport { Cursor } from '../../common/controller/cursor.js';\r\nimport { CursorColumns } from '../../common/controller/cursorCommon.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { InternalEditorAction } from '../../common/editorAction.js';\r\nimport * as editorCommon from '../../common/editorCommon.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport * as modes from '../../common/modes.js';\r\nimport { editorUnnecessaryCodeBorder, editorUnnecessaryCodeOpacity } from '../../common/view/editorColorRegistry.js';\r\nimport { editorErrorBorder, editorErrorForeground, editorHintBorder, editorHintForeground, editorInfoBorder, editorInfoForeground, editorWarningBorder, editorWarningForeground, editorForeground, editorErrorBackground, editorInfoBackground, editorWarningBackground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { ViewModel } from '../../common/viewModel/viewModelImpl.js';\r\nimport { ICommandService } from '../../../platform/commands/common/commands.js';\r\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { ServiceCollection } from '../../../platform/instantiation/common/serviceCollection.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { IThemeService, registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { IAccessibilityService } from '../../../platform/accessibility/common/accessibility.js';\r\nimport { withNullAsUndefined } from '../../../base/common/types.js';\r\nimport { MonospaceLineBreaksComputerFactory } from '../../common/viewModel/monospaceLineBreaksComputer.js';\r\nimport { DOMLineBreaksComputerFactory } from '../view/domLineBreaksComputer.js';\r\nimport { WordOperations } from '../../common/controller/cursorWordOperations.js';\r\nlet EDITOR_ID = 0;\r\nclass ModelData {\r\n    constructor(model, viewModel, view, hasRealView, listenersToRemove) {\r\n        this.model = model;\r\n        this.viewModel = viewModel;\r\n        this.view = view;\r\n        this.hasRealView = hasRealView;\r\n        this.listenersToRemove = listenersToRemove;\r\n    }\r\n    dispose() {\r\n        dispose(this.listenersToRemove);\r\n        this.model.onBeforeDetached();\r\n        if (this.hasRealView) {\r\n            this.view.dispose();\r\n        }\r\n        this.viewModel.dispose();\r\n    }\r\n}\r\nlet CodeEditorWidget = class CodeEditorWidget extends Disposable {\r\n    constructor(domElement, _options, codeEditorWidgetOptions, instantiationService, codeEditorService, commandService, contextKeyService, themeService, notificationService, accessibilityService) {\r\n        super();\r\n        //#region Eventing\r\n        this._onDidDispose = this._register(new Emitter());\r\n        this.onDidDispose = this._onDidDispose.event;\r\n        this._onDidChangeModelContent = this._register(new Emitter());\r\n        this.onDidChangeModelContent = this._onDidChangeModelContent.event;\r\n        this._onDidChangeModelLanguage = this._register(new Emitter());\r\n        this.onDidChangeModelLanguage = this._onDidChangeModelLanguage.event;\r\n        this._onDidChangeModelLanguageConfiguration = this._register(new Emitter());\r\n        this.onDidChangeModelLanguageConfiguration = this._onDidChangeModelLanguageConfiguration.event;\r\n        this._onDidChangeModelOptions = this._register(new Emitter());\r\n        this.onDidChangeModelOptions = this._onDidChangeModelOptions.event;\r\n        this._onDidChangeModelDecorations = this._register(new Emitter());\r\n        this.onDidChangeModelDecorations = this._onDidChangeModelDecorations.event;\r\n        this._onDidChangeConfiguration = this._register(new Emitter());\r\n        this.onDidChangeConfiguration = this._onDidChangeConfiguration.event;\r\n        this._onDidChangeModel = this._register(new Emitter());\r\n        this.onDidChangeModel = this._onDidChangeModel.event;\r\n        this._onDidChangeCursorPosition = this._register(new Emitter());\r\n        this.onDidChangeCursorPosition = this._onDidChangeCursorPosition.event;\r\n        this._onDidChangeCursorSelection = this._register(new Emitter());\r\n        this.onDidChangeCursorSelection = this._onDidChangeCursorSelection.event;\r\n        this._onDidAttemptReadOnlyEdit = this._register(new Emitter());\r\n        this.onDidAttemptReadOnlyEdit = this._onDidAttemptReadOnlyEdit.event;\r\n        this._onDidLayoutChange = this._register(new Emitter());\r\n        this.onDidLayoutChange = this._onDidLayoutChange.event;\r\n        this._editorTextFocus = this._register(new BooleanEventEmitter());\r\n        this.onDidFocusEditorText = this._editorTextFocus.onDidChangeToTrue;\r\n        this.onDidBlurEditorText = this._editorTextFocus.onDidChangeToFalse;\r\n        this._editorWidgetFocus = this._register(new BooleanEventEmitter());\r\n        this.onDidFocusEditorWidget = this._editorWidgetFocus.onDidChangeToTrue;\r\n        this.onDidBlurEditorWidget = this._editorWidgetFocus.onDidChangeToFalse;\r\n        this._onWillType = this._register(new Emitter());\r\n        this.onWillType = this._onWillType.event;\r\n        this._onDidType = this._register(new Emitter());\r\n        this.onDidType = this._onDidType.event;\r\n        this._onDidCompositionStart = this._register(new Emitter());\r\n        this.onDidCompositionStart = this._onDidCompositionStart.event;\r\n        this._onDidCompositionEnd = this._register(new Emitter());\r\n        this.onDidCompositionEnd = this._onDidCompositionEnd.event;\r\n        this._onDidPaste = this._register(new Emitter());\r\n        this.onDidPaste = this._onDidPaste.event;\r\n        this._onMouseUp = this._register(new Emitter());\r\n        this.onMouseUp = this._onMouseUp.event;\r\n        this._onMouseDown = this._register(new Emitter());\r\n        this.onMouseDown = this._onMouseDown.event;\r\n        this._onMouseDrag = this._register(new Emitter());\r\n        this.onMouseDrag = this._onMouseDrag.event;\r\n        this._onMouseDrop = this._register(new Emitter());\r\n        this.onMouseDrop = this._onMouseDrop.event;\r\n        this._onMouseDropCanceled = this._register(new Emitter());\r\n        this.onMouseDropCanceled = this._onMouseDropCanceled.event;\r\n        this._onContextMenu = this._register(new Emitter());\r\n        this.onContextMenu = this._onContextMenu.event;\r\n        this._onMouseMove = this._register(new Emitter());\r\n        this.onMouseMove = this._onMouseMove.event;\r\n        this._onMouseLeave = this._register(new Emitter());\r\n        this.onMouseLeave = this._onMouseLeave.event;\r\n        this._onMouseWheel = this._register(new Emitter());\r\n        this.onMouseWheel = this._onMouseWheel.event;\r\n        this._onKeyUp = this._register(new Emitter());\r\n        this.onKeyUp = this._onKeyUp.event;\r\n        this._onKeyDown = this._register(new Emitter());\r\n        this.onKeyDown = this._onKeyDown.event;\r\n        this._onDidContentSizeChange = this._register(new Emitter());\r\n        this.onDidContentSizeChange = this._onDidContentSizeChange.event;\r\n        this._onDidScrollChange = this._register(new Emitter());\r\n        this.onDidScrollChange = this._onDidScrollChange.event;\r\n        this._onDidChangeViewZones = this._register(new Emitter());\r\n        this.onDidChangeViewZones = this._onDidChangeViewZones.event;\r\n        const options = Object.assign({}, _options);\r\n        this._domElement = domElement;\r\n        this._overflowWidgetsDomNode = options.overflowWidgetsDomNode;\r\n        delete options.overflowWidgetsDomNode;\r\n        this._id = (++EDITOR_ID);\r\n        this._decorationTypeKeysToIds = {};\r\n        this._decorationTypeSubtypes = {};\r\n        this.isSimpleWidget = codeEditorWidgetOptions.isSimpleWidget || false;\r\n        this._telemetryData = codeEditorWidgetOptions.telemetryData;\r\n        this._configuration = this._register(this._createConfiguration(options, accessibilityService));\r\n        this._register(this._configuration.onDidChange((e) => {\r\n            this._onDidChangeConfiguration.fire(e);\r\n            const options = this._configuration.options;\r\n            if (e.hasChanged(124 /* layoutInfo */)) {\r\n                const layoutInfo = options.get(124 /* layoutInfo */);\r\n                this._onDidLayoutChange.fire(layoutInfo);\r\n            }\r\n        }));\r\n        this._contextKeyService = this._register(contextKeyService.createScoped(this._domElement));\r\n        this._notificationService = notificationService;\r\n        this._codeEditorService = codeEditorService;\r\n        this._commandService = commandService;\r\n        this._themeService = themeService;\r\n        this._register(new EditorContextKeysManager(this, this._contextKeyService));\r\n        this._register(new EditorModeContext(this, this._contextKeyService));\r\n        this._instantiationService = instantiationService.createChild(new ServiceCollection([IContextKeyService, this._contextKeyService]));\r\n        this._modelData = null;\r\n        this._contributions = {};\r\n        this._actions = {};\r\n        this._focusTracker = new CodeEditorWidgetFocusTracker(domElement);\r\n        this._focusTracker.onChange(() => {\r\n            this._editorWidgetFocus.setValue(this._focusTracker.hasFocus());\r\n        });\r\n        this._contentWidgets = {};\r\n        this._overlayWidgets = {};\r\n        let contributions;\r\n        if (Array.isArray(codeEditorWidgetOptions.contributions)) {\r\n            contributions = codeEditorWidgetOptions.contributions;\r\n        }\r\n        else {\r\n            contributions = EditorExtensionsRegistry.getEditorContributions();\r\n        }\r\n        for (const desc of contributions) {\r\n            try {\r\n                const contribution = this._instantiationService.createInstance(desc.ctor, this);\r\n                this._contributions[desc.id] = contribution;\r\n            }\r\n            catch (err) {\r\n                onUnexpectedError(err);\r\n            }\r\n        }\r\n        EditorExtensionsRegistry.getEditorActions().forEach((action) => {\r\n            const internalAction = new InternalEditorAction(action.id, action.label, action.alias, withNullAsUndefined(action.precondition), () => {\r\n                return this._instantiationService.invokeFunction((accessor) => {\r\n                    return Promise.resolve(action.runEditorCommand(accessor, this, null));\r\n                });\r\n            }, this._contextKeyService);\r\n            this._actions[internalAction.id] = internalAction;\r\n        });\r\n        this._codeEditorService.addCodeEditor(this);\r\n    }\r\n    _createConfiguration(options, accessibilityService) {\r\n        return new Configuration(this.isSimpleWidget, options, this._domElement, accessibilityService);\r\n    }\r\n    getId() {\r\n        return this.getEditorType() + ':' + this._id;\r\n    }\r\n    getEditorType() {\r\n        return editorCommon.EditorType.ICodeEditor;\r\n    }\r\n    dispose() {\r\n        this._codeEditorService.removeCodeEditor(this);\r\n        this._focusTracker.dispose();\r\n        const keys = Object.keys(this._contributions);\r\n        for (let i = 0, len = keys.length; i < len; i++) {\r\n            const contributionId = keys[i];\r\n            this._contributions[contributionId].dispose();\r\n        }\r\n        this._removeDecorationTypes();\r\n        this._postDetachModelCleanup(this._detachModel());\r\n        this._onDidDispose.fire();\r\n        super.dispose();\r\n    }\r\n    invokeWithinContext(fn) {\r\n        return this._instantiationService.invokeFunction(fn);\r\n    }\r\n    updateOptions(newOptions) {\r\n        this._configuration.updateOptions(newOptions);\r\n    }\r\n    getOptions() {\r\n        return this._configuration.options;\r\n    }\r\n    getOption(id) {\r\n        return this._configuration.options.get(id);\r\n    }\r\n    getRawOptions() {\r\n        return this._configuration.getRawOptions();\r\n    }\r\n    getOverflowWidgetsDomNode() {\r\n        return this._overflowWidgetsDomNode;\r\n    }\r\n    getConfiguredWordAtPosition(position) {\r\n        if (!this._modelData) {\r\n            return null;\r\n        }\r\n        return WordOperations.getWordAtPosition(this._modelData.model, this._configuration.options.get(110 /* wordSeparators */), position);\r\n    }\r\n    getValue(options = null) {\r\n        if (!this._modelData) {\r\n            return '';\r\n        }\r\n        const preserveBOM = (options && options.preserveBOM) ? true : false;\r\n        let eolPreference = 0 /* TextDefined */;\r\n        if (options && options.lineEnding && options.lineEnding === '\\n') {\r\n            eolPreference = 1 /* LF */;\r\n        }\r\n        else if (options && options.lineEnding && options.lineEnding === '\\r\\n') {\r\n            eolPreference = 2 /* CRLF */;\r\n        }\r\n        return this._modelData.model.getValue(eolPreference, preserveBOM);\r\n    }\r\n    setValue(newValue) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        this._modelData.model.setValue(newValue);\r\n    }\r\n    getModel() {\r\n        if (!this._modelData) {\r\n            return null;\r\n        }\r\n        return this._modelData.model;\r\n    }\r\n    setModel(_model = null) {\r\n        const model = _model;\r\n        if (this._modelData === null && model === null) {\r\n            // Current model is the new model\r\n            return;\r\n        }\r\n        if (this._modelData && this._modelData.model === model) {\r\n            // Current model is the new model\r\n            return;\r\n        }\r\n        const hasTextFocus = this.hasTextFocus();\r\n        const detachedModel = this._detachModel();\r\n        this._attachModel(model);\r\n        if (hasTextFocus && this.hasModel()) {\r\n            this.focus();\r\n        }\r\n        const e = {\r\n            oldModelUrl: detachedModel ? detachedModel.uri : null,\r\n            newModelUrl: model ? model.uri : null\r\n        };\r\n        this._removeDecorationTypes();\r\n        this._onDidChangeModel.fire(e);\r\n        this._postDetachModelCleanup(detachedModel);\r\n    }\r\n    _removeDecorationTypes() {\r\n        this._decorationTypeKeysToIds = {};\r\n        if (this._decorationTypeSubtypes) {\r\n            for (let decorationType in this._decorationTypeSubtypes) {\r\n                const subTypes = this._decorationTypeSubtypes[decorationType];\r\n                for (let subType in subTypes) {\r\n                    this._removeDecorationType(decorationType + '-' + subType);\r\n                }\r\n            }\r\n            this._decorationTypeSubtypes = {};\r\n        }\r\n    }\r\n    getVisibleRanges() {\r\n        if (!this._modelData) {\r\n            return [];\r\n        }\r\n        return this._modelData.viewModel.getVisibleRanges();\r\n    }\r\n    getVisibleRangesPlusViewportAboveBelow() {\r\n        if (!this._modelData) {\r\n            return [];\r\n        }\r\n        return this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow();\r\n    }\r\n    getWhitespaces() {\r\n        if (!this._modelData) {\r\n            return [];\r\n        }\r\n        return this._modelData.viewModel.viewLayout.getWhitespaces();\r\n    }\r\n    static _getVerticalOffsetForPosition(modelData, modelLineNumber, modelColumn) {\r\n        const modelPosition = modelData.model.validatePosition({\r\n            lineNumber: modelLineNumber,\r\n            column: modelColumn\r\n        });\r\n        const viewPosition = modelData.viewModel.coordinatesConverter.convertModelPositionToViewPosition(modelPosition);\r\n        return modelData.viewModel.viewLayout.getVerticalOffsetForLineNumber(viewPosition.lineNumber);\r\n    }\r\n    getTopForLineNumber(lineNumber) {\r\n        if (!this._modelData) {\r\n            return -1;\r\n        }\r\n        return CodeEditorWidget._getVerticalOffsetForPosition(this._modelData, lineNumber, 1);\r\n    }\r\n    getTopForPosition(lineNumber, column) {\r\n        if (!this._modelData) {\r\n            return -1;\r\n        }\r\n        return CodeEditorWidget._getVerticalOffsetForPosition(this._modelData, lineNumber, column);\r\n    }\r\n    setHiddenAreas(ranges) {\r\n        if (this._modelData) {\r\n            this._modelData.viewModel.setHiddenAreas(ranges.map(r => Range.lift(r)));\r\n        }\r\n    }\r\n    getVisibleColumnFromPosition(rawPosition) {\r\n        if (!this._modelData) {\r\n            return rawPosition.column;\r\n        }\r\n        const position = this._modelData.model.validatePosition(rawPosition);\r\n        const tabSize = this._modelData.model.getOptions().tabSize;\r\n        return CursorColumns.visibleColumnFromColumn(this._modelData.model.getLineContent(position.lineNumber), position.column, tabSize) + 1;\r\n    }\r\n    getPosition() {\r\n        if (!this._modelData) {\r\n            return null;\r\n        }\r\n        return this._modelData.viewModel.getPosition();\r\n    }\r\n    setPosition(position) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        if (!Position.isIPosition(position)) {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        this._modelData.viewModel.setSelections('api', [{\r\n                selectionStartLineNumber: position.lineNumber,\r\n                selectionStartColumn: position.column,\r\n                positionLineNumber: position.lineNumber,\r\n                positionColumn: position.column\r\n            }]);\r\n    }\r\n    _sendRevealRange(modelRange, verticalType, revealHorizontal, scrollType) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        if (!Range.isIRange(modelRange)) {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        const validatedModelRange = this._modelData.model.validateRange(modelRange);\r\n        const viewRange = this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(validatedModelRange);\r\n        this._modelData.viewModel.revealRange('api', revealHorizontal, viewRange, verticalType, scrollType);\r\n    }\r\n    revealLine(lineNumber, scrollType = 0 /* Smooth */) {\r\n        this._revealLine(lineNumber, 0 /* Simple */, scrollType);\r\n    }\r\n    revealLineInCenter(lineNumber, scrollType = 0 /* Smooth */) {\r\n        this._revealLine(lineNumber, 1 /* Center */, scrollType);\r\n    }\r\n    revealLineInCenterIfOutsideViewport(lineNumber, scrollType = 0 /* Smooth */) {\r\n        this._revealLine(lineNumber, 2 /* CenterIfOutsideViewport */, scrollType);\r\n    }\r\n    revealLineNearTop(lineNumber, scrollType = 0 /* Smooth */) {\r\n        this._revealLine(lineNumber, 5 /* NearTop */, scrollType);\r\n    }\r\n    _revealLine(lineNumber, revealType, scrollType) {\r\n        if (typeof lineNumber !== 'number') {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        this._sendRevealRange(new Range(lineNumber, 1, lineNumber, 1), revealType, false, scrollType);\r\n    }\r\n    revealPosition(position, scrollType = 0 /* Smooth */) {\r\n        this._revealPosition(position, 0 /* Simple */, true, scrollType);\r\n    }\r\n    revealPositionInCenter(position, scrollType = 0 /* Smooth */) {\r\n        this._revealPosition(position, 1 /* Center */, true, scrollType);\r\n    }\r\n    revealPositionInCenterIfOutsideViewport(position, scrollType = 0 /* Smooth */) {\r\n        this._revealPosition(position, 2 /* CenterIfOutsideViewport */, true, scrollType);\r\n    }\r\n    revealPositionNearTop(position, scrollType = 0 /* Smooth */) {\r\n        this._revealPosition(position, 5 /* NearTop */, true, scrollType);\r\n    }\r\n    _revealPosition(position, verticalType, revealHorizontal, scrollType) {\r\n        if (!Position.isIPosition(position)) {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        this._sendRevealRange(new Range(position.lineNumber, position.column, position.lineNumber, position.column), verticalType, revealHorizontal, scrollType);\r\n    }\r\n    getSelection() {\r\n        if (!this._modelData) {\r\n            return null;\r\n        }\r\n        return this._modelData.viewModel.getSelection();\r\n    }\r\n    getSelections() {\r\n        if (!this._modelData) {\r\n            return null;\r\n        }\r\n        return this._modelData.viewModel.getSelections();\r\n    }\r\n    setSelection(something) {\r\n        const isSelection = Selection.isISelection(something);\r\n        const isRange = Range.isIRange(something);\r\n        if (!isSelection && !isRange) {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        if (isSelection) {\r\n            this._setSelectionImpl(something);\r\n        }\r\n        else if (isRange) {\r\n            // act as if it was an IRange\r\n            const selection = {\r\n                selectionStartLineNumber: something.startLineNumber,\r\n                selectionStartColumn: something.startColumn,\r\n                positionLineNumber: something.endLineNumber,\r\n                positionColumn: something.endColumn\r\n            };\r\n            this._setSelectionImpl(selection);\r\n        }\r\n    }\r\n    _setSelectionImpl(sel) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        const selection = new Selection(sel.selectionStartLineNumber, sel.selectionStartColumn, sel.positionLineNumber, sel.positionColumn);\r\n        this._modelData.viewModel.setSelections('api', [selection]);\r\n    }\r\n    revealLines(startLineNumber, endLineNumber, scrollType = 0 /* Smooth */) {\r\n        this._revealLines(startLineNumber, endLineNumber, 0 /* Simple */, scrollType);\r\n    }\r\n    revealLinesInCenter(startLineNumber, endLineNumber, scrollType = 0 /* Smooth */) {\r\n        this._revealLines(startLineNumber, endLineNumber, 1 /* Center */, scrollType);\r\n    }\r\n    revealLinesInCenterIfOutsideViewport(startLineNumber, endLineNumber, scrollType = 0 /* Smooth */) {\r\n        this._revealLines(startLineNumber, endLineNumber, 2 /* CenterIfOutsideViewport */, scrollType);\r\n    }\r\n    revealLinesNearTop(startLineNumber, endLineNumber, scrollType = 0 /* Smooth */) {\r\n        this._revealLines(startLineNumber, endLineNumber, 5 /* NearTop */, scrollType);\r\n    }\r\n    _revealLines(startLineNumber, endLineNumber, verticalType, scrollType) {\r\n        if (typeof startLineNumber !== 'number' || typeof endLineNumber !== 'number') {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        this._sendRevealRange(new Range(startLineNumber, 1, endLineNumber, 1), verticalType, false, scrollType);\r\n    }\r\n    revealRange(range, scrollType = 0 /* Smooth */, revealVerticalInCenter = false, revealHorizontal = true) {\r\n        this._revealRange(range, revealVerticalInCenter ? 1 /* Center */ : 0 /* Simple */, revealHorizontal, scrollType);\r\n    }\r\n    revealRangeInCenter(range, scrollType = 0 /* Smooth */) {\r\n        this._revealRange(range, 1 /* Center */, true, scrollType);\r\n    }\r\n    revealRangeInCenterIfOutsideViewport(range, scrollType = 0 /* Smooth */) {\r\n        this._revealRange(range, 2 /* CenterIfOutsideViewport */, true, scrollType);\r\n    }\r\n    revealRangeNearTop(range, scrollType = 0 /* Smooth */) {\r\n        this._revealRange(range, 5 /* NearTop */, true, scrollType);\r\n    }\r\n    revealRangeNearTopIfOutsideViewport(range, scrollType = 0 /* Smooth */) {\r\n        this._revealRange(range, 6 /* NearTopIfOutsideViewport */, true, scrollType);\r\n    }\r\n    revealRangeAtTop(range, scrollType = 0 /* Smooth */) {\r\n        this._revealRange(range, 3 /* Top */, true, scrollType);\r\n    }\r\n    _revealRange(range, verticalType, revealHorizontal, scrollType) {\r\n        if (!Range.isIRange(range)) {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        this._sendRevealRange(Range.lift(range), verticalType, revealHorizontal, scrollType);\r\n    }\r\n    setSelections(ranges, source = 'api', reason = 0 /* NotSet */) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        if (!ranges || ranges.length === 0) {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        for (let i = 0, len = ranges.length; i < len; i++) {\r\n            if (!Selection.isISelection(ranges[i])) {\r\n                throw new Error('Invalid arguments');\r\n            }\r\n        }\r\n        this._modelData.viewModel.setSelections(source, ranges, reason);\r\n    }\r\n    getContentWidth() {\r\n        if (!this._modelData) {\r\n            return -1;\r\n        }\r\n        return this._modelData.viewModel.viewLayout.getContentWidth();\r\n    }\r\n    getScrollWidth() {\r\n        if (!this._modelData) {\r\n            return -1;\r\n        }\r\n        return this._modelData.viewModel.viewLayout.getScrollWidth();\r\n    }\r\n    getScrollLeft() {\r\n        if (!this._modelData) {\r\n            return -1;\r\n        }\r\n        return this._modelData.viewModel.viewLayout.getCurrentScrollLeft();\r\n    }\r\n    getContentHeight() {\r\n        if (!this._modelData) {\r\n            return -1;\r\n        }\r\n        return this._modelData.viewModel.viewLayout.getContentHeight();\r\n    }\r\n    getScrollHeight() {\r\n        if (!this._modelData) {\r\n            return -1;\r\n        }\r\n        return this._modelData.viewModel.viewLayout.getScrollHeight();\r\n    }\r\n    getScrollTop() {\r\n        if (!this._modelData) {\r\n            return -1;\r\n        }\r\n        return this._modelData.viewModel.viewLayout.getCurrentScrollTop();\r\n    }\r\n    setScrollLeft(newScrollLeft, scrollType = 1 /* Immediate */) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        if (typeof newScrollLeft !== 'number') {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        this._modelData.viewModel.setScrollPosition({\r\n            scrollLeft: newScrollLeft\r\n        }, scrollType);\r\n    }\r\n    setScrollTop(newScrollTop, scrollType = 1 /* Immediate */) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        if (typeof newScrollTop !== 'number') {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        this._modelData.viewModel.setScrollPosition({\r\n            scrollTop: newScrollTop\r\n        }, scrollType);\r\n    }\r\n    setScrollPosition(position, scrollType = 1 /* Immediate */) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        this._modelData.viewModel.setScrollPosition(position, scrollType);\r\n    }\r\n    saveViewState() {\r\n        if (!this._modelData) {\r\n            return null;\r\n        }\r\n        const contributionsState = {};\r\n        const keys = Object.keys(this._contributions);\r\n        for (const id of keys) {\r\n            const contribution = this._contributions[id];\r\n            if (typeof contribution.saveViewState === 'function') {\r\n                contributionsState[id] = contribution.saveViewState();\r\n            }\r\n        }\r\n        const cursorState = this._modelData.viewModel.saveCursorState();\r\n        const viewState = this._modelData.viewModel.saveState();\r\n        return {\r\n            cursorState: cursorState,\r\n            viewState: viewState,\r\n            contributionsState: contributionsState\r\n        };\r\n    }\r\n    restoreViewState(s) {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return;\r\n        }\r\n        const codeEditorState = s;\r\n        if (codeEditorState && codeEditorState.cursorState && codeEditorState.viewState) {\r\n            const cursorState = codeEditorState.cursorState;\r\n            if (Array.isArray(cursorState)) {\r\n                this._modelData.viewModel.restoreCursorState(cursorState);\r\n            }\r\n            else {\r\n                // Backwards compatibility\r\n                this._modelData.viewModel.restoreCursorState([cursorState]);\r\n            }\r\n            const contributionsState = codeEditorState.contributionsState || {};\r\n            const keys = Object.keys(this._contributions);\r\n            for (let i = 0, len = keys.length; i < len; i++) {\r\n                const id = keys[i];\r\n                const contribution = this._contributions[id];\r\n                if (typeof contribution.restoreViewState === 'function') {\r\n                    contribution.restoreViewState(contributionsState[id]);\r\n                }\r\n            }\r\n            const reducedState = this._modelData.viewModel.reduceRestoreState(codeEditorState.viewState);\r\n            this._modelData.view.restoreState(reducedState);\r\n        }\r\n    }\r\n    getContribution(id) {\r\n        return (this._contributions[id] || null);\r\n    }\r\n    getActions() {\r\n        const result = [];\r\n        const keys = Object.keys(this._actions);\r\n        for (let i = 0, len = keys.length; i < len; i++) {\r\n            const id = keys[i];\r\n            result.push(this._actions[id]);\r\n        }\r\n        return result;\r\n    }\r\n    getSupportedActions() {\r\n        let result = this.getActions();\r\n        result = result.filter(action => action.isSupported());\r\n        return result;\r\n    }\r\n    getAction(id) {\r\n        return this._actions[id] || null;\r\n    }\r\n    trigger(source, handlerId, payload) {\r\n        payload = payload || {};\r\n        switch (handlerId) {\r\n            case \"compositionStart\" /* CompositionStart */:\r\n                this._startComposition();\r\n                return;\r\n            case \"compositionEnd\" /* CompositionEnd */:\r\n                this._endComposition(source);\r\n                return;\r\n            case \"type\" /* Type */: {\r\n                const args = payload;\r\n                this._type(source, args.text || '');\r\n                return;\r\n            }\r\n            case \"replacePreviousChar\" /* ReplacePreviousChar */: {\r\n                const args = payload;\r\n                this._replacePreviousChar(source, args.text || '', args.replaceCharCnt || 0);\r\n                return;\r\n            }\r\n            case \"paste\" /* Paste */: {\r\n                const args = payload;\r\n                this._paste(source, args.text || '', args.pasteOnNewLine || false, args.multicursorText || null, args.mode || null);\r\n                return;\r\n            }\r\n            case \"cut\" /* Cut */:\r\n                this._cut(source);\r\n                return;\r\n        }\r\n        const action = this.getAction(handlerId);\r\n        if (action) {\r\n            Promise.resolve(action.run()).then(undefined, onUnexpectedError);\r\n            return;\r\n        }\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        if (this._triggerEditorCommand(source, handlerId, payload)) {\r\n            return;\r\n        }\r\n        this._commandService.executeCommand(handlerId, payload);\r\n    }\r\n    _startComposition() {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        this._modelData.viewModel.startComposition();\r\n        this._onDidCompositionStart.fire();\r\n    }\r\n    _endComposition(source) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        this._modelData.viewModel.endComposition(source);\r\n        this._onDidCompositionEnd.fire();\r\n    }\r\n    _type(source, text) {\r\n        if (!this._modelData || text.length === 0) {\r\n            return;\r\n        }\r\n        if (source === 'keyboard') {\r\n            this._onWillType.fire(text);\r\n        }\r\n        this._modelData.viewModel.type(text, source);\r\n        if (source === 'keyboard') {\r\n            this._onDidType.fire(text);\r\n        }\r\n    }\r\n    _replacePreviousChar(source, text, replaceCharCnt) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        this._modelData.viewModel.replacePreviousChar(text, replaceCharCnt, source);\r\n    }\r\n    _paste(source, text, pasteOnNewLine, multicursorText, mode) {\r\n        if (!this._modelData || text.length === 0) {\r\n            return;\r\n        }\r\n        const startPosition = this._modelData.viewModel.getSelection().getStartPosition();\r\n        this._modelData.viewModel.paste(text, pasteOnNewLine, multicursorText, source);\r\n        const endPosition = this._modelData.viewModel.getSelection().getStartPosition();\r\n        if (source === 'keyboard') {\r\n            this._onDidPaste.fire({\r\n                range: new Range(startPosition.lineNumber, startPosition.column, endPosition.lineNumber, endPosition.column),\r\n                mode: mode\r\n            });\r\n        }\r\n    }\r\n    _cut(source) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        this._modelData.viewModel.cut(source);\r\n    }\r\n    _triggerEditorCommand(source, handlerId, payload) {\r\n        const command = EditorExtensionsRegistry.getEditorCommand(handlerId);\r\n        if (command) {\r\n            payload = payload || {};\r\n            payload.source = source;\r\n            this._instantiationService.invokeFunction((accessor) => {\r\n                Promise.resolve(command.runEditorCommand(accessor, this, payload)).then(undefined, onUnexpectedError);\r\n            });\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    _getViewModel() {\r\n        if (!this._modelData) {\r\n            return null;\r\n        }\r\n        return this._modelData.viewModel;\r\n    }\r\n    pushUndoStop() {\r\n        if (!this._modelData) {\r\n            return false;\r\n        }\r\n        if (this._configuration.options.get(75 /* readOnly */)) {\r\n            // read only editor => sorry!\r\n            return false;\r\n        }\r\n        this._modelData.model.pushStackElement();\r\n        return true;\r\n    }\r\n    popUndoStop() {\r\n        if (!this._modelData) {\r\n            return false;\r\n        }\r\n        if (this._configuration.options.get(75 /* readOnly */)) {\r\n            // read only editor => sorry!\r\n            return false;\r\n        }\r\n        this._modelData.model.popStackElement();\r\n        return true;\r\n    }\r\n    executeEdits(source, edits, endCursorState) {\r\n        if (!this._modelData) {\r\n            return false;\r\n        }\r\n        if (this._configuration.options.get(75 /* readOnly */)) {\r\n            // read only editor => sorry!\r\n            return false;\r\n        }\r\n        let cursorStateComputer;\r\n        if (!endCursorState) {\r\n            cursorStateComputer = () => null;\r\n        }\r\n        else if (Array.isArray(endCursorState)) {\r\n            cursorStateComputer = () => endCursorState;\r\n        }\r\n        else {\r\n            cursorStateComputer = endCursorState;\r\n        }\r\n        this._modelData.viewModel.executeEdits(source, edits, cursorStateComputer);\r\n        return true;\r\n    }\r\n    executeCommand(source, command) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        this._modelData.viewModel.executeCommand(command, source);\r\n    }\r\n    executeCommands(source, commands) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        this._modelData.viewModel.executeCommands(commands, source);\r\n    }\r\n    changeDecorations(callback) {\r\n        if (!this._modelData) {\r\n            // callback will not be called\r\n            return null;\r\n        }\r\n        return this._modelData.model.changeDecorations(callback, this._id);\r\n    }\r\n    getLineDecorations(lineNumber) {\r\n        if (!this._modelData) {\r\n            return null;\r\n        }\r\n        return this._modelData.model.getLineDecorations(lineNumber, this._id, filterValidationDecorations(this._configuration.options));\r\n    }\r\n    deltaDecorations(oldDecorations, newDecorations) {\r\n        if (!this._modelData) {\r\n            return [];\r\n        }\r\n        if (oldDecorations.length === 0 && newDecorations.length === 0) {\r\n            return oldDecorations;\r\n        }\r\n        return this._modelData.model.deltaDecorations(oldDecorations, newDecorations, this._id);\r\n    }\r\n    removeDecorations(decorationTypeKey) {\r\n        // remove decorations for type and sub type\r\n        const oldDecorationsIds = this._decorationTypeKeysToIds[decorationTypeKey];\r\n        if (oldDecorationsIds) {\r\n            this.deltaDecorations(oldDecorationsIds, []);\r\n        }\r\n        if (this._decorationTypeKeysToIds.hasOwnProperty(decorationTypeKey)) {\r\n            delete this._decorationTypeKeysToIds[decorationTypeKey];\r\n        }\r\n        if (this._decorationTypeSubtypes.hasOwnProperty(decorationTypeKey)) {\r\n            delete this._decorationTypeSubtypes[decorationTypeKey];\r\n        }\r\n    }\r\n    getLayoutInfo() {\r\n        const options = this._configuration.options;\r\n        const layoutInfo = options.get(124 /* layoutInfo */);\r\n        return layoutInfo;\r\n    }\r\n    createOverviewRuler(cssClassName) {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return null;\r\n        }\r\n        return this._modelData.view.createOverviewRuler(cssClassName);\r\n    }\r\n    getContainerDomNode() {\r\n        return this._domElement;\r\n    }\r\n    getDomNode() {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return null;\r\n        }\r\n        return this._modelData.view.domNode.domNode;\r\n    }\r\n    delegateVerticalScrollbarMouseDown(browserEvent) {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return;\r\n        }\r\n        this._modelData.view.delegateVerticalScrollbarMouseDown(browserEvent);\r\n    }\r\n    layout(dimension) {\r\n        this._configuration.observeReferenceElement(dimension);\r\n        this.render();\r\n    }\r\n    focus() {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return;\r\n        }\r\n        this._modelData.view.focus();\r\n    }\r\n    hasTextFocus() {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return false;\r\n        }\r\n        return this._modelData.view.isFocused();\r\n    }\r\n    hasWidgetFocus() {\r\n        return this._focusTracker && this._focusTracker.hasFocus();\r\n    }\r\n    addContentWidget(widget) {\r\n        const widgetData = {\r\n            widget: widget,\r\n            position: widget.getPosition()\r\n        };\r\n        if (this._contentWidgets.hasOwnProperty(widget.getId())) {\r\n            console.warn('Overwriting a content widget with the same id.');\r\n        }\r\n        this._contentWidgets[widget.getId()] = widgetData;\r\n        if (this._modelData && this._modelData.hasRealView) {\r\n            this._modelData.view.addContentWidget(widgetData);\r\n        }\r\n    }\r\n    layoutContentWidget(widget) {\r\n        const widgetId = widget.getId();\r\n        if (this._contentWidgets.hasOwnProperty(widgetId)) {\r\n            const widgetData = this._contentWidgets[widgetId];\r\n            widgetData.position = widget.getPosition();\r\n            if (this._modelData && this._modelData.hasRealView) {\r\n                this._modelData.view.layoutContentWidget(widgetData);\r\n            }\r\n        }\r\n    }\r\n    removeContentWidget(widget) {\r\n        const widgetId = widget.getId();\r\n        if (this._contentWidgets.hasOwnProperty(widgetId)) {\r\n            const widgetData = this._contentWidgets[widgetId];\r\n            delete this._contentWidgets[widgetId];\r\n            if (this._modelData && this._modelData.hasRealView) {\r\n                this._modelData.view.removeContentWidget(widgetData);\r\n            }\r\n        }\r\n    }\r\n    addOverlayWidget(widget) {\r\n        const widgetData = {\r\n            widget: widget,\r\n            position: widget.getPosition()\r\n        };\r\n        if (this._overlayWidgets.hasOwnProperty(widget.getId())) {\r\n            console.warn('Overwriting an overlay widget with the same id.');\r\n        }\r\n        this._overlayWidgets[widget.getId()] = widgetData;\r\n        if (this._modelData && this._modelData.hasRealView) {\r\n            this._modelData.view.addOverlayWidget(widgetData);\r\n        }\r\n    }\r\n    layoutOverlayWidget(widget) {\r\n        const widgetId = widget.getId();\r\n        if (this._overlayWidgets.hasOwnProperty(widgetId)) {\r\n            const widgetData = this._overlayWidgets[widgetId];\r\n            widgetData.position = widget.getPosition();\r\n            if (this._modelData && this._modelData.hasRealView) {\r\n                this._modelData.view.layoutOverlayWidget(widgetData);\r\n            }\r\n        }\r\n    }\r\n    removeOverlayWidget(widget) {\r\n        const widgetId = widget.getId();\r\n        if (this._overlayWidgets.hasOwnProperty(widgetId)) {\r\n            const widgetData = this._overlayWidgets[widgetId];\r\n            delete this._overlayWidgets[widgetId];\r\n            if (this._modelData && this._modelData.hasRealView) {\r\n                this._modelData.view.removeOverlayWidget(widgetData);\r\n            }\r\n        }\r\n    }\r\n    changeViewZones(callback) {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return;\r\n        }\r\n        this._modelData.view.change(callback);\r\n    }\r\n    getTargetAtClientPoint(clientX, clientY) {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return null;\r\n        }\r\n        return this._modelData.view.getTargetAtClientPoint(clientX, clientY);\r\n    }\r\n    getScrolledVisiblePosition(rawPosition) {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return null;\r\n        }\r\n        const position = this._modelData.model.validatePosition(rawPosition);\r\n        const options = this._configuration.options;\r\n        const layoutInfo = options.get(124 /* layoutInfo */);\r\n        const top = CodeEditorWidget._getVerticalOffsetForPosition(this._modelData, position.lineNumber, position.column) - this.getScrollTop();\r\n        const left = this._modelData.view.getOffsetForColumn(position.lineNumber, position.column) + layoutInfo.glyphMarginWidth + layoutInfo.lineNumbersWidth + layoutInfo.decorationsWidth - this.getScrollLeft();\r\n        return {\r\n            top: top,\r\n            left: left,\r\n            height: options.get(53 /* lineHeight */)\r\n        };\r\n    }\r\n    getOffsetForColumn(lineNumber, column) {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return -1;\r\n        }\r\n        return this._modelData.view.getOffsetForColumn(lineNumber, column);\r\n    }\r\n    render(forceRedraw = false) {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return;\r\n        }\r\n        this._modelData.view.render(true, forceRedraw);\r\n    }\r\n    setAriaOptions(options) {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return;\r\n        }\r\n        this._modelData.view.setAriaOptions(options);\r\n    }\r\n    applyFontInfo(target) {\r\n        Configuration.applyFontInfoSlow(target, this._configuration.options.get(38 /* fontInfo */));\r\n    }\r\n    _attachModel(model) {\r\n        if (!model) {\r\n            this._modelData = null;\r\n            return;\r\n        }\r\n        const listenersToRemove = [];\r\n        this._domElement.setAttribute('data-mode-id', model.getLanguageIdentifier().language);\r\n        this._configuration.setIsDominatedByLongLines(model.isDominatedByLongLines());\r\n        this._configuration.setMaxLineNumber(model.getLineCount());\r\n        model.onBeforeAttached();\r\n        const viewModel = new ViewModel(this._id, this._configuration, model, DOMLineBreaksComputerFactory.create(), MonospaceLineBreaksComputerFactory.create(this._configuration.options), (callback) => dom.scheduleAtNextAnimationFrame(callback));\r\n        listenersToRemove.push(model.onDidChangeDecorations((e) => this._onDidChangeModelDecorations.fire(e)));\r\n        listenersToRemove.push(model.onDidChangeLanguage((e) => {\r\n            this._domElement.setAttribute('data-mode-id', model.getLanguageIdentifier().language);\r\n            this._onDidChangeModelLanguage.fire(e);\r\n        }));\r\n        listenersToRemove.push(model.onDidChangeLanguageConfiguration((e) => this._onDidChangeModelLanguageConfiguration.fire(e)));\r\n        listenersToRemove.push(model.onDidChangeContent((e) => this._onDidChangeModelContent.fire(e)));\r\n        listenersToRemove.push(model.onDidChangeOptions((e) => this._onDidChangeModelOptions.fire(e)));\r\n        // Someone might destroy the model from under the editor, so prevent any exceptions by setting a null model\r\n        listenersToRemove.push(model.onWillDispose(() => this.setModel(null)));\r\n        listenersToRemove.push(viewModel.onEvent((e) => {\r\n            switch (e.kind) {\r\n                case 0 /* ContentSizeChanged */:\r\n                    this._onDidContentSizeChange.fire(e);\r\n                    break;\r\n                case 1 /* FocusChanged */:\r\n                    this._editorTextFocus.setValue(e.hasFocus);\r\n                    break;\r\n                case 2 /* ScrollChanged */:\r\n                    this._onDidScrollChange.fire(e);\r\n                    break;\r\n                case 3 /* ViewZonesChanged */:\r\n                    this._onDidChangeViewZones.fire();\r\n                    break;\r\n                case 4 /* ReadOnlyEditAttempt */:\r\n                    this._onDidAttemptReadOnlyEdit.fire();\r\n                    break;\r\n                case 5 /* CursorStateChanged */: {\r\n                    if (e.reachedMaxCursorCount) {\r\n                        this._notificationService.warn(nls.localize('cursors.maximum', \"The number of cursors has been limited to {0}.\", Cursor.MAX_CURSOR_COUNT));\r\n                    }\r\n                    const positions = [];\r\n                    for (let i = 0, len = e.selections.length; i < len; i++) {\r\n                        positions[i] = e.selections[i].getPosition();\r\n                    }\r\n                    const e1 = {\r\n                        position: positions[0],\r\n                        secondaryPositions: positions.slice(1),\r\n                        reason: e.reason,\r\n                        source: e.source\r\n                    };\r\n                    this._onDidChangeCursorPosition.fire(e1);\r\n                    const e2 = {\r\n                        selection: e.selections[0],\r\n                        secondarySelections: e.selections.slice(1),\r\n                        modelVersionId: e.modelVersionId,\r\n                        oldSelections: e.oldSelections,\r\n                        oldModelVersionId: e.oldModelVersionId,\r\n                        source: e.source,\r\n                        reason: e.reason\r\n                    };\r\n                    this._onDidChangeCursorSelection.fire(e2);\r\n                    break;\r\n                }\r\n            }\r\n        }));\r\n        const [view, hasRealView] = this._createView(viewModel);\r\n        if (hasRealView) {\r\n            this._domElement.appendChild(view.domNode.domNode);\r\n            let keys = Object.keys(this._contentWidgets);\r\n            for (let i = 0, len = keys.length; i < len; i++) {\r\n                const widgetId = keys[i];\r\n                view.addContentWidget(this._contentWidgets[widgetId]);\r\n            }\r\n            keys = Object.keys(this._overlayWidgets);\r\n            for (let i = 0, len = keys.length; i < len; i++) {\r\n                const widgetId = keys[i];\r\n                view.addOverlayWidget(this._overlayWidgets[widgetId]);\r\n            }\r\n            view.render(false, true);\r\n            view.domNode.domNode.setAttribute('data-uri', model.uri.toString());\r\n        }\r\n        this._modelData = new ModelData(model, viewModel, view, hasRealView, listenersToRemove);\r\n    }\r\n    _createView(viewModel) {\r\n        let commandDelegate;\r\n        if (this.isSimpleWidget) {\r\n            commandDelegate = {\r\n                paste: (text, pasteOnNewLine, multicursorText, mode) => {\r\n                    this._paste('keyboard', text, pasteOnNewLine, multicursorText, mode);\r\n                },\r\n                type: (text) => {\r\n                    this._type('keyboard', text);\r\n                },\r\n                replacePreviousChar: (text, replaceCharCnt) => {\r\n                    this._replacePreviousChar('keyboard', text, replaceCharCnt);\r\n                },\r\n                startComposition: () => {\r\n                    this._startComposition();\r\n                },\r\n                endComposition: () => {\r\n                    this._endComposition('keyboard');\r\n                },\r\n                cut: () => {\r\n                    this._cut('keyboard');\r\n                }\r\n            };\r\n        }\r\n        else {\r\n            commandDelegate = {\r\n                paste: (text, pasteOnNewLine, multicursorText, mode) => {\r\n                    const payload = { text, pasteOnNewLine, multicursorText, mode };\r\n                    this._commandService.executeCommand(\"paste\" /* Paste */, payload);\r\n                },\r\n                type: (text) => {\r\n                    const payload = { text };\r\n                    this._commandService.executeCommand(\"type\" /* Type */, payload);\r\n                },\r\n                replacePreviousChar: (text, replaceCharCnt) => {\r\n                    const payload = { text, replaceCharCnt };\r\n                    this._commandService.executeCommand(\"replacePreviousChar\" /* ReplacePreviousChar */, payload);\r\n                },\r\n                startComposition: () => {\r\n                    this._commandService.executeCommand(\"compositionStart\" /* CompositionStart */, {});\r\n                },\r\n                endComposition: () => {\r\n                    this._commandService.executeCommand(\"compositionEnd\" /* CompositionEnd */, {});\r\n                },\r\n                cut: () => {\r\n                    this._commandService.executeCommand(\"cut\" /* Cut */, {});\r\n                }\r\n            };\r\n        }\r\n        const viewUserInputEvents = new ViewUserInputEvents(viewModel.coordinatesConverter);\r\n        viewUserInputEvents.onKeyDown = (e) => this._onKeyDown.fire(e);\r\n        viewUserInputEvents.onKeyUp = (e) => this._onKeyUp.fire(e);\r\n        viewUserInputEvents.onContextMenu = (e) => this._onContextMenu.fire(e);\r\n        viewUserInputEvents.onMouseMove = (e) => this._onMouseMove.fire(e);\r\n        viewUserInputEvents.onMouseLeave = (e) => this._onMouseLeave.fire(e);\r\n        viewUserInputEvents.onMouseDown = (e) => this._onMouseDown.fire(e);\r\n        viewUserInputEvents.onMouseUp = (e) => this._onMouseUp.fire(e);\r\n        viewUserInputEvents.onMouseDrag = (e) => this._onMouseDrag.fire(e);\r\n        viewUserInputEvents.onMouseDrop = (e) => this._onMouseDrop.fire(e);\r\n        viewUserInputEvents.onMouseDropCanceled = (e) => this._onMouseDropCanceled.fire(e);\r\n        viewUserInputEvents.onMouseWheel = (e) => this._onMouseWheel.fire(e);\r\n        const view = new View(commandDelegate, this._configuration, this._themeService, viewModel, viewUserInputEvents, this._overflowWidgetsDomNode);\r\n        return [view, true];\r\n    }\r\n    _postDetachModelCleanup(detachedModel) {\r\n        if (detachedModel) {\r\n            detachedModel.removeAllDecorationsWithOwnerId(this._id);\r\n        }\r\n    }\r\n    _detachModel() {\r\n        if (!this._modelData) {\r\n            return null;\r\n        }\r\n        const model = this._modelData.model;\r\n        const removeDomNode = this._modelData.hasRealView ? this._modelData.view.domNode.domNode : null;\r\n        this._modelData.dispose();\r\n        this._modelData = null;\r\n        this._domElement.removeAttribute('data-mode-id');\r\n        if (removeDomNode && this._domElement.contains(removeDomNode)) {\r\n            this._domElement.removeChild(removeDomNode);\r\n        }\r\n        return model;\r\n    }\r\n    _removeDecorationType(key) {\r\n        this._codeEditorService.removeDecorationType(key);\r\n    }\r\n    hasModel() {\r\n        return (this._modelData !== null);\r\n    }\r\n};\r\nCodeEditorWidget = __decorate([\r\n    __param(3, IInstantiationService),\r\n    __param(4, ICodeEditorService),\r\n    __param(5, ICommandService),\r\n    __param(6, IContextKeyService),\r\n    __param(7, IThemeService),\r\n    __param(8, INotificationService),\r\n    __param(9, IAccessibilityService)\r\n], CodeEditorWidget);\r\nexport { CodeEditorWidget };\r\nexport class BooleanEventEmitter extends Disposable {\r\n    constructor() {\r\n        super();\r\n        this._onDidChangeToTrue = this._register(new Emitter());\r\n        this.onDidChangeToTrue = this._onDidChangeToTrue.event;\r\n        this._onDidChangeToFalse = this._register(new Emitter());\r\n        this.onDidChangeToFalse = this._onDidChangeToFalse.event;\r\n        this._value = 0 /* NotSet */;\r\n    }\r\n    setValue(_value) {\r\n        const value = (_value ? 2 /* True */ : 1 /* False */);\r\n        if (this._value === value) {\r\n            return;\r\n        }\r\n        this._value = value;\r\n        if (this._value === 2 /* True */) {\r\n            this._onDidChangeToTrue.fire();\r\n        }\r\n        else if (this._value === 1 /* False */) {\r\n            this._onDidChangeToFalse.fire();\r\n        }\r\n    }\r\n}\r\nclass EditorContextKeysManager extends Disposable {\r\n    constructor(editor, contextKeyService) {\r\n        super();\r\n        this._editor = editor;\r\n        contextKeyService.createKey('editorId', editor.getId());\r\n        this._editorSimpleInput = EditorContextKeys.editorSimpleInput.bindTo(contextKeyService);\r\n        this._editorFocus = EditorContextKeys.focus.bindTo(contextKeyService);\r\n        this._textInputFocus = EditorContextKeys.textInputFocus.bindTo(contextKeyService);\r\n        this._editorTextFocus = EditorContextKeys.editorTextFocus.bindTo(contextKeyService);\r\n        this._editorTabMovesFocus = EditorContextKeys.tabMovesFocus.bindTo(contextKeyService);\r\n        this._editorReadonly = EditorContextKeys.readOnly.bindTo(contextKeyService);\r\n        this._inDiffEditor = EditorContextKeys.inDiffEditor.bindTo(contextKeyService);\r\n        this._editorColumnSelection = EditorContextKeys.columnSelection.bindTo(contextKeyService);\r\n        this._hasMultipleSelections = EditorContextKeys.hasMultipleSelections.bindTo(contextKeyService);\r\n        this._hasNonEmptySelection = EditorContextKeys.hasNonEmptySelection.bindTo(contextKeyService);\r\n        this._canUndo = EditorContextKeys.canUndo.bindTo(contextKeyService);\r\n        this._canRedo = EditorContextKeys.canRedo.bindTo(contextKeyService);\r\n        this._register(this._editor.onDidChangeConfiguration(() => this._updateFromConfig()));\r\n        this._register(this._editor.onDidChangeCursorSelection(() => this._updateFromSelection()));\r\n        this._register(this._editor.onDidFocusEditorWidget(() => this._updateFromFocus()));\r\n        this._register(this._editor.onDidBlurEditorWidget(() => this._updateFromFocus()));\r\n        this._register(this._editor.onDidFocusEditorText(() => this._updateFromFocus()));\r\n        this._register(this._editor.onDidBlurEditorText(() => this._updateFromFocus()));\r\n        this._register(this._editor.onDidChangeModel(() => this._updateFromModel()));\r\n        this._register(this._editor.onDidChangeConfiguration(() => this._updateFromModel()));\r\n        this._updateFromConfig();\r\n        this._updateFromSelection();\r\n        this._updateFromFocus();\r\n        this._updateFromModel();\r\n        this._editorSimpleInput.set(this._editor.isSimpleWidget);\r\n    }\r\n    _updateFromConfig() {\r\n        const options = this._editor.getOptions();\r\n        this._editorTabMovesFocus.set(options.get(123 /* tabFocusMode */));\r\n        this._editorReadonly.set(options.get(75 /* readOnly */));\r\n        this._inDiffEditor.set(options.get(49 /* inDiffEditor */));\r\n        this._editorColumnSelection.set(options.get(15 /* columnSelection */));\r\n    }\r\n    _updateFromSelection() {\r\n        const selections = this._editor.getSelections();\r\n        if (!selections) {\r\n            this._hasMultipleSelections.reset();\r\n            this._hasNonEmptySelection.reset();\r\n        }\r\n        else {\r\n            this._hasMultipleSelections.set(selections.length > 1);\r\n            this._hasNonEmptySelection.set(selections.some(s => !s.isEmpty()));\r\n        }\r\n    }\r\n    _updateFromFocus() {\r\n        this._editorFocus.set(this._editor.hasWidgetFocus() && !this._editor.isSimpleWidget);\r\n        this._editorTextFocus.set(this._editor.hasTextFocus() && !this._editor.isSimpleWidget);\r\n        this._textInputFocus.set(this._editor.hasTextFocus());\r\n    }\r\n    _updateFromModel() {\r\n        const model = this._editor.getModel();\r\n        this._canUndo.set(Boolean(model && model.canUndo()));\r\n        this._canRedo.set(Boolean(model && model.canRedo()));\r\n    }\r\n}\r\nexport class EditorModeContext extends Disposable {\r\n    constructor(_editor, _contextKeyService) {\r\n        super();\r\n        this._editor = _editor;\r\n        this._contextKeyService = _contextKeyService;\r\n        this._langId = EditorContextKeys.languageId.bindTo(_contextKeyService);\r\n        this._hasCompletionItemProvider = EditorContextKeys.hasCompletionItemProvider.bindTo(_contextKeyService);\r\n        this._hasCodeActionsProvider = EditorContextKeys.hasCodeActionsProvider.bindTo(_contextKeyService);\r\n        this._hasCodeLensProvider = EditorContextKeys.hasCodeLensProvider.bindTo(_contextKeyService);\r\n        this._hasDefinitionProvider = EditorContextKeys.hasDefinitionProvider.bindTo(_contextKeyService);\r\n        this._hasDeclarationProvider = EditorContextKeys.hasDeclarationProvider.bindTo(_contextKeyService);\r\n        this._hasImplementationProvider = EditorContextKeys.hasImplementationProvider.bindTo(_contextKeyService);\r\n        this._hasTypeDefinitionProvider = EditorContextKeys.hasTypeDefinitionProvider.bindTo(_contextKeyService);\r\n        this._hasHoverProvider = EditorContextKeys.hasHoverProvider.bindTo(_contextKeyService);\r\n        this._hasDocumentHighlightProvider = EditorContextKeys.hasDocumentHighlightProvider.bindTo(_contextKeyService);\r\n        this._hasDocumentSymbolProvider = EditorContextKeys.hasDocumentSymbolProvider.bindTo(_contextKeyService);\r\n        this._hasReferenceProvider = EditorContextKeys.hasReferenceProvider.bindTo(_contextKeyService);\r\n        this._hasRenameProvider = EditorContextKeys.hasRenameProvider.bindTo(_contextKeyService);\r\n        this._hasSignatureHelpProvider = EditorContextKeys.hasSignatureHelpProvider.bindTo(_contextKeyService);\r\n        this._hasInlineHintsProvider = EditorContextKeys.hasInlineHintsProvider.bindTo(_contextKeyService);\r\n        this._hasDocumentFormattingProvider = EditorContextKeys.hasDocumentFormattingProvider.bindTo(_contextKeyService);\r\n        this._hasDocumentSelectionFormattingProvider = EditorContextKeys.hasDocumentSelectionFormattingProvider.bindTo(_contextKeyService);\r\n        this._hasMultipleDocumentFormattingProvider = EditorContextKeys.hasMultipleDocumentFormattingProvider.bindTo(_contextKeyService);\r\n        this._hasMultipleDocumentSelectionFormattingProvider = EditorContextKeys.hasMultipleDocumentSelectionFormattingProvider.bindTo(_contextKeyService);\r\n        this._isInWalkThrough = EditorContextKeys.isInWalkThroughSnippet.bindTo(_contextKeyService);\r\n        const update = () => this._update();\r\n        // update when model/mode changes\r\n        this._register(_editor.onDidChangeModel(update));\r\n        this._register(_editor.onDidChangeModelLanguage(update));\r\n        // update when registries change\r\n        this._register(modes.CompletionProviderRegistry.onDidChange(update));\r\n        this._register(modes.CodeActionProviderRegistry.onDidChange(update));\r\n        this._register(modes.CodeLensProviderRegistry.onDidChange(update));\r\n        this._register(modes.DefinitionProviderRegistry.onDidChange(update));\r\n        this._register(modes.DeclarationProviderRegistry.onDidChange(update));\r\n        this._register(modes.ImplementationProviderRegistry.onDidChange(update));\r\n        this._register(modes.TypeDefinitionProviderRegistry.onDidChange(update));\r\n        this._register(modes.HoverProviderRegistry.onDidChange(update));\r\n        this._register(modes.DocumentHighlightProviderRegistry.onDidChange(update));\r\n        this._register(modes.DocumentSymbolProviderRegistry.onDidChange(update));\r\n        this._register(modes.ReferenceProviderRegistry.onDidChange(update));\r\n        this._register(modes.RenameProviderRegistry.onDidChange(update));\r\n        this._register(modes.DocumentFormattingEditProviderRegistry.onDidChange(update));\r\n        this._register(modes.DocumentRangeFormattingEditProviderRegistry.onDidChange(update));\r\n        this._register(modes.SignatureHelpProviderRegistry.onDidChange(update));\r\n        this._register(modes.InlineHintsProviderRegistry.onDidChange(update));\r\n        update();\r\n    }\r\n    dispose() {\r\n        super.dispose();\r\n    }\r\n    reset() {\r\n        this._contextKeyService.bufferChangeEvents(() => {\r\n            this._langId.reset();\r\n            this._hasCompletionItemProvider.reset();\r\n            this._hasCodeActionsProvider.reset();\r\n            this._hasCodeLensProvider.reset();\r\n            this._hasDefinitionProvider.reset();\r\n            this._hasDeclarationProvider.reset();\r\n            this._hasImplementationProvider.reset();\r\n            this._hasTypeDefinitionProvider.reset();\r\n            this._hasHoverProvider.reset();\r\n            this._hasDocumentHighlightProvider.reset();\r\n            this._hasDocumentSymbolProvider.reset();\r\n            this._hasReferenceProvider.reset();\r\n            this._hasRenameProvider.reset();\r\n            this._hasDocumentFormattingProvider.reset();\r\n            this._hasDocumentSelectionFormattingProvider.reset();\r\n            this._hasSignatureHelpProvider.reset();\r\n            this._isInWalkThrough.reset();\r\n        });\r\n    }\r\n    _update() {\r\n        const model = this._editor.getModel();\r\n        if (!model) {\r\n            this.reset();\r\n            return;\r\n        }\r\n        this._contextKeyService.bufferChangeEvents(() => {\r\n            this._langId.set(model.getLanguageIdentifier().language);\r\n            this._hasCompletionItemProvider.set(modes.CompletionProviderRegistry.has(model));\r\n            this._hasCodeActionsProvider.set(modes.CodeActionProviderRegistry.has(model));\r\n            this._hasCodeLensProvider.set(modes.CodeLensProviderRegistry.has(model));\r\n            this._hasDefinitionProvider.set(modes.DefinitionProviderRegistry.has(model));\r\n            this._hasDeclarationProvider.set(modes.DeclarationProviderRegistry.has(model));\r\n            this._hasImplementationProvider.set(modes.ImplementationProviderRegistry.has(model));\r\n            this._hasTypeDefinitionProvider.set(modes.TypeDefinitionProviderRegistry.has(model));\r\n            this._hasHoverProvider.set(modes.HoverProviderRegistry.has(model));\r\n            this._hasDocumentHighlightProvider.set(modes.DocumentHighlightProviderRegistry.has(model));\r\n            this._hasDocumentSymbolProvider.set(modes.DocumentSymbolProviderRegistry.has(model));\r\n            this._hasReferenceProvider.set(modes.ReferenceProviderRegistry.has(model));\r\n            this._hasRenameProvider.set(modes.RenameProviderRegistry.has(model));\r\n            this._hasSignatureHelpProvider.set(modes.SignatureHelpProviderRegistry.has(model));\r\n            this._hasInlineHintsProvider.set(modes.InlineHintsProviderRegistry.has(model));\r\n            this._hasDocumentFormattingProvider.set(modes.DocumentFormattingEditProviderRegistry.has(model) || modes.DocumentRangeFormattingEditProviderRegistry.has(model));\r\n            this._hasDocumentSelectionFormattingProvider.set(modes.DocumentRangeFormattingEditProviderRegistry.has(model));\r\n            this._hasMultipleDocumentFormattingProvider.set(modes.DocumentFormattingEditProviderRegistry.all(model).length + modes.DocumentRangeFormattingEditProviderRegistry.all(model).length > 1);\r\n            this._hasMultipleDocumentSelectionFormattingProvider.set(modes.DocumentRangeFormattingEditProviderRegistry.all(model).length > 1);\r\n            this._isInWalkThrough.set(model.uri.scheme === Schemas.walkThroughSnippet);\r\n        });\r\n    }\r\n}\r\nclass CodeEditorWidgetFocusTracker extends Disposable {\r\n    constructor(domElement) {\r\n        super();\r\n        this._onChange = this._register(new Emitter());\r\n        this.onChange = this._onChange.event;\r\n        this._hasFocus = false;\r\n        this._domFocusTracker = this._register(dom.trackFocus(domElement));\r\n        this._register(this._domFocusTracker.onDidFocus(() => {\r\n            this._hasFocus = true;\r\n            this._onChange.fire(undefined);\r\n        }));\r\n        this._register(this._domFocusTracker.onDidBlur(() => {\r\n            this._hasFocus = false;\r\n            this._onChange.fire(undefined);\r\n        }));\r\n    }\r\n    hasFocus() {\r\n        return this._hasFocus;\r\n    }\r\n}\r\nconst squigglyStart = encodeURIComponent(`<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='`);\r\nconst squigglyEnd = encodeURIComponent(`'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>`);\r\nfunction getSquigglySVGData(color) {\r\n    return squigglyStart + encodeURIComponent(color.toString()) + squigglyEnd;\r\n}\r\nconst dotdotdotStart = encodeURIComponent(`<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"3\" width=\"12\"><g fill=\"`);\r\nconst dotdotdotEnd = encodeURIComponent(`\"><circle cx=\"1\" cy=\"1\" r=\"1\"/><circle cx=\"5\" cy=\"1\" r=\"1\"/><circle cx=\"9\" cy=\"1\" r=\"1\"/></g></svg>`);\r\nfunction getDotDotDotSVGData(color) {\r\n    return dotdotdotStart + encodeURIComponent(color.toString()) + dotdotdotEnd;\r\n}\r\nregisterThemingParticipant((theme, collector) => {\r\n    const errorBorderColor = theme.getColor(editorErrorBorder);\r\n    if (errorBorderColor) {\r\n        collector.addRule(`.monaco-editor .${\"squiggly-error\" /* EditorErrorDecoration */} { border-bottom: 4px double ${errorBorderColor}; }`);\r\n    }\r\n    const errorForeground = theme.getColor(editorErrorForeground);\r\n    if (errorForeground) {\r\n        collector.addRule(`.monaco-editor .${\"squiggly-error\" /* EditorErrorDecoration */} { background: url(\"data:image/svg+xml,${getSquigglySVGData(errorForeground)}\") repeat-x bottom left; }`);\r\n    }\r\n    const errorBackground = theme.getColor(editorErrorBackground);\r\n    if (errorBackground) {\r\n        collector.addRule(`.monaco-editor .${\"squiggly-error\" /* EditorErrorDecoration */}::before { display: block; content: ''; width: 100%; height: 100%; background: ${errorBackground}; }`);\r\n    }\r\n    const warningBorderColor = theme.getColor(editorWarningBorder);\r\n    if (warningBorderColor) {\r\n        collector.addRule(`.monaco-editor .${\"squiggly-warning\" /* EditorWarningDecoration */} { border-bottom: 4px double ${warningBorderColor}; }`);\r\n    }\r\n    const warningForeground = theme.getColor(editorWarningForeground);\r\n    if (warningForeground) {\r\n        collector.addRule(`.monaco-editor .${\"squiggly-warning\" /* EditorWarningDecoration */} { background: url(\"data:image/svg+xml,${getSquigglySVGData(warningForeground)}\") repeat-x bottom left; }`);\r\n    }\r\n    const warningBackground = theme.getColor(editorWarningBackground);\r\n    if (warningBackground) {\r\n        collector.addRule(`.monaco-editor .${\"squiggly-warning\" /* EditorWarningDecoration */}::before { display: block; content: ''; width: 100%; height: 100%; background: ${warningBackground}; }`);\r\n    }\r\n    const infoBorderColor = theme.getColor(editorInfoBorder);\r\n    if (infoBorderColor) {\r\n        collector.addRule(`.monaco-editor .${\"squiggly-info\" /* EditorInfoDecoration */} { border-bottom: 4px double ${infoBorderColor}; }`);\r\n    }\r\n    const infoForeground = theme.getColor(editorInfoForeground);\r\n    if (infoForeground) {\r\n        collector.addRule(`.monaco-editor .${\"squiggly-info\" /* EditorInfoDecoration */} { background: url(\"data:image/svg+xml,${getSquigglySVGData(infoForeground)}\") repeat-x bottom left; }`);\r\n    }\r\n    const infoBackground = theme.getColor(editorInfoBackground);\r\n    if (infoBackground) {\r\n        collector.addRule(`.monaco-editor .${\"squiggly-info\" /* EditorInfoDecoration */}::before { display: block; content: ''; width: 100%; height: 100%; background: ${infoBackground}; }`);\r\n    }\r\n    const hintBorderColor = theme.getColor(editorHintBorder);\r\n    if (hintBorderColor) {\r\n        collector.addRule(`.monaco-editor .${\"squiggly-hint\" /* EditorHintDecoration */} { border-bottom: 2px dotted ${hintBorderColor}; }`);\r\n    }\r\n    const hintForeground = theme.getColor(editorHintForeground);\r\n    if (hintForeground) {\r\n        collector.addRule(`.monaco-editor .${\"squiggly-hint\" /* EditorHintDecoration */} { background: url(\"data:image/svg+xml,${getDotDotDotSVGData(hintForeground)}\") no-repeat bottom left; }`);\r\n    }\r\n    const unnecessaryForeground = theme.getColor(editorUnnecessaryCodeOpacity);\r\n    if (unnecessaryForeground) {\r\n        collector.addRule(`.monaco-editor.showUnused .${\"squiggly-inline-unnecessary\" /* EditorUnnecessaryInlineDecoration */} { opacity: ${unnecessaryForeground.rgba.a}; }`);\r\n    }\r\n    const unnecessaryBorder = theme.getColor(editorUnnecessaryCodeBorder);\r\n    if (unnecessaryBorder) {\r\n        collector.addRule(`.monaco-editor.showUnused .${\"squiggly-unnecessary\" /* EditorUnnecessaryDecoration */} { border-bottom: 2px dashed ${unnecessaryBorder}; }`);\r\n    }\r\n    const deprecatedForeground = theme.getColor(editorForeground) || 'inherit';\r\n    collector.addRule(`.monaco-editor.showDeprecated .${\"squiggly-inline-deprecated\" /* EditorDeprecatedInlineDecoration */} { text-decoration: line-through; text-decoration-color: ${deprecatedForeground}}`);\r\n});\r\n"]},"metadata":{},"sourceType":"module"}