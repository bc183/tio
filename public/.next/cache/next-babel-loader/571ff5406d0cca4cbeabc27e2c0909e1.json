{"ast":null,"code":"import _assertThisInitialized from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _get from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/get\";\nimport _inherits from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _classCallCheck from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/createClass\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nimport { EditorCommand, registerEditorCommand } from '../editorExtensions.js';\nimport { IContextKeyService, RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\nimport { CancellationTokenSource } from '../../../base/common/cancellation.js';\nimport { LinkedList } from '../../../base/common/linkedList.js';\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\nimport { registerSingleton } from '../../../platform/instantiation/common/extensions.js';\nvar IEditorCancellationTokens = createDecorator('IEditorCancelService');\nvar ctxCancellableOperation = new RawContextKey('cancellableOperation', false);\nregisterSingleton(IEditorCancellationTokens, /*#__PURE__*/function () {\n  function _class() {\n    _classCallCheck(this, _class);\n\n    this._tokens = new WeakMap();\n  }\n\n  _createClass(_class, [{\n    key: \"add\",\n    value: function add(editor, cts) {\n      var data = this._tokens.get(editor);\n\n      if (!data) {\n        data = editor.invokeWithinContext(function (accessor) {\n          var key = ctxCancellableOperation.bindTo(accessor.get(IContextKeyService));\n          var tokens = new LinkedList();\n          return {\n            key: key,\n            tokens: tokens\n          };\n        });\n\n        this._tokens.set(editor, data);\n      }\n\n      var removeFn;\n      data.key.set(true);\n      removeFn = data.tokens.push(cts);\n      return function () {\n        // remove w/o cancellation\n        if (removeFn) {\n          removeFn();\n          data.key.set(!data.tokens.isEmpty());\n          removeFn = undefined;\n        }\n      };\n    }\n  }, {\n    key: \"cancel\",\n    value: function cancel(editor) {\n      var data = this._tokens.get(editor);\n\n      if (!data) {\n        return;\n      } // remove with cancellation\n\n\n      var cts = data.tokens.pop();\n\n      if (cts) {\n        cts.cancel();\n        data.key.set(!data.tokens.isEmpty());\n      }\n    }\n  }]);\n\n  return _class;\n}(), true);\nexport var EditorKeybindingCancellationTokenSource = /*#__PURE__*/function (_CancellationTokenSou) {\n  _inherits(EditorKeybindingCancellationTokenSource, _CancellationTokenSou);\n\n  var _super = _createSuper(EditorKeybindingCancellationTokenSource);\n\n  function EditorKeybindingCancellationTokenSource(editor, parent) {\n    var _this;\n\n    _classCallCheck(this, EditorKeybindingCancellationTokenSource);\n\n    _this = _super.call(this, parent);\n    _this.editor = editor;\n    _this._unregister = editor.invokeWithinContext(function (accessor) {\n      return accessor.get(IEditorCancellationTokens).add(editor, _assertThisInitialized(_this));\n    });\n    return _this;\n  }\n\n  _createClass(EditorKeybindingCancellationTokenSource, [{\n    key: \"dispose\",\n    value: function dispose() {\n      this._unregister();\n\n      _get(_getPrototypeOf(EditorKeybindingCancellationTokenSource.prototype), \"dispose\", this).call(this);\n    }\n  }]);\n\n  return EditorKeybindingCancellationTokenSource;\n}(CancellationTokenSource);\nregisterEditorCommand(new ( /*#__PURE__*/function (_EditorCommand) {\n  _inherits(_class2, _EditorCommand);\n\n  var _super2 = _createSuper(_class2);\n\n  function _class2() {\n    _classCallCheck(this, _class2);\n\n    return _super2.call(this, {\n      id: 'editor.cancelOperation',\n      kbOpts: {\n        weight: 100\n        /* EditorContrib */\n        ,\n        primary: 9\n        /* Escape */\n\n      },\n      precondition: ctxCancellableOperation\n    });\n  }\n\n  _createClass(_class2, [{\n    key: \"runEditorCommand\",\n    value: function runEditorCommand(accessor, editor) {\n      accessor.get(IEditorCancellationTokens).cancel(editor);\n    }\n  }]);\n\n  return _class2;\n}(EditorCommand))());","map":{"version":3,"sources":["/home/bar007/Desktop/projects/tio/client/node_modules/monaco-editor/esm/vs/editor/browser/core/keybindingCancellation.js"],"names":["EditorCommand","registerEditorCommand","IContextKeyService","RawContextKey","CancellationTokenSource","LinkedList","createDecorator","registerSingleton","IEditorCancellationTokens","ctxCancellableOperation","_tokens","WeakMap","editor","cts","data","get","invokeWithinContext","accessor","key","bindTo","tokens","set","removeFn","push","isEmpty","undefined","pop","cancel","EditorKeybindingCancellationTokenSource","parent","_unregister","add","id","kbOpts","weight","primary","precondition"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { EditorCommand, registerEditorCommand } from '../editorExtensions.js';\r\nimport { IContextKeyService, RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { CancellationTokenSource } from '../../../base/common/cancellation.js';\r\nimport { LinkedList } from '../../../base/common/linkedList.js';\r\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { registerSingleton } from '../../../platform/instantiation/common/extensions.js';\r\nconst IEditorCancellationTokens = createDecorator('IEditorCancelService');\r\nconst ctxCancellableOperation = new RawContextKey('cancellableOperation', false);\r\nregisterSingleton(IEditorCancellationTokens, class {\r\n    constructor() {\r\n        this._tokens = new WeakMap();\r\n    }\r\n    add(editor, cts) {\r\n        let data = this._tokens.get(editor);\r\n        if (!data) {\r\n            data = editor.invokeWithinContext(accessor => {\r\n                const key = ctxCancellableOperation.bindTo(accessor.get(IContextKeyService));\r\n                const tokens = new LinkedList();\r\n                return { key, tokens };\r\n            });\r\n            this._tokens.set(editor, data);\r\n        }\r\n        let removeFn;\r\n        data.key.set(true);\r\n        removeFn = data.tokens.push(cts);\r\n        return () => {\r\n            // remove w/o cancellation\r\n            if (removeFn) {\r\n                removeFn();\r\n                data.key.set(!data.tokens.isEmpty());\r\n                removeFn = undefined;\r\n            }\r\n        };\r\n    }\r\n    cancel(editor) {\r\n        const data = this._tokens.get(editor);\r\n        if (!data) {\r\n            return;\r\n        }\r\n        // remove with cancellation\r\n        const cts = data.tokens.pop();\r\n        if (cts) {\r\n            cts.cancel();\r\n            data.key.set(!data.tokens.isEmpty());\r\n        }\r\n    }\r\n}, true);\r\nexport class EditorKeybindingCancellationTokenSource extends CancellationTokenSource {\r\n    constructor(editor, parent) {\r\n        super(parent);\r\n        this.editor = editor;\r\n        this._unregister = editor.invokeWithinContext(accessor => accessor.get(IEditorCancellationTokens).add(editor, this));\r\n    }\r\n    dispose() {\r\n        this._unregister();\r\n        super.dispose();\r\n    }\r\n}\r\nregisterEditorCommand(new class extends EditorCommand {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.cancelOperation',\r\n            kbOpts: {\r\n                weight: 100 /* EditorContrib */,\r\n                primary: 9 /* Escape */\r\n            },\r\n            precondition: ctxCancellableOperation\r\n        });\r\n    }\r\n    runEditorCommand(accessor, editor) {\r\n        accessor.get(IEditorCancellationTokens).cancel(editor);\r\n    }\r\n});\r\n"]},"metadata":{},"sourceType":"module"}