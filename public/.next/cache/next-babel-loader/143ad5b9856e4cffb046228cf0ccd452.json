{"ast":null,"code":"import _get from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/get\";\nimport _classCallCheck from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) {\n    if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  }\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n\nimport * as aria from '../../../base/browser/ui/aria/aria.js';\nimport { Disposable, toDisposable, DisposableStore } from '../../../base/common/lifecycle.js';\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\nimport { CodeEditorWidget } from '../../browser/widget/codeEditorWidget.js';\nimport { DiffEditorWidget } from '../../browser/widget/diffEditorWidget.js';\nimport { InternalEditorAction } from '../../common/editorAction.js';\nimport { IEditorWorkerService } from '../../common/services/editorWorkerService.js';\nimport { StandaloneKeybindingService, updateConfigurationService } from './simpleServices.js';\nimport { IStandaloneThemeService } from '../common/standaloneThemeService.js';\nimport { MenuId, MenuRegistry } from '../../../platform/actions/common/actions.js';\nimport { CommandsRegistry, ICommandService } from '../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../platform/configuration/common/configuration.js';\nimport { ContextKeyExpr, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\nimport { IContextViewService, IContextMenuService } from '../../../platform/contextview/browser/contextView.js';\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\nimport { IAccessibilityService } from '../../../platform/accessibility/common/accessibility.js';\nimport { StandaloneCodeEditorNLS } from '../../common/standaloneStrings.js';\nimport { IClipboardService } from '../../../platform/clipboard/common/clipboardService.js';\nimport { IEditorProgressService } from '../../../platform/progress/common/progress.js';\nimport { IModelService } from '../../common/services/modelService.js';\nimport { IModeService } from '../../common/services/modeService.js';\nvar LAST_GENERATED_COMMAND_ID = 0;\nvar ariaDomNodeCreated = false;\n\nfunction createAriaDomNode() {\n  if (ariaDomNodeCreated) {\n    return;\n  }\n\n  ariaDomNodeCreated = true;\n  aria.setARIAContainer(document.body);\n}\n/**\r\n * A code editor to be used both by the standalone editor and the standalone diff editor.\r\n */\n\n\nvar StandaloneCodeEditor = /*#__PURE__*/function (_CodeEditorWidget) {\n  _inherits(StandaloneCodeEditor, _CodeEditorWidget);\n\n  var _super = _createSuper(StandaloneCodeEditor);\n\n  function StandaloneCodeEditor(domElement, _options, instantiationService, codeEditorService, commandService, contextKeyService, keybindingService, themeService, notificationService, accessibilityService) {\n    var _this;\n\n    _classCallCheck(this, StandaloneCodeEditor);\n\n    var options = Object.assign({}, _options);\n    options.ariaLabel = options.ariaLabel || StandaloneCodeEditorNLS.editorViewAccessibleLabel;\n    options.ariaLabel = options.ariaLabel + ';' + StandaloneCodeEditorNLS.accessibilityHelpMessage;\n    _this = _super.call(this, domElement, options, {}, instantiationService, codeEditorService, commandService, contextKeyService, themeService, notificationService, accessibilityService);\n\n    if (keybindingService instanceof StandaloneKeybindingService) {\n      _this._standaloneKeybindingService = keybindingService;\n    } else {\n      _this._standaloneKeybindingService = null;\n    } // Create the ARIA dom node as soon as the first editor is instantiated\n\n\n    createAriaDomNode();\n    return _this;\n  }\n\n  _createClass(StandaloneCodeEditor, [{\n    key: \"addCommand\",\n    value: function addCommand(keybinding, handler, context) {\n      if (!this._standaloneKeybindingService) {\n        console.warn('Cannot add command because the editor is configured with an unrecognized KeybindingService');\n        return null;\n      }\n\n      var commandId = 'DYNAMIC_' + ++LAST_GENERATED_COMMAND_ID;\n      var whenExpression = ContextKeyExpr.deserialize(context);\n\n      this._standaloneKeybindingService.addDynamicKeybinding(commandId, keybinding, handler, whenExpression);\n\n      return commandId;\n    }\n  }, {\n    key: \"createContextKey\",\n    value: function createContextKey(key, defaultValue) {\n      return this._contextKeyService.createKey(key, defaultValue);\n    }\n  }, {\n    key: \"addAction\",\n    value: function addAction(_descriptor) {\n      var _this2 = this;\n\n      if (typeof _descriptor.id !== 'string' || typeof _descriptor.label !== 'string' || typeof _descriptor.run !== 'function') {\n        throw new Error('Invalid action descriptor, `id`, `label` and `run` are required properties!');\n      }\n\n      if (!this._standaloneKeybindingService) {\n        console.warn('Cannot add keybinding because the editor is configured with an unrecognized KeybindingService');\n        return Disposable.None;\n      } // Read descriptor options\n\n\n      var id = _descriptor.id;\n      var label = _descriptor.label;\n      var precondition = ContextKeyExpr.and(ContextKeyExpr.equals('editorId', this.getId()), ContextKeyExpr.deserialize(_descriptor.precondition));\n      var keybindings = _descriptor.keybindings;\n      var keybindingsWhen = ContextKeyExpr.and(precondition, ContextKeyExpr.deserialize(_descriptor.keybindingContext));\n      var contextMenuGroupId = _descriptor.contextMenuGroupId || null;\n      var contextMenuOrder = _descriptor.contextMenuOrder || 0;\n\n      var run = function run(accessor) {\n        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          args[_key - 1] = arguments[_key];\n        }\n\n        return Promise.resolve(_descriptor.run.apply(_descriptor, [_this2].concat(args)));\n      };\n\n      var toDispose = new DisposableStore(); // Generate a unique id to allow the same descriptor.id across multiple editor instances\n\n      var uniqueId = this.getId() + ':' + id; // Register the command\n\n      toDispose.add(CommandsRegistry.registerCommand(uniqueId, run)); // Register the context menu item\n\n      if (contextMenuGroupId) {\n        var menuItem = {\n          command: {\n            id: uniqueId,\n            title: label\n          },\n          when: precondition,\n          group: contextMenuGroupId,\n          order: contextMenuOrder\n        };\n        toDispose.add(MenuRegistry.appendMenuItem(MenuId.EditorContext, menuItem));\n      } // Register the keybindings\n\n\n      if (Array.isArray(keybindings)) {\n        var _iterator = _createForOfIteratorHelper(keybindings),\n            _step;\n\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var kb = _step.value;\n            toDispose.add(this._standaloneKeybindingService.addDynamicKeybinding(uniqueId, kb, run, keybindingsWhen));\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n      } // Finally, register an internal editor action\n\n\n      var internalAction = new InternalEditorAction(uniqueId, label, label, precondition, run, this._contextKeyService); // Store it under the original id, such that trigger with the original id will work\n\n      this._actions[id] = internalAction;\n      toDispose.add(toDisposable(function () {\n        delete _this2._actions[id];\n      }));\n      return toDispose;\n    }\n  }]);\n\n  return StandaloneCodeEditor;\n}(CodeEditorWidget);\n\nStandaloneCodeEditor = __decorate([__param(2, IInstantiationService), __param(3, ICodeEditorService), __param(4, ICommandService), __param(5, IContextKeyService), __param(6, IKeybindingService), __param(7, IThemeService), __param(8, INotificationService), __param(9, IAccessibilityService)], StandaloneCodeEditor);\nexport { StandaloneCodeEditor };\n\nvar StandaloneEditor = /*#__PURE__*/function (_StandaloneCodeEditor) {\n  _inherits(StandaloneEditor, _StandaloneCodeEditor);\n\n  var _super2 = _createSuper(StandaloneEditor);\n\n  function StandaloneEditor(domElement, _options, toDispose, instantiationService, codeEditorService, commandService, contextKeyService, keybindingService, contextViewService, themeService, notificationService, configurationService, accessibilityService, modelService, modeService) {\n    var _this3;\n\n    _classCallCheck(this, StandaloneEditor);\n\n    var options = Object.assign({}, _options);\n    updateConfigurationService(configurationService, options, false);\n    var themeDomRegistration = themeService.registerEditorContainer(domElement);\n\n    if (typeof options.theme === 'string') {\n      themeService.setTheme(options.theme);\n    }\n\n    var _model = options.model;\n    delete options.model;\n    _this3 = _super2.call(this, domElement, options, instantiationService, codeEditorService, commandService, contextKeyService, keybindingService, themeService, notificationService, accessibilityService);\n    _this3._contextViewService = contextViewService;\n    _this3._configurationService = configurationService;\n    _this3._standaloneThemeService = themeService;\n\n    _this3._register(toDispose);\n\n    _this3._register(themeDomRegistration);\n\n    var model;\n\n    if (typeof _model === 'undefined') {\n      model = createTextModel(modelService, modeService, options.value || '', options.language || 'text/plain', undefined);\n      _this3._ownsModel = true;\n    } else {\n      model = _model;\n      _this3._ownsModel = false;\n    }\n\n    _this3._attachModel(model);\n\n    if (model) {\n      var e = {\n        oldModelUrl: null,\n        newModelUrl: model.uri\n      };\n\n      _this3._onDidChangeModel.fire(e);\n    }\n\n    return _this3;\n  }\n\n  _createClass(StandaloneEditor, [{\n    key: \"dispose\",\n    value: function dispose() {\n      _get(_getPrototypeOf(StandaloneEditor.prototype), \"dispose\", this).call(this);\n    }\n  }, {\n    key: \"updateOptions\",\n    value: function updateOptions(newOptions) {\n      updateConfigurationService(this._configurationService, newOptions, false);\n\n      if (typeof newOptions.theme === 'string') {\n        this._standaloneThemeService.setTheme(newOptions.theme);\n      }\n\n      _get(_getPrototypeOf(StandaloneEditor.prototype), \"updateOptions\", this).call(this, newOptions);\n    }\n  }, {\n    key: \"_attachModel\",\n    value: function _attachModel(model) {\n      _get(_getPrototypeOf(StandaloneEditor.prototype), \"_attachModel\", this).call(this, model);\n\n      if (this._modelData) {\n        this._contextViewService.setContainer(this._modelData.view.domNode.domNode);\n      }\n    }\n  }, {\n    key: \"_postDetachModelCleanup\",\n    value: function _postDetachModelCleanup(detachedModel) {\n      _get(_getPrototypeOf(StandaloneEditor.prototype), \"_postDetachModelCleanup\", this).call(this, detachedModel);\n\n      if (detachedModel && this._ownsModel) {\n        detachedModel.dispose();\n        this._ownsModel = false;\n      }\n    }\n  }]);\n\n  return StandaloneEditor;\n}(StandaloneCodeEditor);\n\nStandaloneEditor = __decorate([__param(3, IInstantiationService), __param(4, ICodeEditorService), __param(5, ICommandService), __param(6, IContextKeyService), __param(7, IKeybindingService), __param(8, IContextViewService), __param(9, IStandaloneThemeService), __param(10, INotificationService), __param(11, IConfigurationService), __param(12, IAccessibilityService), __param(13, IModelService), __param(14, IModeService)], StandaloneEditor);\nexport { StandaloneEditor };\n\nvar StandaloneDiffEditor = /*#__PURE__*/function (_DiffEditorWidget) {\n  _inherits(StandaloneDiffEditor, _DiffEditorWidget);\n\n  var _super3 = _createSuper(StandaloneDiffEditor);\n\n  function StandaloneDiffEditor(domElement, _options, toDispose, instantiationService, contextKeyService, keybindingService, contextViewService, editorWorkerService, codeEditorService, themeService, notificationService, configurationService, contextMenuService, editorProgressService, clipboardService) {\n    var _this4;\n\n    _classCallCheck(this, StandaloneDiffEditor);\n\n    var options = Object.assign({}, _options);\n    updateConfigurationService(configurationService, options, true);\n    var themeDomRegistration = themeService.registerEditorContainer(domElement);\n\n    if (typeof options.theme === 'string') {\n      options.theme = themeService.setTheme(options.theme);\n    }\n\n    _this4 = _super3.call(this, domElement, options, {}, clipboardService, editorWorkerService, contextKeyService, instantiationService, codeEditorService, themeService, notificationService, contextMenuService, editorProgressService);\n    _this4._contextViewService = contextViewService;\n    _this4._configurationService = configurationService;\n    _this4._standaloneThemeService = themeService;\n\n    _this4._register(toDispose);\n\n    _this4._register(themeDomRegistration);\n\n    _this4._contextViewService.setContainer(_this4._containerDomElement);\n\n    return _this4;\n  }\n\n  _createClass(StandaloneDiffEditor, [{\n    key: \"dispose\",\n    value: function dispose() {\n      _get(_getPrototypeOf(StandaloneDiffEditor.prototype), \"dispose\", this).call(this);\n    }\n  }, {\n    key: \"updateOptions\",\n    value: function updateOptions(newOptions) {\n      updateConfigurationService(this._configurationService, newOptions, true);\n\n      if (typeof newOptions.theme === 'string') {\n        this._standaloneThemeService.setTheme(newOptions.theme);\n      }\n\n      _get(_getPrototypeOf(StandaloneDiffEditor.prototype), \"updateOptions\", this).call(this, newOptions);\n    }\n  }, {\n    key: \"_createInnerEditor\",\n    value: function _createInnerEditor(instantiationService, container, options) {\n      return instantiationService.createInstance(StandaloneCodeEditor, container, options);\n    }\n  }, {\n    key: \"getOriginalEditor\",\n    value: function getOriginalEditor() {\n      return _get(_getPrototypeOf(StandaloneDiffEditor.prototype), \"getOriginalEditor\", this).call(this);\n    }\n  }, {\n    key: \"getModifiedEditor\",\n    value: function getModifiedEditor() {\n      return _get(_getPrototypeOf(StandaloneDiffEditor.prototype), \"getModifiedEditor\", this).call(this);\n    }\n  }, {\n    key: \"addCommand\",\n    value: function addCommand(keybinding, handler, context) {\n      return this.getModifiedEditor().addCommand(keybinding, handler, context);\n    }\n  }, {\n    key: \"createContextKey\",\n    value: function createContextKey(key, defaultValue) {\n      return this.getModifiedEditor().createContextKey(key, defaultValue);\n    }\n  }, {\n    key: \"addAction\",\n    value: function addAction(descriptor) {\n      return this.getModifiedEditor().addAction(descriptor);\n    }\n  }]);\n\n  return StandaloneDiffEditor;\n}(DiffEditorWidget);\n\nStandaloneDiffEditor = __decorate([__param(3, IInstantiationService), __param(4, IContextKeyService), __param(5, IKeybindingService), __param(6, IContextViewService), __param(7, IEditorWorkerService), __param(8, ICodeEditorService), __param(9, IStandaloneThemeService), __param(10, INotificationService), __param(11, IConfigurationService), __param(12, IContextMenuService), __param(13, IEditorProgressService), __param(14, IClipboardService)], StandaloneDiffEditor);\nexport { StandaloneDiffEditor };\n/**\r\n * @internal\r\n */\n\nexport function createTextModel(modelService, modeService, value, language, uri) {\n  value = value || '';\n\n  if (!language) {\n    var firstLF = value.indexOf('\\n');\n    var firstLine = value;\n\n    if (firstLF !== -1) {\n      firstLine = value.substring(0, firstLF);\n    }\n\n    return doCreateModel(modelService, value, modeService.createByFilepathOrFirstLine(uri || null, firstLine), uri);\n  }\n\n  return doCreateModel(modelService, value, modeService.create(language), uri);\n}\n/**\r\n * @internal\r\n */\n\nfunction doCreateModel(modelService, value, languageSelection, uri) {\n  return modelService.createModel(value, languageSelection, uri);\n}","map":{"version":3,"sources":["/home/bar007/Desktop/projects/tio/client/node_modules/monaco-editor/esm/vs/editor/standalone/browser/standaloneCodeEditor.js"],"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","aria","Disposable","toDisposable","DisposableStore","ICodeEditorService","CodeEditorWidget","DiffEditorWidget","InternalEditorAction","IEditorWorkerService","StandaloneKeybindingService","updateConfigurationService","IStandaloneThemeService","MenuId","MenuRegistry","CommandsRegistry","ICommandService","IConfigurationService","ContextKeyExpr","IContextKeyService","IContextViewService","IContextMenuService","IInstantiationService","IKeybindingService","INotificationService","IThemeService","IAccessibilityService","StandaloneCodeEditorNLS","IClipboardService","IEditorProgressService","IModelService","IModeService","LAST_GENERATED_COMMAND_ID","ariaDomNodeCreated","createAriaDomNode","setARIAContainer","document","body","StandaloneCodeEditor","domElement","_options","instantiationService","codeEditorService","commandService","contextKeyService","keybindingService","themeService","notificationService","accessibilityService","options","assign","ariaLabel","editorViewAccessibleLabel","accessibilityHelpMessage","_standaloneKeybindingService","keybinding","handler","context","console","warn","commandId","whenExpression","deserialize","addDynamicKeybinding","defaultValue","_contextKeyService","createKey","_descriptor","id","label","run","Error","None","precondition","and","equals","getId","keybindings","keybindingsWhen","keybindingContext","contextMenuGroupId","contextMenuOrder","accessor","args","Promise","resolve","toDispose","uniqueId","add","registerCommand","menuItem","command","title","when","group","order","appendMenuItem","EditorContext","Array","isArray","kb","internalAction","_actions","StandaloneEditor","contextViewService","configurationService","modelService","modeService","themeDomRegistration","registerEditorContainer","theme","setTheme","_model","model","_contextViewService","_configurationService","_standaloneThemeService","_register","createTextModel","value","language","undefined","_ownsModel","_attachModel","e","oldModelUrl","newModelUrl","uri","_onDidChangeModel","fire","newOptions","_modelData","setContainer","view","domNode","detachedModel","dispose","StandaloneDiffEditor","editorWorkerService","contextMenuService","editorProgressService","clipboardService","_containerDomElement","container","createInstance","getModifiedEditor","addCommand","createContextKey","descriptor","addAction","firstLF","indexOf","firstLine","substring","doCreateModel","createByFilepathOrFirstLine","create","languageSelection","createModel"],"mappings":";;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA,IAAIA,UAAU,GAAI,QAAQ,KAAKA,UAAd,IAA6B,UAAUC,UAAV,EAAsBC,MAAtB,EAA8BC,GAA9B,EAAmCC,IAAnC,EAAyC;AACnF,MAAIC,CAAC,GAAGC,SAAS,CAACC,MAAlB;AAAA,MAA0BC,CAAC,GAAGH,CAAC,GAAG,CAAJ,GAAQH,MAAR,GAAiBE,IAAI,KAAK,IAAT,GAAgBA,IAAI,GAAGK,MAAM,CAACC,wBAAP,CAAgCR,MAAhC,EAAwCC,GAAxC,CAAvB,GAAsEC,IAArH;AAAA,MAA2HO,CAA3H;AACA,MAAI,OAAOC,OAAP,KAAmB,QAAnB,IAA+B,OAAOA,OAAO,CAACC,QAAf,KAA4B,UAA/D,EAA2EL,CAAC,GAAGI,OAAO,CAACC,QAAR,CAAiBZ,UAAjB,EAA6BC,MAA7B,EAAqCC,GAArC,EAA0CC,IAA1C,CAAJ,CAA3E,KACK,KAAK,IAAIU,CAAC,GAAGb,UAAU,CAACM,MAAX,GAAoB,CAAjC,EAAoCO,CAAC,IAAI,CAAzC,EAA4CA,CAAC,EAA7C;AAAiD,QAAIH,CAAC,GAAGV,UAAU,CAACa,CAAD,CAAlB,EAAuBN,CAAC,GAAG,CAACH,CAAC,GAAG,CAAJ,GAAQM,CAAC,CAACH,CAAD,CAAT,GAAeH,CAAC,GAAG,CAAJ,GAAQM,CAAC,CAACT,MAAD,EAASC,GAAT,EAAcK,CAAd,CAAT,GAA4BG,CAAC,CAACT,MAAD,EAASC,GAAT,CAA7C,KAA+DK,CAAnE;AAAxE;AACL,SAAOH,CAAC,GAAG,CAAJ,IAASG,CAAT,IAAcC,MAAM,CAACM,cAAP,CAAsBb,MAAtB,EAA8BC,GAA9B,EAAmCK,CAAnC,CAAd,EAAqDA,CAA5D;AACH,CALD;;AAMA,IAAIQ,OAAO,GAAI,QAAQ,KAAKA,OAAd,IAA0B,UAAUC,UAAV,EAAsBC,SAAtB,EAAiC;AACrE,SAAO,UAAUhB,MAAV,EAAkBC,GAAlB,EAAuB;AAAEe,IAAAA,SAAS,CAAChB,MAAD,EAASC,GAAT,EAAcc,UAAd,CAAT;AAAqC,GAArE;AACH,CAFD;;AAGA,OAAO,KAAKE,IAAZ,MAAsB,uCAAtB;AACA,SAASC,UAAT,EAAqBC,YAArB,EAAmCC,eAAnC,QAA0D,mCAA1D;AACA,SAASC,kBAAT,QAAmC,6CAAnC;AACA,SAASC,gBAAT,QAAiC,0CAAjC;AACA,SAASC,gBAAT,QAAiC,0CAAjC;AACA,SAASC,oBAAT,QAAqC,8BAArC;AACA,SAASC,oBAAT,QAAqC,8CAArC;AACA,SAASC,2BAAT,EAAsCC,0BAAtC,QAAwE,qBAAxE;AACA,SAASC,uBAAT,QAAwC,qCAAxC;AACA,SAASC,MAAT,EAAiBC,YAAjB,QAAqC,6CAArC;AACA,SAASC,gBAAT,EAA2BC,eAA3B,QAAkD,+CAAlD;AACA,SAASC,qBAAT,QAAsC,yDAAtC;AACA,SAASC,cAAT,EAAyBC,kBAAzB,QAAmD,mDAAnD;AACA,SAASC,mBAAT,EAA8BC,mBAA9B,QAAyD,sDAAzD;AACA,SAASC,qBAAT,QAAsC,yDAAtC;AACA,SAASC,kBAAT,QAAmC,mDAAnC;AACA,SAASC,oBAAT,QAAqC,uDAArC;AACA,SAASC,aAAT,QAA8B,gDAA9B;AACA,SAASC,qBAAT,QAAsC,yDAAtC;AACA,SAASC,uBAAT,QAAwC,mCAAxC;AACA,SAASC,iBAAT,QAAkC,wDAAlC;AACA,SAASC,sBAAT,QAAuC,+CAAvC;AACA,SAASC,aAAT,QAA8B,uCAA9B;AACA,SAASC,YAAT,QAA6B,sCAA7B;AACA,IAAIC,yBAAyB,GAAG,CAAhC;AACA,IAAIC,kBAAkB,GAAG,KAAzB;;AACA,SAASC,iBAAT,GAA6B;AACzB,MAAID,kBAAJ,EAAwB;AACpB;AACH;;AACDA,EAAAA,kBAAkB,GAAG,IAArB;AACAhC,EAAAA,IAAI,CAACkC,gBAAL,CAAsBC,QAAQ,CAACC,IAA/B;AACH;AACD;AACA;AACA;;;AACA,IAAIC,oBAAoB;AAAA;;AAAA;;AACpB,gCAAYC,UAAZ,EAAwBC,QAAxB,EAAkCC,oBAAlC,EAAwDC,iBAAxD,EAA2EC,cAA3E,EAA2FC,iBAA3F,EAA8GC,iBAA9G,EAAiIC,YAAjI,EAA+IC,mBAA/I,EAAoKC,oBAApK,EAA0L;AAAA;;AAAA;;AACtL,QAAMC,OAAO,GAAG1D,MAAM,CAAC2D,MAAP,CAAc,EAAd,EAAkBV,QAAlB,CAAhB;AACAS,IAAAA,OAAO,CAACE,SAAR,GAAoBF,OAAO,CAACE,SAAR,IAAqBxB,uBAAuB,CAACyB,yBAAjE;AACAH,IAAAA,OAAO,CAACE,SAAR,GAAoBF,OAAO,CAACE,SAAR,GAAoB,GAApB,GAA2BxB,uBAAuB,CAAC0B,wBAAvE;AACA,8BAAMd,UAAN,EAAkBU,OAAlB,EAA2B,EAA3B,EAA+BR,oBAA/B,EAAqDC,iBAArD,EAAwEC,cAAxE,EAAwFC,iBAAxF,EAA2GE,YAA3G,EAAyHC,mBAAzH,EAA8IC,oBAA9I;;AACA,QAAIH,iBAAiB,YAAYnC,2BAAjC,EAA8D;AAC1D,YAAK4C,4BAAL,GAAoCT,iBAApC;AACH,KAFD,MAGK;AACD,YAAKS,4BAAL,GAAoC,IAApC;AACH,KAVqL,CAWtL;;;AACApB,IAAAA,iBAAiB;AAZqK;AAazL;;AAdmB;AAAA;AAAA,+BAeTqB,UAfS,EAeGC,OAfH,EAeYC,OAfZ,EAeqB;AACrC,UAAI,CAAC,KAAKH,4BAAV,EAAwC;AACpCI,QAAAA,OAAO,CAACC,IAAR,CAAa,4FAAb;AACA,eAAO,IAAP;AACH;;AACD,UAAIC,SAAS,GAAG,aAAc,EAAE5B,yBAAhC;AACA,UAAI6B,cAAc,GAAG3C,cAAc,CAAC4C,WAAf,CAA2BL,OAA3B,CAArB;;AACA,WAAKH,4BAAL,CAAkCS,oBAAlC,CAAuDH,SAAvD,EAAkEL,UAAlE,EAA8EC,OAA9E,EAAuFK,cAAvF;;AACA,aAAOD,SAAP;AACH;AAxBmB;AAAA;AAAA,qCAyBH3E,GAzBG,EAyBE+E,YAzBF,EAyBgB;AAChC,aAAO,KAAKC,kBAAL,CAAwBC,SAAxB,CAAkCjF,GAAlC,EAAuC+E,YAAvC,CAAP;AACH;AA3BmB;AAAA;AAAA,8BA4BVG,WA5BU,EA4BG;AAAA;;AACnB,UAAK,OAAOA,WAAW,CAACC,EAAnB,KAA0B,QAA3B,IAAyC,OAAOD,WAAW,CAACE,KAAnB,KAA6B,QAAtE,IAAoF,OAAOF,WAAW,CAACG,GAAnB,KAA2B,UAAnH,EAAgI;AAC5H,cAAM,IAAIC,KAAJ,CAAU,6EAAV,CAAN;AACH;;AACD,UAAI,CAAC,KAAKjB,4BAAV,EAAwC;AACpCI,QAAAA,OAAO,CAACC,IAAR,CAAa,+FAAb;AACA,eAAOzD,UAAU,CAACsE,IAAlB;AACH,OAPkB,CAQnB;;;AACA,UAAMJ,EAAE,GAAGD,WAAW,CAACC,EAAvB;AACA,UAAMC,KAAK,GAAGF,WAAW,CAACE,KAA1B;AACA,UAAMI,YAAY,GAAGvD,cAAc,CAACwD,GAAf,CAAmBxD,cAAc,CAACyD,MAAf,CAAsB,UAAtB,EAAkC,KAAKC,KAAL,EAAlC,CAAnB,EAAoE1D,cAAc,CAAC4C,WAAf,CAA2BK,WAAW,CAACM,YAAvC,CAApE,CAArB;AACA,UAAMI,WAAW,GAAGV,WAAW,CAACU,WAAhC;AACA,UAAMC,eAAe,GAAG5D,cAAc,CAACwD,GAAf,CAAmBD,YAAnB,EAAiCvD,cAAc,CAAC4C,WAAf,CAA2BK,WAAW,CAACY,iBAAvC,CAAjC,CAAxB;AACA,UAAMC,kBAAkB,GAAGb,WAAW,CAACa,kBAAZ,IAAkC,IAA7D;AACA,UAAMC,gBAAgB,GAAGd,WAAW,CAACc,gBAAZ,IAAgC,CAAzD;;AACA,UAAMX,GAAG,GAAG,SAANA,GAAM,CAACY,QAAD,EAAuB;AAAA,0CAATC,IAAS;AAATA,UAAAA,IAAS;AAAA;;AAC/B,eAAOC,OAAO,CAACC,OAAR,CAAgBlB,WAAW,CAACG,GAAZ,OAAAH,WAAW,GAAK,MAAL,SAAcgB,IAAd,EAA3B,CAAP;AACH,OAFD;;AAGA,UAAMG,SAAS,GAAG,IAAIlF,eAAJ,EAAlB,CAnBmB,CAoBnB;;AACA,UAAMmF,QAAQ,GAAG,KAAKX,KAAL,KAAe,GAAf,GAAqBR,EAAtC,CArBmB,CAsBnB;;AACAkB,MAAAA,SAAS,CAACE,GAAV,CAAczE,gBAAgB,CAAC0E,eAAjB,CAAiCF,QAAjC,EAA2CjB,GAA3C,CAAd,EAvBmB,CAwBnB;;AACA,UAAIU,kBAAJ,EAAwB;AACpB,YAAIU,QAAQ,GAAG;AACXC,UAAAA,OAAO,EAAE;AACLvB,YAAAA,EAAE,EAAEmB,QADC;AAELK,YAAAA,KAAK,EAAEvB;AAFF,WADE;AAKXwB,UAAAA,IAAI,EAAEpB,YALK;AAMXqB,UAAAA,KAAK,EAAEd,kBANI;AAOXe,UAAAA,KAAK,EAAEd;AAPI,SAAf;AASAK,QAAAA,SAAS,CAACE,GAAV,CAAc1E,YAAY,CAACkF,cAAb,CAA4BnF,MAAM,CAACoF,aAAnC,EAAkDP,QAAlD,CAAd;AACH,OApCkB,CAqCnB;;;AACA,UAAIQ,KAAK,CAACC,OAAN,CAActB,WAAd,CAAJ,EAAgC;AAAA,mDACXA,WADW;AAAA;;AAAA;AAC5B,8DAA8B;AAAA,gBAAnBuB,EAAmB;AAC1Bd,YAAAA,SAAS,CAACE,GAAV,CAAc,KAAKlC,4BAAL,CAAkCS,oBAAlC,CAAuDwB,QAAvD,EAAiEa,EAAjE,EAAqE9B,GAArE,EAA0EQ,eAA1E,CAAd;AACH;AAH2B;AAAA;AAAA;AAAA;AAAA;AAI/B,OA1CkB,CA2CnB;;;AACA,UAAIuB,cAAc,GAAG,IAAI7F,oBAAJ,CAAyB+E,QAAzB,EAAmClB,KAAnC,EAA0CA,KAA1C,EAAiDI,YAAjD,EAA+DH,GAA/D,EAAoE,KAAKL,kBAAzE,CAArB,CA5CmB,CA6CnB;;AACA,WAAKqC,QAAL,CAAclC,EAAd,IAAoBiC,cAApB;AACAf,MAAAA,SAAS,CAACE,GAAV,CAAcrF,YAAY,CAAC,YAAM;AAC7B,eAAO,MAAI,CAACmG,QAAL,CAAclC,EAAd,CAAP;AACH,OAFyB,CAA1B;AAGA,aAAOkB,SAAP;AACH;AA/EmB;;AAAA;AAAA,EAAsChF,gBAAtC,CAAxB;;AAiFAgC,oBAAoB,GAAGxD,UAAU,CAAC,CAC9BgB,OAAO,CAAC,CAAD,EAAIwB,qBAAJ,CADuB,EAE9BxB,OAAO,CAAC,CAAD,EAAIO,kBAAJ,CAFuB,EAG9BP,OAAO,CAAC,CAAD,EAAIkB,eAAJ,CAHuB,EAI9BlB,OAAO,CAAC,CAAD,EAAIqB,kBAAJ,CAJuB,EAK9BrB,OAAO,CAAC,CAAD,EAAIyB,kBAAJ,CALuB,EAM9BzB,OAAO,CAAC,CAAD,EAAI2B,aAAJ,CANuB,EAO9B3B,OAAO,CAAC,CAAD,EAAI0B,oBAAJ,CAPuB,EAQ9B1B,OAAO,CAAC,CAAD,EAAI4B,qBAAJ,CARuB,CAAD,EAS9BY,oBAT8B,CAAjC;AAUA,SAASA,oBAAT;;AACA,IAAIiE,gBAAgB;AAAA;;AAAA;;AAChB,4BAAYhE,UAAZ,EAAwBC,QAAxB,EAAkC8C,SAAlC,EAA6C7C,oBAA7C,EAAmEC,iBAAnE,EAAsFC,cAAtF,EAAsGC,iBAAtG,EAAyHC,iBAAzH,EAA4I2D,kBAA5I,EAAgK1D,YAAhK,EAA8KC,mBAA9K,EAAmM0D,oBAAnM,EAAyNzD,oBAAzN,EAA+O0D,YAA/O,EAA6PC,WAA7P,EAA0Q;AAAA;;AAAA;;AACtQ,QAAM1D,OAAO,GAAG1D,MAAM,CAAC2D,MAAP,CAAc,EAAd,EAAkBV,QAAlB,CAAhB;AACA7B,IAAAA,0BAA0B,CAAC8F,oBAAD,EAAuBxD,OAAvB,EAAgC,KAAhC,CAA1B;AACA,QAAM2D,oBAAoB,GAAG9D,YAAY,CAAC+D,uBAAb,CAAqCtE,UAArC,CAA7B;;AACA,QAAI,OAAOU,OAAO,CAAC6D,KAAf,KAAyB,QAA7B,EAAuC;AACnChE,MAAAA,YAAY,CAACiE,QAAb,CAAsB9D,OAAO,CAAC6D,KAA9B;AACH;;AACD,QAAIE,MAAM,GAAG/D,OAAO,CAACgE,KAArB;AACA,WAAOhE,OAAO,CAACgE,KAAf;AACA,gCAAM1E,UAAN,EAAkBU,OAAlB,EAA2BR,oBAA3B,EAAiDC,iBAAjD,EAAoEC,cAApE,EAAoFC,iBAApF,EAAuGC,iBAAvG,EAA0HC,YAA1H,EAAwIC,mBAAxI,EAA6JC,oBAA7J;AACA,WAAKkE,mBAAL,GAA2BV,kBAA3B;AACA,WAAKW,qBAAL,GAA6BV,oBAA7B;AACA,WAAKW,uBAAL,GAA+BtE,YAA/B;;AACA,WAAKuE,SAAL,CAAe/B,SAAf;;AACA,WAAK+B,SAAL,CAAeT,oBAAf;;AACA,QAAIK,KAAJ;;AACA,QAAI,OAAOD,MAAP,KAAkB,WAAtB,EAAmC;AAC/BC,MAAAA,KAAK,GAAGK,eAAe,CAACZ,YAAD,EAAeC,WAAf,EAA4B1D,OAAO,CAACsE,KAAR,IAAiB,EAA7C,EAAiDtE,OAAO,CAACuE,QAAR,IAAoB,YAArE,EAAmFC,SAAnF,CAAvB;AACA,aAAKC,UAAL,GAAkB,IAAlB;AACH,KAHD,MAIK;AACDT,MAAAA,KAAK,GAAGD,MAAR;AACA,aAAKU,UAAL,GAAkB,KAAlB;AACH;;AACD,WAAKC,YAAL,CAAkBV,KAAlB;;AACA,QAAIA,KAAJ,EAAW;AACP,UAAIW,CAAC,GAAG;AACJC,QAAAA,WAAW,EAAE,IADT;AAEJC,QAAAA,WAAW,EAAEb,KAAK,CAACc;AAFf,OAAR;;AAIA,aAAKC,iBAAL,CAAuBC,IAAvB,CAA4BL,CAA5B;AACH;;AA/BqQ;AAgCzQ;;AAjCe;AAAA;AAAA,8BAkCN;AACN;AACH;AApCe;AAAA;AAAA,kCAqCFM,UArCE,EAqCU;AACtBvH,MAAAA,0BAA0B,CAAC,KAAKwG,qBAAN,EAA6Be,UAA7B,EAAyC,KAAzC,CAA1B;;AACA,UAAI,OAAOA,UAAU,CAACpB,KAAlB,KAA4B,QAAhC,EAA0C;AACtC,aAAKM,uBAAL,CAA6BL,QAA7B,CAAsCmB,UAAU,CAACpB,KAAjD;AACH;;AACD,0FAAoBoB,UAApB;AACH;AA3Ce;AAAA;AAAA,iCA4CHjB,KA5CG,EA4CI;AAChB,yFAAmBA,KAAnB;;AACA,UAAI,KAAKkB,UAAT,EAAqB;AACjB,aAAKjB,mBAAL,CAAyBkB,YAAzB,CAAsC,KAAKD,UAAL,CAAgBE,IAAhB,CAAqBC,OAArB,CAA6BA,OAAnE;AACH;AACJ;AAjDe;AAAA;AAAA,4CAkDQC,aAlDR,EAkDuB;AACnC,oGAA8BA,aAA9B;;AACA,UAAIA,aAAa,IAAI,KAAKb,UAA1B,EAAsC;AAClCa,QAAAA,aAAa,CAACC,OAAd;AACA,aAAKd,UAAL,GAAkB,KAAlB;AACH;AACJ;AAxDe;;AAAA;AAAA,EAAkCpF,oBAAlC,CAApB;;AA0DAiE,gBAAgB,GAAGzH,UAAU,CAAC,CAC1BgB,OAAO,CAAC,CAAD,EAAIwB,qBAAJ,CADmB,EAE1BxB,OAAO,CAAC,CAAD,EAAIO,kBAAJ,CAFmB,EAG1BP,OAAO,CAAC,CAAD,EAAIkB,eAAJ,CAHmB,EAI1BlB,OAAO,CAAC,CAAD,EAAIqB,kBAAJ,CAJmB,EAK1BrB,OAAO,CAAC,CAAD,EAAIyB,kBAAJ,CALmB,EAM1BzB,OAAO,CAAC,CAAD,EAAIsB,mBAAJ,CANmB,EAO1BtB,OAAO,CAAC,CAAD,EAAIc,uBAAJ,CAPmB,EAQ1Bd,OAAO,CAAC,EAAD,EAAK0B,oBAAL,CARmB,EAS1B1B,OAAO,CAAC,EAAD,EAAKmB,qBAAL,CATmB,EAU1BnB,OAAO,CAAC,EAAD,EAAK4B,qBAAL,CAVmB,EAW1B5B,OAAO,CAAC,EAAD,EAAKgC,aAAL,CAXmB,EAY1BhC,OAAO,CAAC,EAAD,EAAKiC,YAAL,CAZmB,CAAD,EAa1BwE,gBAb0B,CAA7B;AAcA,SAASA,gBAAT;;AACA,IAAIkC,oBAAoB;AAAA;;AAAA;;AACpB,gCAAYlG,UAAZ,EAAwBC,QAAxB,EAAkC8C,SAAlC,EAA6C7C,oBAA7C,EAAmEG,iBAAnE,EAAsFC,iBAAtF,EAAyG2D,kBAAzG,EAA6HkC,mBAA7H,EAAkJhG,iBAAlJ,EAAqKI,YAArK,EAAmLC,mBAAnL,EAAwM0D,oBAAxM,EAA8NkC,kBAA9N,EAAkPC,qBAAlP,EAAyQC,gBAAzQ,EAA2R;AAAA;;AAAA;;AACvR,QAAM5F,OAAO,GAAG1D,MAAM,CAAC2D,MAAP,CAAc,EAAd,EAAkBV,QAAlB,CAAhB;AACA7B,IAAAA,0BAA0B,CAAC8F,oBAAD,EAAuBxD,OAAvB,EAAgC,IAAhC,CAA1B;AACA,QAAM2D,oBAAoB,GAAG9D,YAAY,CAAC+D,uBAAb,CAAqCtE,UAArC,CAA7B;;AACA,QAAI,OAAOU,OAAO,CAAC6D,KAAf,KAAyB,QAA7B,EAAuC;AACnC7D,MAAAA,OAAO,CAAC6D,KAAR,GAAgBhE,YAAY,CAACiE,QAAb,CAAsB9D,OAAO,CAAC6D,KAA9B,CAAhB;AACH;;AACD,gCAAMvE,UAAN,EAAkBU,OAAlB,EAA2B,EAA3B,EAA+B4F,gBAA/B,EAAiDH,mBAAjD,EAAsE9F,iBAAtE,EAAyFH,oBAAzF,EAA+GC,iBAA/G,EAAkII,YAAlI,EAAgJC,mBAAhJ,EAAqK4F,kBAArK,EAAyLC,qBAAzL;AACA,WAAK1B,mBAAL,GAA2BV,kBAA3B;AACA,WAAKW,qBAAL,GAA6BV,oBAA7B;AACA,WAAKW,uBAAL,GAA+BtE,YAA/B;;AACA,WAAKuE,SAAL,CAAe/B,SAAf;;AACA,WAAK+B,SAAL,CAAeT,oBAAf;;AACA,WAAKM,mBAAL,CAAyBkB,YAAzB,CAAsC,OAAKU,oBAA3C;;AAbuR;AAc1R;;AAfmB;AAAA;AAAA,8BAgBV;AACN;AACH;AAlBmB;AAAA;AAAA,kCAmBNZ,UAnBM,EAmBM;AACtBvH,MAAAA,0BAA0B,CAAC,KAAKwG,qBAAN,EAA6Be,UAA7B,EAAyC,IAAzC,CAA1B;;AACA,UAAI,OAAOA,UAAU,CAACpB,KAAlB,KAA4B,QAAhC,EAA0C;AACtC,aAAKM,uBAAL,CAA6BL,QAA7B,CAAsCmB,UAAU,CAACpB,KAAjD;AACH;;AACD,8FAAoBoB,UAApB;AACH;AAzBmB;AAAA;AAAA,uCA0BDzF,oBA1BC,EA0BqBsG,SA1BrB,EA0BgC9F,OA1BhC,EA0ByC;AACzD,aAAOR,oBAAoB,CAACuG,cAArB,CAAoC1G,oBAApC,EAA0DyG,SAA1D,EAAqE9F,OAArE,CAAP;AACH;AA5BmB;AAAA;AAAA,wCA6BA;AAChB;AACH;AA/BmB;AAAA;AAAA,wCAgCA;AAChB;AACH;AAlCmB;AAAA;AAAA,+BAmCTM,UAnCS,EAmCGC,OAnCH,EAmCYC,OAnCZ,EAmCqB;AACrC,aAAO,KAAKwF,iBAAL,GAAyBC,UAAzB,CAAoC3F,UAApC,EAAgDC,OAAhD,EAAyDC,OAAzD,CAAP;AACH;AArCmB;AAAA;AAAA,qCAsCHxE,GAtCG,EAsCE+E,YAtCF,EAsCgB;AAChC,aAAO,KAAKiF,iBAAL,GAAyBE,gBAAzB,CAA0ClK,GAA1C,EAA+C+E,YAA/C,CAAP;AACH;AAxCmB;AAAA;AAAA,8BAyCVoF,UAzCU,EAyCE;AAClB,aAAO,KAAKH,iBAAL,GAAyBI,SAAzB,CAAmCD,UAAnC,CAAP;AACH;AA3CmB;;AAAA;AAAA,EAAsC7I,gBAAtC,CAAxB;;AA6CAkI,oBAAoB,GAAG3J,UAAU,CAAC,CAC9BgB,OAAO,CAAC,CAAD,EAAIwB,qBAAJ,CADuB,EAE9BxB,OAAO,CAAC,CAAD,EAAIqB,kBAAJ,CAFuB,EAG9BrB,OAAO,CAAC,CAAD,EAAIyB,kBAAJ,CAHuB,EAI9BzB,OAAO,CAAC,CAAD,EAAIsB,mBAAJ,CAJuB,EAK9BtB,OAAO,CAAC,CAAD,EAAIW,oBAAJ,CALuB,EAM9BX,OAAO,CAAC,CAAD,EAAIO,kBAAJ,CANuB,EAO9BP,OAAO,CAAC,CAAD,EAAIc,uBAAJ,CAPuB,EAQ9Bd,OAAO,CAAC,EAAD,EAAK0B,oBAAL,CARuB,EAS9B1B,OAAO,CAAC,EAAD,EAAKmB,qBAAL,CATuB,EAU9BnB,OAAO,CAAC,EAAD,EAAKuB,mBAAL,CAVuB,EAW9BvB,OAAO,CAAC,EAAD,EAAK+B,sBAAL,CAXuB,EAY9B/B,OAAO,CAAC,EAAD,EAAK8B,iBAAL,CAZuB,CAAD,EAa9B6G,oBAb8B,CAAjC;AAcA,SAASA,oBAAT;AACA;AACA;AACA;;AACA,OAAO,SAASnB,eAAT,CAAyBZ,YAAzB,EAAuCC,WAAvC,EAAoDY,KAApD,EAA2DC,QAA3D,EAAqEO,GAArE,EAA0E;AAC7ER,EAAAA,KAAK,GAAGA,KAAK,IAAI,EAAjB;;AACA,MAAI,CAACC,QAAL,EAAe;AACX,QAAM8B,OAAO,GAAG/B,KAAK,CAACgC,OAAN,CAAc,IAAd,CAAhB;AACA,QAAIC,SAAS,GAAGjC,KAAhB;;AACA,QAAI+B,OAAO,KAAK,CAAC,CAAjB,EAAoB;AAChBE,MAAAA,SAAS,GAAGjC,KAAK,CAACkC,SAAN,CAAgB,CAAhB,EAAmBH,OAAnB,CAAZ;AACH;;AACD,WAAOI,aAAa,CAAChD,YAAD,EAAea,KAAf,EAAsBZ,WAAW,CAACgD,2BAAZ,CAAwC5B,GAAG,IAAI,IAA/C,EAAqDyB,SAArD,CAAtB,EAAuFzB,GAAvF,CAApB;AACH;;AACD,SAAO2B,aAAa,CAAChD,YAAD,EAAea,KAAf,EAAsBZ,WAAW,CAACiD,MAAZ,CAAmBpC,QAAnB,CAAtB,EAAoDO,GAApD,CAApB;AACH;AACD;AACA;AACA;;AACA,SAAS2B,aAAT,CAAuBhD,YAAvB,EAAqCa,KAArC,EAA4CsC,iBAA5C,EAA+D9B,GAA/D,EAAoE;AAChE,SAAOrB,YAAY,CAACoD,WAAb,CAAyBvC,KAAzB,EAAgCsC,iBAAhC,EAAmD9B,GAAnD,CAAP;AACH","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as aria from '../../../base/browser/ui/aria/aria.js';\r\nimport { Disposable, toDisposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { CodeEditorWidget } from '../../browser/widget/codeEditorWidget.js';\r\nimport { DiffEditorWidget } from '../../browser/widget/diffEditorWidget.js';\r\nimport { InternalEditorAction } from '../../common/editorAction.js';\r\nimport { IEditorWorkerService } from '../../common/services/editorWorkerService.js';\r\nimport { StandaloneKeybindingService, updateConfigurationService } from './simpleServices.js';\r\nimport { IStandaloneThemeService } from '../common/standaloneThemeService.js';\r\nimport { MenuId, MenuRegistry } from '../../../platform/actions/common/actions.js';\r\nimport { CommandsRegistry, ICommandService } from '../../../platform/commands/common/commands.js';\r\nimport { IConfigurationService } from '../../../platform/configuration/common/configuration.js';\r\nimport { ContextKeyExpr, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IContextViewService, IContextMenuService } from '../../../platform/contextview/browser/contextView.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\r\nimport { IAccessibilityService } from '../../../platform/accessibility/common/accessibility.js';\r\nimport { StandaloneCodeEditorNLS } from '../../common/standaloneStrings.js';\r\nimport { IClipboardService } from '../../../platform/clipboard/common/clipboardService.js';\r\nimport { IEditorProgressService } from '../../../platform/progress/common/progress.js';\r\nimport { IModelService } from '../../common/services/modelService.js';\r\nimport { IModeService } from '../../common/services/modeService.js';\r\nlet LAST_GENERATED_COMMAND_ID = 0;\r\nlet ariaDomNodeCreated = false;\r\nfunction createAriaDomNode() {\r\n    if (ariaDomNodeCreated) {\r\n        return;\r\n    }\r\n    ariaDomNodeCreated = true;\r\n    aria.setARIAContainer(document.body);\r\n}\r\n/**\r\n * A code editor to be used both by the standalone editor and the standalone diff editor.\r\n */\r\nlet StandaloneCodeEditor = class StandaloneCodeEditor extends CodeEditorWidget {\r\n    constructor(domElement, _options, instantiationService, codeEditorService, commandService, contextKeyService, keybindingService, themeService, notificationService, accessibilityService) {\r\n        const options = Object.assign({}, _options);\r\n        options.ariaLabel = options.ariaLabel || StandaloneCodeEditorNLS.editorViewAccessibleLabel;\r\n        options.ariaLabel = options.ariaLabel + ';' + (StandaloneCodeEditorNLS.accessibilityHelpMessage);\r\n        super(domElement, options, {}, instantiationService, codeEditorService, commandService, contextKeyService, themeService, notificationService, accessibilityService);\r\n        if (keybindingService instanceof StandaloneKeybindingService) {\r\n            this._standaloneKeybindingService = keybindingService;\r\n        }\r\n        else {\r\n            this._standaloneKeybindingService = null;\r\n        }\r\n        // Create the ARIA dom node as soon as the first editor is instantiated\r\n        createAriaDomNode();\r\n    }\r\n    addCommand(keybinding, handler, context) {\r\n        if (!this._standaloneKeybindingService) {\r\n            console.warn('Cannot add command because the editor is configured with an unrecognized KeybindingService');\r\n            return null;\r\n        }\r\n        let commandId = 'DYNAMIC_' + (++LAST_GENERATED_COMMAND_ID);\r\n        let whenExpression = ContextKeyExpr.deserialize(context);\r\n        this._standaloneKeybindingService.addDynamicKeybinding(commandId, keybinding, handler, whenExpression);\r\n        return commandId;\r\n    }\r\n    createContextKey(key, defaultValue) {\r\n        return this._contextKeyService.createKey(key, defaultValue);\r\n    }\r\n    addAction(_descriptor) {\r\n        if ((typeof _descriptor.id !== 'string') || (typeof _descriptor.label !== 'string') || (typeof _descriptor.run !== 'function')) {\r\n            throw new Error('Invalid action descriptor, `id`, `label` and `run` are required properties!');\r\n        }\r\n        if (!this._standaloneKeybindingService) {\r\n            console.warn('Cannot add keybinding because the editor is configured with an unrecognized KeybindingService');\r\n            return Disposable.None;\r\n        }\r\n        // Read descriptor options\r\n        const id = _descriptor.id;\r\n        const label = _descriptor.label;\r\n        const precondition = ContextKeyExpr.and(ContextKeyExpr.equals('editorId', this.getId()), ContextKeyExpr.deserialize(_descriptor.precondition));\r\n        const keybindings = _descriptor.keybindings;\r\n        const keybindingsWhen = ContextKeyExpr.and(precondition, ContextKeyExpr.deserialize(_descriptor.keybindingContext));\r\n        const contextMenuGroupId = _descriptor.contextMenuGroupId || null;\r\n        const contextMenuOrder = _descriptor.contextMenuOrder || 0;\r\n        const run = (accessor, ...args) => {\r\n            return Promise.resolve(_descriptor.run(this, ...args));\r\n        };\r\n        const toDispose = new DisposableStore();\r\n        // Generate a unique id to allow the same descriptor.id across multiple editor instances\r\n        const uniqueId = this.getId() + ':' + id;\r\n        // Register the command\r\n        toDispose.add(CommandsRegistry.registerCommand(uniqueId, run));\r\n        // Register the context menu item\r\n        if (contextMenuGroupId) {\r\n            let menuItem = {\r\n                command: {\r\n                    id: uniqueId,\r\n                    title: label\r\n                },\r\n                when: precondition,\r\n                group: contextMenuGroupId,\r\n                order: contextMenuOrder\r\n            };\r\n            toDispose.add(MenuRegistry.appendMenuItem(MenuId.EditorContext, menuItem));\r\n        }\r\n        // Register the keybindings\r\n        if (Array.isArray(keybindings)) {\r\n            for (const kb of keybindings) {\r\n                toDispose.add(this._standaloneKeybindingService.addDynamicKeybinding(uniqueId, kb, run, keybindingsWhen));\r\n            }\r\n        }\r\n        // Finally, register an internal editor action\r\n        let internalAction = new InternalEditorAction(uniqueId, label, label, precondition, run, this._contextKeyService);\r\n        // Store it under the original id, such that trigger with the original id will work\r\n        this._actions[id] = internalAction;\r\n        toDispose.add(toDisposable(() => {\r\n            delete this._actions[id];\r\n        }));\r\n        return toDispose;\r\n    }\r\n};\r\nStandaloneCodeEditor = __decorate([\r\n    __param(2, IInstantiationService),\r\n    __param(3, ICodeEditorService),\r\n    __param(4, ICommandService),\r\n    __param(5, IContextKeyService),\r\n    __param(6, IKeybindingService),\r\n    __param(7, IThemeService),\r\n    __param(8, INotificationService),\r\n    __param(9, IAccessibilityService)\r\n], StandaloneCodeEditor);\r\nexport { StandaloneCodeEditor };\r\nlet StandaloneEditor = class StandaloneEditor extends StandaloneCodeEditor {\r\n    constructor(domElement, _options, toDispose, instantiationService, codeEditorService, commandService, contextKeyService, keybindingService, contextViewService, themeService, notificationService, configurationService, accessibilityService, modelService, modeService) {\r\n        const options = Object.assign({}, _options);\r\n        updateConfigurationService(configurationService, options, false);\r\n        const themeDomRegistration = themeService.registerEditorContainer(domElement);\r\n        if (typeof options.theme === 'string') {\r\n            themeService.setTheme(options.theme);\r\n        }\r\n        let _model = options.model;\r\n        delete options.model;\r\n        super(domElement, options, instantiationService, codeEditorService, commandService, contextKeyService, keybindingService, themeService, notificationService, accessibilityService);\r\n        this._contextViewService = contextViewService;\r\n        this._configurationService = configurationService;\r\n        this._standaloneThemeService = themeService;\r\n        this._register(toDispose);\r\n        this._register(themeDomRegistration);\r\n        let model;\r\n        if (typeof _model === 'undefined') {\r\n            model = createTextModel(modelService, modeService, options.value || '', options.language || 'text/plain', undefined);\r\n            this._ownsModel = true;\r\n        }\r\n        else {\r\n            model = _model;\r\n            this._ownsModel = false;\r\n        }\r\n        this._attachModel(model);\r\n        if (model) {\r\n            let e = {\r\n                oldModelUrl: null,\r\n                newModelUrl: model.uri\r\n            };\r\n            this._onDidChangeModel.fire(e);\r\n        }\r\n    }\r\n    dispose() {\r\n        super.dispose();\r\n    }\r\n    updateOptions(newOptions) {\r\n        updateConfigurationService(this._configurationService, newOptions, false);\r\n        if (typeof newOptions.theme === 'string') {\r\n            this._standaloneThemeService.setTheme(newOptions.theme);\r\n        }\r\n        super.updateOptions(newOptions);\r\n    }\r\n    _attachModel(model) {\r\n        super._attachModel(model);\r\n        if (this._modelData) {\r\n            this._contextViewService.setContainer(this._modelData.view.domNode.domNode);\r\n        }\r\n    }\r\n    _postDetachModelCleanup(detachedModel) {\r\n        super._postDetachModelCleanup(detachedModel);\r\n        if (detachedModel && this._ownsModel) {\r\n            detachedModel.dispose();\r\n            this._ownsModel = false;\r\n        }\r\n    }\r\n};\r\nStandaloneEditor = __decorate([\r\n    __param(3, IInstantiationService),\r\n    __param(4, ICodeEditorService),\r\n    __param(5, ICommandService),\r\n    __param(6, IContextKeyService),\r\n    __param(7, IKeybindingService),\r\n    __param(8, IContextViewService),\r\n    __param(9, IStandaloneThemeService),\r\n    __param(10, INotificationService),\r\n    __param(11, IConfigurationService),\r\n    __param(12, IAccessibilityService),\r\n    __param(13, IModelService),\r\n    __param(14, IModeService)\r\n], StandaloneEditor);\r\nexport { StandaloneEditor };\r\nlet StandaloneDiffEditor = class StandaloneDiffEditor extends DiffEditorWidget {\r\n    constructor(domElement, _options, toDispose, instantiationService, contextKeyService, keybindingService, contextViewService, editorWorkerService, codeEditorService, themeService, notificationService, configurationService, contextMenuService, editorProgressService, clipboardService) {\r\n        const options = Object.assign({}, _options);\r\n        updateConfigurationService(configurationService, options, true);\r\n        const themeDomRegistration = themeService.registerEditorContainer(domElement);\r\n        if (typeof options.theme === 'string') {\r\n            options.theme = themeService.setTheme(options.theme);\r\n        }\r\n        super(domElement, options, {}, clipboardService, editorWorkerService, contextKeyService, instantiationService, codeEditorService, themeService, notificationService, contextMenuService, editorProgressService);\r\n        this._contextViewService = contextViewService;\r\n        this._configurationService = configurationService;\r\n        this._standaloneThemeService = themeService;\r\n        this._register(toDispose);\r\n        this._register(themeDomRegistration);\r\n        this._contextViewService.setContainer(this._containerDomElement);\r\n    }\r\n    dispose() {\r\n        super.dispose();\r\n    }\r\n    updateOptions(newOptions) {\r\n        updateConfigurationService(this._configurationService, newOptions, true);\r\n        if (typeof newOptions.theme === 'string') {\r\n            this._standaloneThemeService.setTheme(newOptions.theme);\r\n        }\r\n        super.updateOptions(newOptions);\r\n    }\r\n    _createInnerEditor(instantiationService, container, options) {\r\n        return instantiationService.createInstance(StandaloneCodeEditor, container, options);\r\n    }\r\n    getOriginalEditor() {\r\n        return super.getOriginalEditor();\r\n    }\r\n    getModifiedEditor() {\r\n        return super.getModifiedEditor();\r\n    }\r\n    addCommand(keybinding, handler, context) {\r\n        return this.getModifiedEditor().addCommand(keybinding, handler, context);\r\n    }\r\n    createContextKey(key, defaultValue) {\r\n        return this.getModifiedEditor().createContextKey(key, defaultValue);\r\n    }\r\n    addAction(descriptor) {\r\n        return this.getModifiedEditor().addAction(descriptor);\r\n    }\r\n};\r\nStandaloneDiffEditor = __decorate([\r\n    __param(3, IInstantiationService),\r\n    __param(4, IContextKeyService),\r\n    __param(5, IKeybindingService),\r\n    __param(6, IContextViewService),\r\n    __param(7, IEditorWorkerService),\r\n    __param(8, ICodeEditorService),\r\n    __param(9, IStandaloneThemeService),\r\n    __param(10, INotificationService),\r\n    __param(11, IConfigurationService),\r\n    __param(12, IContextMenuService),\r\n    __param(13, IEditorProgressService),\r\n    __param(14, IClipboardService)\r\n], StandaloneDiffEditor);\r\nexport { StandaloneDiffEditor };\r\n/**\r\n * @internal\r\n */\r\nexport function createTextModel(modelService, modeService, value, language, uri) {\r\n    value = value || '';\r\n    if (!language) {\r\n        const firstLF = value.indexOf('\\n');\r\n        let firstLine = value;\r\n        if (firstLF !== -1) {\r\n            firstLine = value.substring(0, firstLF);\r\n        }\r\n        return doCreateModel(modelService, value, modeService.createByFilepathOrFirstLine(uri || null, firstLine), uri);\r\n    }\r\n    return doCreateModel(modelService, value, modeService.create(language), uri);\r\n}\r\n/**\r\n * @internal\r\n */\r\nfunction doCreateModel(modelService, value, languageSelection, uri) {\r\n    return modelService.createModel(value, languageSelection, uri);\r\n}\r\n"]},"metadata":{},"sourceType":"module"}