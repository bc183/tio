{"ast":null,"code":"import _regeneratorRuntime from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/regenerator\";\nimport _toConsumableArray from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/bar007/Desktop/projects/tio/client/node_modules/@babel/runtime/helpers/esm/createClass\";\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) {\n    if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  }\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nimport * as dom from '../../../base/browser/dom.js';\nimport { CancellationToken } from '../../../base/common/cancellation.js';\nimport { LinkedList } from '../../../base/common/linkedList.js';\nimport { ResourceMap } from '../../../base/common/map.js';\nimport { parse } from '../../../base/common/marshalling.js';\nimport { Schemas } from '../../../base/common/network.js';\nimport { normalizePath } from '../../../base/common/resources.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { ICodeEditorService } from './codeEditorService.js';\nimport { ICommandService } from '../../../platform/commands/common/commands.js';\nimport { EditorOpenContext } from '../../../platform/editor/common/editor.js';\nimport { matchesScheme } from '../../../platform/opener/common/opener.js';\n\nvar CommandOpener = /*#__PURE__*/function () {\n  function CommandOpener(_commandService) {\n    _classCallCheck(this, CommandOpener);\n\n    this._commandService = _commandService;\n  }\n\n  _createClass(CommandOpener, [{\n    key: \"open\",\n    value: function open(target) {\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _this$_commandService;\n\n        var args;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (matchesScheme(target, Schemas.command)) {\n                  _context.next = 2;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", false);\n\n              case 2:\n                // run command or bail out if command isn't known\n                if (typeof target === 'string') {\n                  target = URI.parse(target);\n                } // execute as command\n\n\n                args = [];\n\n                try {\n                  args = parse(decodeURIComponent(target.query));\n                } catch (_a) {\n                  // ignore and retry\n                  try {\n                    args = parse(target.query);\n                  } catch (_b) {// ignore error\n                  }\n                }\n\n                if (!Array.isArray(args)) {\n                  args = [args];\n                }\n\n                _context.next = 8;\n                return (_this$_commandService = this._commandService).executeCommand.apply(_this$_commandService, [target.path].concat(_toConsumableArray(args)));\n\n              case 8:\n                return _context.abrupt(\"return\", true);\n\n              case 9:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n    }\n  }]);\n\n  return CommandOpener;\n}();\n\nCommandOpener = __decorate([__param(0, ICommandService)], CommandOpener);\n\nvar EditorOpener = /*#__PURE__*/function () {\n  function EditorOpener(_editorService) {\n    _classCallCheck(this, EditorOpener);\n\n    this._editorService = _editorService;\n  }\n\n  _createClass(EditorOpener, [{\n    key: \"open\",\n    value: function open(target, options) {\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var selection, match;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (typeof target === 'string') {\n                  target = URI.parse(target);\n                }\n\n                selection = undefined;\n                match = /^L?(\\d+)(?:,(\\d+))?/.exec(target.fragment);\n\n                if (match) {\n                  // support file:///some/file.js#73,84\n                  // support file:///some/file.js#L73\n                  selection = {\n                    startLineNumber: parseInt(match[1]),\n                    startColumn: match[2] ? parseInt(match[2]) : 1\n                  }; // remove fragment\n\n                  target = target[\"with\"]({\n                    fragment: ''\n                  });\n                }\n\n                if (target.scheme === Schemas.file) {\n                  target = normalizePath(target); // workaround for non-normalized paths (https://github.com/microsoft/vscode/issues/12954)\n                }\n\n                _context2.next = 7;\n                return this._editorService.openCodeEditor({\n                  resource: target,\n                  options: Object.assign({\n                    selection: selection,\n                    context: (options === null || options === void 0 ? void 0 : options.fromUserGesture) ? EditorOpenContext.USER : EditorOpenContext.API\n                  }, options === null || options === void 0 ? void 0 : options.editorOptions)\n                }, this._editorService.getFocusedCodeEditor(), options === null || options === void 0 ? void 0 : options.openToSide);\n\n              case 7:\n                return _context2.abrupt(\"return\", true);\n\n              case 8:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n    }\n  }]);\n\n  return EditorOpener;\n}();\n\nEditorOpener = __decorate([__param(0, ICodeEditorService)], EditorOpener);\n\nvar OpenerService = /*#__PURE__*/function () {\n  function OpenerService(editorService, commandService) {\n    var _this = this;\n\n    _classCallCheck(this, OpenerService);\n\n    this._openers = new LinkedList();\n    this._validators = new LinkedList();\n    this._resolvers = new LinkedList();\n    this._resolvedUriTargets = new ResourceMap(function (uri) {\n      return uri[\"with\"]({\n        path: null,\n        fragment: null,\n        query: null\n      }).toString();\n    });\n    this._externalOpeners = new LinkedList(); // Default external opener is going through window.open()\n\n    this._defaultExternalOpener = {\n      openExternal: function openExternal(href) {\n        return __awaiter(_this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n          return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n            while (1) {\n              switch (_context3.prev = _context3.next) {\n                case 0:\n                  // ensure to open HTTP/HTTPS links into new windows\n                  // to not trigger a navigation. Any other link is\n                  // safe to be set as HREF to prevent a blank window\n                  // from opening.\n                  if (matchesScheme(href, Schemas.http) || matchesScheme(href, Schemas.https)) {\n                    dom.windowOpenNoOpener(href);\n                  } else {\n                    window.location.href = href;\n                  }\n\n                  return _context3.abrupt(\"return\", true);\n\n                case 2:\n                case \"end\":\n                  return _context3.stop();\n              }\n            }\n          }, _callee3);\n        }));\n      }\n    }; // Default opener: any external, maito, http(s), command, and catch-all-editors\n\n    this._openers.push({\n      open: function open(target, options) {\n        return __awaiter(_this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n          return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n            while (1) {\n              switch (_context4.prev = _context4.next) {\n                case 0:\n                  if (!((options === null || options === void 0 ? void 0 : options.openExternal) || matchesScheme(target, Schemas.mailto) || matchesScheme(target, Schemas.http) || matchesScheme(target, Schemas.https))) {\n                    _context4.next = 4;\n                    break;\n                  }\n\n                  _context4.next = 3;\n                  return this._doOpenExternal(target, options);\n\n                case 3:\n                  return _context4.abrupt(\"return\", true);\n\n                case 4:\n                  return _context4.abrupt(\"return\", false);\n\n                case 5:\n                case \"end\":\n                  return _context4.stop();\n              }\n            }\n          }, _callee4, this);\n        }));\n      }\n    });\n\n    this._openers.push(new CommandOpener(commandService));\n\n    this._openers.push(new EditorOpener(editorService));\n  }\n\n  _createClass(OpenerService, [{\n    key: \"registerOpener\",\n    value: function registerOpener(opener) {\n      var remove = this._openers.unshift(opener);\n\n      return {\n        dispose: remove\n      };\n    }\n  }, {\n    key: \"registerValidator\",\n    value: function registerValidator(validator) {\n      var remove = this._validators.push(validator);\n\n      return {\n        dispose: remove\n      };\n    }\n  }, {\n    key: \"registerExternalUriResolver\",\n    value: function registerExternalUriResolver(resolver) {\n      var remove = this._resolvers.push(resolver);\n\n      return {\n        dispose: remove\n      };\n    }\n  }, {\n    key: \"setDefaultExternalOpener\",\n    value: function setDefaultExternalOpener(externalOpener) {\n      this._defaultExternalOpener = externalOpener;\n    }\n  }, {\n    key: \"registerExternalOpener\",\n    value: function registerExternalOpener(opener) {\n      var remove = this._externalOpeners.push(opener);\n\n      return {\n        dispose: remove\n      };\n    }\n  }, {\n    key: \"open\",\n    value: function open(target, options) {\n      var _a;\n\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n        var targetURI, validationTarget, _iterator, _step, validator, _iterator2, _step2, opener, handled;\n\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                // check with contributed validators\n                targetURI = typeof target === 'string' ? URI.parse(target) : target; // validate against the original URI that this URI resolves to, if one exists\n\n                validationTarget = (_a = this._resolvedUriTargets.get(targetURI)) !== null && _a !== void 0 ? _a : target;\n                _iterator = _createForOfIteratorHelper(this._validators);\n                _context5.prev = 3;\n\n                _iterator.s();\n\n              case 5:\n                if ((_step = _iterator.n()).done) {\n                  _context5.next = 13;\n                  break;\n                }\n\n                validator = _step.value;\n                _context5.next = 9;\n                return validator.shouldOpen(validationTarget);\n\n              case 9:\n                if (_context5.sent) {\n                  _context5.next = 11;\n                  break;\n                }\n\n                return _context5.abrupt(\"return\", false);\n\n              case 11:\n                _context5.next = 5;\n                break;\n\n              case 13:\n                _context5.next = 18;\n                break;\n\n              case 15:\n                _context5.prev = 15;\n                _context5.t0 = _context5[\"catch\"](3);\n\n                _iterator.e(_context5.t0);\n\n              case 18:\n                _context5.prev = 18;\n\n                _iterator.f();\n\n                return _context5.finish(18);\n\n              case 21:\n                // check with contributed openers\n                _iterator2 = _createForOfIteratorHelper(this._openers);\n                _context5.prev = 22;\n\n                _iterator2.s();\n\n              case 24:\n                if ((_step2 = _iterator2.n()).done) {\n                  _context5.next = 33;\n                  break;\n                }\n\n                opener = _step2.value;\n                _context5.next = 28;\n                return opener.open(target, options);\n\n              case 28:\n                handled = _context5.sent;\n\n                if (!handled) {\n                  _context5.next = 31;\n                  break;\n                }\n\n                return _context5.abrupt(\"return\", true);\n\n              case 31:\n                _context5.next = 24;\n                break;\n\n              case 33:\n                _context5.next = 38;\n                break;\n\n              case 35:\n                _context5.prev = 35;\n                _context5.t1 = _context5[\"catch\"](22);\n\n                _iterator2.e(_context5.t1);\n\n              case 38:\n                _context5.prev = 38;\n\n                _iterator2.f();\n\n                return _context5.finish(38);\n\n              case 41:\n                return _context5.abrupt(\"return\", false);\n\n              case 42:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this, [[3, 15, 18, 21], [22, 35, 38, 41]]);\n      }));\n    }\n  }, {\n    key: \"resolveExternalUri\",\n    value: function resolveExternalUri(resource, options) {\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee6() {\n        var _iterator3, _step3, resolver, result;\n\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                _iterator3 = _createForOfIteratorHelper(this._resolvers);\n                _context6.prev = 1;\n\n                _iterator3.s();\n\n              case 3:\n                if ((_step3 = _iterator3.n()).done) {\n                  _context6.next = 13;\n                  break;\n                }\n\n                resolver = _step3.value;\n                _context6.next = 7;\n                return resolver.resolveExternalUri(resource, options);\n\n              case 7:\n                result = _context6.sent;\n\n                if (!result) {\n                  _context6.next = 11;\n                  break;\n                }\n\n                this._resolvedUriTargets.set(result.resolved, resource);\n\n                return _context6.abrupt(\"return\", result);\n\n              case 11:\n                _context6.next = 3;\n                break;\n\n              case 13:\n                _context6.next = 18;\n                break;\n\n              case 15:\n                _context6.prev = 15;\n                _context6.t0 = _context6[\"catch\"](1);\n\n                _iterator3.e(_context6.t0);\n\n              case 18:\n                _context6.prev = 18;\n\n                _iterator3.f();\n\n                return _context6.finish(18);\n\n              case 21:\n                return _context6.abrupt(\"return\", {\n                  resolved: resource,\n                  dispose: function dispose() {}\n                });\n\n              case 22:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this, [[1, 15, 18, 21]]);\n      }));\n    }\n  }, {\n    key: \"_doOpenExternal\",\n    value: function _doOpenExternal(resource, options) {\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee7() {\n        var uri, _yield$this$resolveEx, resolved, href, preferredOpenerId, _iterator4, _step4, opener, didOpen;\n\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                //todo@jrieken IExternalUriResolver should support `uri: URI | string`\n                uri = typeof resource === 'string' ? URI.parse(resource) : resource;\n                _context7.next = 3;\n                return this.resolveExternalUri(uri, options);\n\n              case 3:\n                _yield$this$resolveEx = _context7.sent;\n                resolved = _yield$this$resolveEx.resolved;\n\n                if (typeof resource === 'string' && uri.toString() === resolved.toString()) {\n                  // open the url-string AS IS\n                  href = resource;\n                } else {\n                  // open URI using the toString(noEncode)+encodeURI-trick\n                  href = encodeURI(resolved.toString(true));\n                }\n\n                if (!(options === null || options === void 0 ? void 0 : options.allowContributedOpeners)) {\n                  _context7.next = 28;\n                  break;\n                }\n\n                preferredOpenerId = typeof (options === null || options === void 0 ? void 0 : options.allowContributedOpeners) === 'string' ? options === null || options === void 0 ? void 0 : options.allowContributedOpeners : undefined;\n                _iterator4 = _createForOfIteratorHelper(this._externalOpeners);\n                _context7.prev = 9;\n\n                _iterator4.s();\n\n              case 11:\n                if ((_step4 = _iterator4.n()).done) {\n                  _context7.next = 20;\n                  break;\n                }\n\n                opener = _step4.value;\n                _context7.next = 15;\n                return opener.openExternal(href, {\n                  sourceUri: uri,\n                  preferredOpenerId: preferredOpenerId\n                }, CancellationToken.None);\n\n              case 15:\n                didOpen = _context7.sent;\n\n                if (!didOpen) {\n                  _context7.next = 18;\n                  break;\n                }\n\n                return _context7.abrupt(\"return\", true);\n\n              case 18:\n                _context7.next = 11;\n                break;\n\n              case 20:\n                _context7.next = 25;\n                break;\n\n              case 22:\n                _context7.prev = 22;\n                _context7.t0 = _context7[\"catch\"](9);\n\n                _iterator4.e(_context7.t0);\n\n              case 25:\n                _context7.prev = 25;\n\n                _iterator4.f();\n\n                return _context7.finish(25);\n\n              case 28:\n                return _context7.abrupt(\"return\", this._defaultExternalOpener.openExternal(href, {\n                  sourceUri: uri\n                }, CancellationToken.None));\n\n              case 29:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this, [[9, 22, 25, 28]]);\n      }));\n    }\n  }, {\n    key: \"dispose\",\n    value: function dispose() {\n      this._validators.clear();\n    }\n  }]);\n\n  return OpenerService;\n}();\n\nOpenerService = __decorate([__param(0, ICodeEditorService), __param(1, ICommandService)], OpenerService);\nexport { OpenerService };","map":{"version":3,"sources":["/home/bar007/Desktop/projects/tio/client/node_modules/monaco-editor/esm/vs/editor/browser/services/openerService.js"],"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","dom","CancellationToken","LinkedList","ResourceMap","parse","Schemas","normalizePath","URI","ICodeEditorService","ICommandService","EditorOpenContext","matchesScheme","CommandOpener","_commandService","command","args","decodeURIComponent","query","_a","_b","Array","isArray","executeCommand","path","EditorOpener","_editorService","options","selection","undefined","match","exec","fragment","startLineNumber","parseInt","startColumn","scheme","file","openCodeEditor","resource","assign","context","fromUserGesture","USER","API","editorOptions","getFocusedCodeEditor","openToSide","OpenerService","editorService","commandService","_openers","_validators","_resolvers","_resolvedUriTargets","uri","toString","_externalOpeners","_defaultExternalOpener","openExternal","href","http","https","windowOpenNoOpener","window","location","push","open","mailto","_doOpenExternal","opener","remove","unshift","dispose","validator","resolver","externalOpener","targetURI","validationTarget","get","shouldOpen","handled","resolveExternalUri","set","resolved","encodeURI","allowContributedOpeners","preferredOpenerId","sourceUri","None","didOpen","clear"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { LinkedList } from '../../../base/common/linkedList.js';\r\nimport { ResourceMap } from '../../../base/common/map.js';\r\nimport { parse } from '../../../base/common/marshalling.js';\r\nimport { Schemas } from '../../../base/common/network.js';\r\nimport { normalizePath } from '../../../base/common/resources.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { ICodeEditorService } from './codeEditorService.js';\r\nimport { ICommandService } from '../../../platform/commands/common/commands.js';\r\nimport { EditorOpenContext } from '../../../platform/editor/common/editor.js';\r\nimport { matchesScheme } from '../../../platform/opener/common/opener.js';\r\nlet CommandOpener = class CommandOpener {\r\n    constructor(_commandService) {\r\n        this._commandService = _commandService;\r\n    }\r\n    open(target) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!matchesScheme(target, Schemas.command)) {\r\n                return false;\r\n            }\r\n            // run command or bail out if command isn't known\r\n            if (typeof target === 'string') {\r\n                target = URI.parse(target);\r\n            }\r\n            // execute as command\r\n            let args = [];\r\n            try {\r\n                args = parse(decodeURIComponent(target.query));\r\n            }\r\n            catch (_a) {\r\n                // ignore and retry\r\n                try {\r\n                    args = parse(target.query);\r\n                }\r\n                catch (_b) {\r\n                    // ignore error\r\n                }\r\n            }\r\n            if (!Array.isArray(args)) {\r\n                args = [args];\r\n            }\r\n            yield this._commandService.executeCommand(target.path, ...args);\r\n            return true;\r\n        });\r\n    }\r\n};\r\nCommandOpener = __decorate([\r\n    __param(0, ICommandService)\r\n], CommandOpener);\r\nlet EditorOpener = class EditorOpener {\r\n    constructor(_editorService) {\r\n        this._editorService = _editorService;\r\n    }\r\n    open(target, options) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (typeof target === 'string') {\r\n                target = URI.parse(target);\r\n            }\r\n            let selection = undefined;\r\n            const match = /^L?(\\d+)(?:,(\\d+))?/.exec(target.fragment);\r\n            if (match) {\r\n                // support file:///some/file.js#73,84\r\n                // support file:///some/file.js#L73\r\n                selection = {\r\n                    startLineNumber: parseInt(match[1]),\r\n                    startColumn: match[2] ? parseInt(match[2]) : 1\r\n                };\r\n                // remove fragment\r\n                target = target.with({ fragment: '' });\r\n            }\r\n            if (target.scheme === Schemas.file) {\r\n                target = normalizePath(target); // workaround for non-normalized paths (https://github.com/microsoft/vscode/issues/12954)\r\n            }\r\n            yield this._editorService.openCodeEditor({\r\n                resource: target,\r\n                options: Object.assign({ selection, context: (options === null || options === void 0 ? void 0 : options.fromUserGesture) ? EditorOpenContext.USER : EditorOpenContext.API }, options === null || options === void 0 ? void 0 : options.editorOptions)\r\n            }, this._editorService.getFocusedCodeEditor(), options === null || options === void 0 ? void 0 : options.openToSide);\r\n            return true;\r\n        });\r\n    }\r\n};\r\nEditorOpener = __decorate([\r\n    __param(0, ICodeEditorService)\r\n], EditorOpener);\r\nlet OpenerService = class OpenerService {\r\n    constructor(editorService, commandService) {\r\n        this._openers = new LinkedList();\r\n        this._validators = new LinkedList();\r\n        this._resolvers = new LinkedList();\r\n        this._resolvedUriTargets = new ResourceMap(uri => uri.with({ path: null, fragment: null, query: null }).toString());\r\n        this._externalOpeners = new LinkedList();\r\n        // Default external opener is going through window.open()\r\n        this._defaultExternalOpener = {\r\n            openExternal: (href) => __awaiter(this, void 0, void 0, function* () {\r\n                // ensure to open HTTP/HTTPS links into new windows\r\n                // to not trigger a navigation. Any other link is\r\n                // safe to be set as HREF to prevent a blank window\r\n                // from opening.\r\n                if (matchesScheme(href, Schemas.http) || matchesScheme(href, Schemas.https)) {\r\n                    dom.windowOpenNoOpener(href);\r\n                }\r\n                else {\r\n                    window.location.href = href;\r\n                }\r\n                return true;\r\n            })\r\n        };\r\n        // Default opener: any external, maito, http(s), command, and catch-all-editors\r\n        this._openers.push({\r\n            open: (target, options) => __awaiter(this, void 0, void 0, function* () {\r\n                if ((options === null || options === void 0 ? void 0 : options.openExternal) || matchesScheme(target, Schemas.mailto) || matchesScheme(target, Schemas.http) || matchesScheme(target, Schemas.https)) {\r\n                    // open externally\r\n                    yield this._doOpenExternal(target, options);\r\n                    return true;\r\n                }\r\n                return false;\r\n            })\r\n        });\r\n        this._openers.push(new CommandOpener(commandService));\r\n        this._openers.push(new EditorOpener(editorService));\r\n    }\r\n    registerOpener(opener) {\r\n        const remove = this._openers.unshift(opener);\r\n        return { dispose: remove };\r\n    }\r\n    registerValidator(validator) {\r\n        const remove = this._validators.push(validator);\r\n        return { dispose: remove };\r\n    }\r\n    registerExternalUriResolver(resolver) {\r\n        const remove = this._resolvers.push(resolver);\r\n        return { dispose: remove };\r\n    }\r\n    setDefaultExternalOpener(externalOpener) {\r\n        this._defaultExternalOpener = externalOpener;\r\n    }\r\n    registerExternalOpener(opener) {\r\n        const remove = this._externalOpeners.push(opener);\r\n        return { dispose: remove };\r\n    }\r\n    open(target, options) {\r\n        var _a;\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            // check with contributed validators\r\n            const targetURI = typeof target === 'string' ? URI.parse(target) : target;\r\n            // validate against the original URI that this URI resolves to, if one exists\r\n            const validationTarget = (_a = this._resolvedUriTargets.get(targetURI)) !== null && _a !== void 0 ? _a : target;\r\n            for (const validator of this._validators) {\r\n                if (!(yield validator.shouldOpen(validationTarget))) {\r\n                    return false;\r\n                }\r\n            }\r\n            // check with contributed openers\r\n            for (const opener of this._openers) {\r\n                const handled = yield opener.open(target, options);\r\n                if (handled) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        });\r\n    }\r\n    resolveExternalUri(resource, options) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            for (const resolver of this._resolvers) {\r\n                const result = yield resolver.resolveExternalUri(resource, options);\r\n                if (result) {\r\n                    this._resolvedUriTargets.set(result.resolved, resource);\r\n                    return result;\r\n                }\r\n            }\r\n            return { resolved: resource, dispose: () => { } };\r\n        });\r\n    }\r\n    _doOpenExternal(resource, options) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            //todo@jrieken IExternalUriResolver should support `uri: URI | string`\r\n            const uri = typeof resource === 'string' ? URI.parse(resource) : resource;\r\n            const { resolved } = yield this.resolveExternalUri(uri, options);\r\n            let href;\r\n            if (typeof resource === 'string' && uri.toString() === resolved.toString()) {\r\n                // open the url-string AS IS\r\n                href = resource;\r\n            }\r\n            else {\r\n                // open URI using the toString(noEncode)+encodeURI-trick\r\n                href = encodeURI(resolved.toString(true));\r\n            }\r\n            if (options === null || options === void 0 ? void 0 : options.allowContributedOpeners) {\r\n                const preferredOpenerId = typeof (options === null || options === void 0 ? void 0 : options.allowContributedOpeners) === 'string' ? options === null || options === void 0 ? void 0 : options.allowContributedOpeners : undefined;\r\n                for (const opener of this._externalOpeners) {\r\n                    const didOpen = yield opener.openExternal(href, {\r\n                        sourceUri: uri,\r\n                        preferredOpenerId,\r\n                    }, CancellationToken.None);\r\n                    if (didOpen) {\r\n                        return true;\r\n                    }\r\n                }\r\n            }\r\n            return this._defaultExternalOpener.openExternal(href, { sourceUri: uri }, CancellationToken.None);\r\n        });\r\n    }\r\n    dispose() {\r\n        this._validators.clear();\r\n    }\r\n};\r\nOpenerService = __decorate([\r\n    __param(0, ICodeEditorService),\r\n    __param(1, ICommandService)\r\n], OpenerService);\r\nexport { OpenerService };\r\n"]},"metadata":{},"sourceType":"module"}